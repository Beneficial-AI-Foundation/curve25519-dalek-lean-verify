window.docContents[69].resolve({"/Building-Documents/Traversal/#traversal":{"contents":"Because they are Lean values, Verso documents adhere to the structure of Lean programs in general.\nIn particular, Lean doesn't support cyclic import graphs.\nIt's common, however, for technical writing to include cyclic references; two sections that describe different aspects of something will frequently refer to one another.\nSimilarly, a bibliography that's generated from a database needs a global view of a document to include only those works which are, in fact, cited.\n\nThe traversal phase occurs at runtime, before generating output.\nDuring the traversal phase, the document is repeatedly traversed from beginning to end, and metadata is accumulated into a table.\nThe document may also be modified during traversal; this allows the title of a section to be inserted into a cross-reference.\nThis traversal is repeated until the resulting document and metadata tables are not modified; it fails if a set number of passes are executed that result in modifications each time.\n\nVerso provides a general-purpose traversal mechanism for Part, Block, and Inline that genres may use.\nGenre.TraverseState contains the genre-specific information that's accumulated during traversal, while Genre.TraverseContext provides a means of tracking the surrounding document context.\nTo use this framework, genres should define instances of Traverse, which specifies the traversal of a genre's custom elements.\nAdditionally, instances of GenrePart and GenreBlock specify how traversal keeps track of the current position in a document.\n\nGenre-specific traversal.The traversal pass is where cross-references are resolved. The traversal pass repeatedly applies a\ngenre-specific stateful computation until a fixed point is reached, both with respect to the state\nand the document. Traversal may update the state or rewrite parts of the document.The methods part, block, and inline provide effects to be carried out before traversing the\ngiven level of the AST, and part allows the part's metadata to be updated.genrePart is carried out after part. It allows genre-specific rewriting of the entire part based\non genre-specific metadata. This is typically used to construct a table of contents or permalinks,\nbut it can in principle arbitrarily rewrite the part. inPart is used to locally transform the\ngenre's traversal context along the lines of withReader, and can be used to keep track of e.g. the\ncurrent position in the table of contents.genreBlock and genreInline are invoked when traversal encounters Block.other and\nInline.other. It may rewrite them, or have state effects.The effects carried out before traversing a Part.The effects carried out before traversing a Block.The effects carried out before traversing an Inline.Operations carried out after part, when a part has metadata. It allows genre-specific rewriting\nof the entire part based on genre-specific metadata. This is typically used to construct a table\nof contents or permalinks, but it can in principle arbitrarily rewrite the part. If it returns\nnone, then no rewrite is performed.The traversal of genre-specific block values. If it returns none, then no rewrite is performed.The traversal of genre-specific inline values. If it returns none, then no rewrite is performed.\n\nSpecifies how to modify the context while traversing the contents of a given part.How to modify the context while traversing the contents of a given part. This is applied after\npart and genrePart have rewritten the text, if applicable.It is also used during HTML generation.\n\nSpecifies how to modify the context while traversing the contents of a given block.How to modify the context while traversing a given block.It is also used during HTML generation.\n\n","context":"Writing Documentation in Lean with Verso\u0009Building Documents","header":"3.3. Traversal","id":"/Building-Documents/Traversal/#traversal"}});