-- THIS FILE WAS AUTOMATICALLY GENERATED BY AENEAS
-- [curve25519_dalek]: function definitions
import Aeneas
import Curve25519Dalek.Types
import Curve25519Dalek.FunsExternal
open Aeneas Aeneas.Std Result ControlFlow Error
set_option linter.dupNamespace false
set_option linter.hashCommand false
set_option linter.unusedVariables false
set_option linter.style.commandStart false

-- You can remove the following line by using the CLI option `-all-computable`: 
noncomputable section

namespace curve25519_dalek

/-- Trait implementation: [core::array::{core::convert::TryFrom<&0 ([T]), core::array::TryFromSliceError> for [T; N]}]
   Source: '/rustc/library/core/src/array/mod.rs', lines 250:0-252:12
   Name pattern: [core::convert::TryFrom<[@T; @N], &'0 [@T], core::array::TryFromSliceError>] -/
@[reducible, rust_trait_impl
  "core::convert::TryFrom<[@T; @N], &'0 [@T], core::array::TryFromSliceError>"]
def Array.Insts.CoreConvertTryFromShared0SliceTryFromSliceError {T : Type} (N :
  Std.Usize) (markerCopyInst : core.marker.Copy T) : core.convert.TryFrom
  (Array T N) (Slice T) core.array.TryFromSliceError := {
  try_from := core.array.TryFromArrayCopySlice.try_from N markerCopyInst
}

/-- Trait implementation: [core::default::{core::default::Default for bool}]
   Source: '/rustc/library/core/src/default.rs', lines 154:8-154:33
   Name pattern: [core::default::Default<bool>] -/
@[reducible, rust_trait_impl "core::default::Default<bool>"]
def Bool.Insts.CoreDefaultDefault : core.default.Default Bool := {
  default := core.default.DefaultBool.default
}

/-- Trait implementation: [core::slice::index::private_slice_index::{core::slice::index::private_slice_index::Sealed for core::ops::range::RangeFull}]
   Source: '/rustc/library/core/src/slice/index.rs', lines 120:4-120:34
   Name pattern: [core::slice::index::private_slice_index::Sealed<core::ops::range::RangeFull>] -/
@[reducible, rust_trait_impl
  "core::slice::index::private_slice_index::Sealed<core::ops::range::RangeFull>"]
def core.ops.range.RangeFull.Insts.CoreSliceIndexPrivate_slice_indexSealed :
  core.slice.index.private_slice_index.Sealed core.ops.range.RangeFull := {
}

/-- Trait implementation: [core::slice::index::{core::slice::index::SliceIndex<[T], [T]> for core::ops::range::RangeFull}]
   Source: '/rustc/library/core/src/slice/index.rs', lines 631:0-631:55
   Name pattern: [core::slice::index::SliceIndex<core::ops::range::RangeFull, [@T], [@T]>] -/
@[reducible, rust_trait_impl
  "core::slice::index::SliceIndex<core::ops::range::RangeFull, [@T], [@T]>"]
def core.ops.range.RangeFull.Insts.CoreSliceIndexSliceIndexSliceSlice (T :
  Type) : core.slice.index.SliceIndex core.ops.range.RangeFull (Slice T) (Slice
  T) := {
  sealedInst :=
    core.ops.range.RangeFull.Insts.CoreSliceIndexPrivate_slice_indexSealed
  get := core.ops.range.RangeFull.Insts.CoreSliceIndexSliceIndexSliceSlice.get
  get_mut :=
    core.ops.range.RangeFull.Insts.CoreSliceIndexSliceIndexSliceSlice.get_mut
  get_unchecked :=
    core.ops.range.RangeFull.Insts.CoreSliceIndexSliceIndexSliceSlice.get_unchecked
  get_unchecked_mut :=
    core.ops.range.RangeFull.Insts.CoreSliceIndexSliceIndexSliceSlice.get_unchecked_mut
  index :=
    core.ops.range.RangeFull.Insts.CoreSliceIndexSliceIndexSliceSlice.index
  index_mut :=
    core.ops.range.RangeFull.Insts.CoreSliceIndexSliceIndexSliceSlice.index_mut
}

/-- Trait implementation: [subtle::{core::convert::From<subtle::Choice> for bool}]
   Source: '/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/subtle-2.6.1/src/lib.rs', lines 138:0-138:26
   Name pattern: [core::convert::From<bool, subtle::Choice>] -/
@[reducible, rust_trait_impl "core::convert::From<bool, subtle::Choice>"]
def Bool.Insts.CoreConvertFromChoice : core.convert.From Bool subtle.Choice
  := {
  from_ := Bool.Insts.CoreConvertFromChoice.from
}

/-- Trait implementation: [subtle::{core::convert::From<u8> for subtle::Choice}]
   Source: '/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/subtle-2.6.1/src/lib.rs', lines 236:0-236:24
   Name pattern: [core::convert::From<subtle::Choice, u8>] -/
@[reducible, rust_trait_impl "core::convert::From<subtle::Choice, u8>"]
def subtle.Choice.Insts.CoreConvertFromU8 : core.convert.From subtle.Choice
  Std.U8 := {
  from_ := subtle.Choice.Insts.CoreConvertFromU8.from
}

/-- Trait implementation: [subtle::{subtle::ConstantTimeEq for u8}]
   Source: '/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/subtle-2.6.1/src/lib.rs', lines 346:8-346:36
   Name pattern: [subtle::ConstantTimeEq<u8>] -/
@[reducible, rust_trait_impl "subtle::ConstantTimeEq<u8>"]
def U8.Insts.SubtleConstantTimeEq : subtle.ConstantTimeEq Std.U8 := {
  ct_eq := U8.Insts.SubtleConstantTimeEq.ct_eq
}

/-- Trait implementation: [subtle::{subtle::ConditionallySelectable for u8}]
   Source: '/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/subtle-2.6.1/src/lib.rs', lines 511:8-537:10
   Name pattern: [subtle::ConditionallySelectable<u8>] -/
@[reducible, rust_trait_impl "subtle::ConditionallySelectable<u8>"]
def U8.Insts.SubtleConditionallySelectable : subtle.ConditionallySelectable
  Std.U8 := {
  coremarkerCopyInst := core.marker.CopyU8
  conditional_select :=
    U8.Insts.SubtleConditionallySelectable.conditional_select
  conditional_assign :=
    U8.Insts.SubtleConditionallySelectable.conditional_assign
  conditional_swap := U8.Insts.SubtleConditionallySelectable.conditional_swap
}

/-- Trait implementation: [zeroize::{zeroize::Zeroize for Z}]
   Source: '/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/zeroize-1.8.2/src/lib.rs', lines 297:0-299:23
   Name pattern: [zeroize::Zeroize<@Z>] -/
@[reducible, rust_trait_impl "zeroize::Zeroize<@Z>"]
noncomputable def zeroize.Zeroize.Blanket {Z : Type} (DefaultIsZeroesInst :
  zeroize.DefaultIsZeroes Z) : zeroize.Zeroize Z := {
  zeroize := zeroize.Zeroize.Blanket.zeroize DefaultIsZeroesInst
}

/-- Trait implementation: [zeroize::{zeroize::DefaultIsZeroes for u64}]
   Source: '/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/zeroize-1.8.2/src/lib.rs', lines 309:10-309:40
   Name pattern: [zeroize::DefaultIsZeroes<u64>] -/
@[reducible, rust_trait_impl "zeroize::DefaultIsZeroes<u64>"]
def U64.Insts.ZeroizeDefaultIsZeroes : zeroize.DefaultIsZeroes Std.U64 := {
  coremarkerCopyInst := core.marker.CopyU64
  coredefaultDefaultInst := core.default.DefaultU64
}

/-- Trait implementation: [zeroize::{zeroize::DefaultIsZeroes for u8}]
   Source: '/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/zeroize-1.8.2/src/lib.rs', lines 309:10-309:40
   Name pattern: [zeroize::DefaultIsZeroes<u8>] -/
@[reducible, rust_trait_impl "zeroize::DefaultIsZeroes<u8>"]
def U8.Insts.ZeroizeDefaultIsZeroes : zeroize.DefaultIsZeroes Std.U8 := {
  coremarkerCopyInst := core.marker.CopyU8
  coredefaultDefaultInst := core.default.DefaultU8
}

/-- Trait implementation: [zeroize::{zeroize::DefaultIsZeroes for bool}]
   Source: '/cargo/registry/src/index.crates.io-1949cf8c6b5b557f/zeroize-1.8.2/src/lib.rs', lines 309:10-309:40
   Name pattern: [zeroize::DefaultIsZeroes<bool>] -/
@[reducible, rust_trait_impl "zeroize::DefaultIsZeroes<bool>"]
def Bool.Insts.ZeroizeDefaultIsZeroes : zeroize.DefaultIsZeroes Bool := {
  coremarkerCopyInst := core.core.marker.CopyBool
  coredefaultDefaultInst := Bool.Insts.CoreDefaultDefault
}

/-- [curve25519_dalek::backend::get_selected_backend]:
   Source: 'curve25519-dalek/src/backend/mod.rs', lines 55:0-75:1 -/
def backend.get_selected_backend : Result backend.BackendKind := do
  ok backend.BackendKind.Serial

/-- [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::Mul<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51), curve25519_dalek::backend::serial::u64::field::FieldElement51> for &1 (curve25519_dalek::backend::serial::u64::field::FieldElement51)}::mul::LOW_51_BIT_MASK]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 174:8-174:54 -/
@[global_simps]
def
  backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.LOW_51_BIT_MASK_body
  : Result Std.U64 := do
  let i ← 1#u64 <<< 51#i32
  i - 1#u64
@[global_simps, irreducible]
def
  backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.LOW_51_BIT_MASK
  : Std.U64 :=
  eval_global
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.LOW_51_BIT_MASK_body

/-- [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::Mul<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51), curve25519_dalek::backend::serial::u64::field::FieldElement51> for &1 (curve25519_dalek::backend::serial::u64::field::FieldElement51)}::mul::m]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 121:8-121:66 -/
def
  backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
  (x : Std.U64) (y : Std.U64) : Result Std.U128 := do
  let i ← (↑(UScalar.cast .U128 x) : Result Std.U128)
  let i1 ← (↑(UScalar.cast .U128 y) : Result Std.U128)
  i * i1

/-- [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::Mul<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51), curve25519_dalek::backend::serial::u64::field::FieldElement51> for &1 (curve25519_dalek::backend::serial::u64::field::FieldElement51)}::mul]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 117:4-215:5 -/
def
  Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
  (self : backend.serial.u64.field.FieldElement51)
  (_rhs : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let i ← Array.index_usize _rhs 1#usize
  let b1_19 ← i * 19#u64
  let i1 ← Array.index_usize _rhs 2#usize
  let b2_19 ← i1 * 19#u64
  let i2 ← Array.index_usize _rhs 3#usize
  let b3_19 ← i2 * 19#u64
  let i3 ← Array.index_usize _rhs 4#usize
  let b4_19 ← i3 * 19#u64
  let i4 ← Array.index_usize self 0#usize
  let i5 ← Array.index_usize _rhs 0#usize
  let i6 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i4 i5
  let i7 ← Array.index_usize self 4#usize
  let i8 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i7 b1_19
  let i9 ← i6 + i8
  let i10 ← Array.index_usize self 3#usize
  let i11 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i10 b2_19
  let i12 ← i9 + i11
  let i13 ← Array.index_usize self 2#usize
  let i14 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i13 b3_19
  let i15 ← i12 + i14
  let i16 ← Array.index_usize self 1#usize
  let i17 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i16 b4_19
  let c0 ← i15 + i17
  let i18 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i16 i5
  let i19 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i4 i
  let i20 ← i18 + i19
  let i21 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i7 b2_19
  let i22 ← i20 + i21
  let i23 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i10 b3_19
  let i24 ← i22 + i23
  let i25 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i13 b4_19
  let c1 ← i24 + i25
  let i26 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i13 i5
  let i27 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i16 i
  let i28 ← i26 + i27
  let i29 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i4 i1
  let i30 ← i28 + i29
  let i31 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i7 b3_19
  let i32 ← i30 + i31
  let i33 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i10 b4_19
  let c2 ← i32 + i33
  let i34 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i10 i5
  let i35 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i13 i
  let i36 ← i34 + i35
  let i37 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i16 i1
  let i38 ← i36 + i37
  let i39 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i4 i2
  let i40 ← i38 + i39
  let i41 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i7 b4_19
  let c3 ← i40 + i41
  let i42 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i7 i5
  let i43 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i10 i
  let i44 ← i42 + i43
  let i45 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i13 i1
  let i46 ← i44 + i45
  let i47 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i16 i2
  let i48 ← i46 + i47
  let i49 ←
    backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.m
      i4 i3
  let c4 ← i48 + i49
  let i50 ← 1#u64 <<< 54#i32
  massert (i4 < i50)
  massert (i5 < i50)
  massert (i16 < i50)
  massert (i < i50)
  massert (i13 < i50)
  massert (i1 < i50)
  massert (i10 < i50)
  massert (i2 < i50)
  massert (i7 < i50)
  massert (i3 < i50)
  let out := Array.repeat 5#usize 0#u64
  let i51 ← c0 >>> 51#i32
  let i52 ← (↑(UScalar.cast .U64 i51) : Result Std.U64)
  let i53 ← (↑(UScalar.cast .U128 i52) : Result Std.U128)
  let c11 ← c1 + i53
  let i54 ← (↑(UScalar.cast .U64 c0) : Result Std.U64)
  let i55 ←
    (↑(i54 &&&
      backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.LOW_51_BIT_MASK)
      : Result Std.U64)
  let out1 ← Array.update out 0#usize i55
  let i56 ← c11 >>> 51#i32
  let i57 ← (↑(UScalar.cast .U64 i56) : Result Std.U64)
  let i58 ← (↑(UScalar.cast .U128 i57) : Result Std.U128)
  let c21 ← c2 + i58
  let i59 ← (↑(UScalar.cast .U64 c11) : Result Std.U64)
  let i60 ←
    (↑(i59 &&&
      backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.LOW_51_BIT_MASK)
      : Result Std.U64)
  let out2 ← Array.update out1 1#usize i60
  let i61 ← c21 >>> 51#i32
  let i62 ← (↑(UScalar.cast .U64 i61) : Result Std.U64)
  let i63 ← (↑(UScalar.cast .U128 i62) : Result Std.U128)
  let c31 ← c3 + i63
  let i64 ← (↑(UScalar.cast .U64 c21) : Result Std.U64)
  let i65 ←
    (↑(i64 &&&
      backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.LOW_51_BIT_MASK)
      : Result Std.U64)
  let out3 ← Array.update out2 2#usize i65
  let i66 ← c31 >>> 51#i32
  let i67 ← (↑(UScalar.cast .U64 i66) : Result Std.U64)
  let i68 ← (↑(UScalar.cast .U128 i67) : Result Std.U128)
  let c41 ← c4 + i68
  let i69 ← (↑(UScalar.cast .U64 c31) : Result Std.U64)
  let i70 ←
    (↑(i69 &&&
      backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.LOW_51_BIT_MASK)
      : Result Std.U64)
  let out4 ← Array.update out3 3#usize i70
  let i71 ← c41 >>> 51#i32
  let carry ← (↑(UScalar.cast .U64 i71) : Result Std.U64)
  let i72 ← (↑(UScalar.cast .U64 c41) : Result Std.U64)
  let i73 ←
    (↑(i72 &&&
      backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.LOW_51_BIT_MASK)
      : Result Std.U64)
  let out5 ← Array.update out4 4#usize i73
  let i74 ← carry * 19#u64
  let i75 ← Array.index_usize out5 0#usize
  let i76 ← i75 + i74
  let out6 ← Array.update out5 0#usize i76
  let i77 ← Array.index_usize out6 0#usize
  let i78 ← i77 >>> 51#i32
  let i79 ← Array.index_usize out6 1#usize
  let i80 ← i79 + i78
  let out7 ← Array.update out6 1#usize i80
  let i81 ← Array.index_usize out7 0#usize
  let i82 ←
    (↑(i81 &&&
      backend.serial.u64.field.MulShared0FieldElement51SharedAFieldElement51FieldElement51.mul.LOW_51_BIT_MASK)
      : Result Std.U64)
  let out8 ← Array.update out7 0#usize i82
  ok out8

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::reduce::LOW_51_BIT_MASK]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 293:8-293:54 -/
@[global_simps]
def backend.serial.u64.field.FieldElement51.reduce.LOW_51_BIT_MASK_body
  : Result Std.U64 := do
  let i ← 1#u64 <<< 51#i32
  i - 1#u64
@[global_simps, irreducible]
def backend.serial.u64.field.FieldElement51.reduce.LOW_51_BIT_MASK : Std.U64 :=
  eval_global
    backend.serial.u64.field.FieldElement51.reduce.LOW_51_BIT_MASK_body

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::reduce]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 292:4-325:5 -/
def backend.serial.u64.field.FieldElement51.reduce
  (limbs : Array Std.U64 5#usize) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let i ← Array.index_usize limbs 0#usize
  let c0 ← i >>> 51#i32
  let i1 ← Array.index_usize limbs 1#usize
  let c1 ← i1 >>> 51#i32
  let i2 ← Array.index_usize limbs 2#usize
  let c2 ← i2 >>> 51#i32
  let i3 ← Array.index_usize limbs 3#usize
  let c3 ← i3 >>> 51#i32
  let i4 ← Array.index_usize limbs 4#usize
  let c4 ← i4 >>> 51#i32
  let i5 ←
    (↑(i &&& backend.serial.u64.field.FieldElement51.reduce.LOW_51_BIT_MASK)
      : Result Std.U64)
  let limbs1 ← Array.update limbs 0#usize i5
  let i6 ← Array.index_usize limbs1 1#usize
  let i7 ←
    (↑(i6 &&& backend.serial.u64.field.FieldElement51.reduce.LOW_51_BIT_MASK)
      : Result Std.U64)
  let limbs2 ← Array.update limbs1 1#usize i7
  let i8 ← Array.index_usize limbs2 2#usize
  let i9 ←
    (↑(i8 &&& backend.serial.u64.field.FieldElement51.reduce.LOW_51_BIT_MASK)
      : Result Std.U64)
  let limbs3 ← Array.update limbs2 2#usize i9
  let i10 ← Array.index_usize limbs3 3#usize
  let i11 ←
    (↑(i10 &&&
      backend.serial.u64.field.FieldElement51.reduce.LOW_51_BIT_MASK) : Result
      Std.U64)
  let limbs4 ← Array.update limbs3 3#usize i11
  let i12 ← Array.index_usize limbs4 4#usize
  let i13 ←
    (↑(i12 &&&
      backend.serial.u64.field.FieldElement51.reduce.LOW_51_BIT_MASK) : Result
      Std.U64)
  let limbs5 ← Array.update limbs4 4#usize i13
  let i14 ← c4 * 19#u64
  let i15 ← Array.index_usize limbs5 0#usize
  let i16 ← i15 + i14
  let limbs6 ← Array.update limbs5 0#usize i16
  let i17 ← Array.index_usize limbs6 1#usize
  let i18 ← i17 + c0
  let limbs7 ← Array.update limbs6 1#usize i18
  let i19 ← Array.index_usize limbs7 2#usize
  let i20 ← i19 + c1
  let limbs8 ← Array.update limbs7 2#usize i20
  let i21 ← Array.index_usize limbs8 3#usize
  let i22 ← i21 + c2
  let limbs9 ← Array.update limbs8 3#usize i22
  let i23 ← Array.index_usize limbs9 4#usize
  let i24 ← i23 + c3
  let limbs10 ← Array.update limbs9 4#usize i24
  ok limbs10

/-- [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::Sub<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51), curve25519_dalek::backend::serial::u64::field::FieldElement51> for &1 (curve25519_dalek::backend::serial::u64::field::FieldElement51)}::sub]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 86:4-103:5 -/
def
  Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
  (self : backend.serial.u64.field.FieldElement51)
  (_rhs : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let i ← Array.index_usize self 0#usize
  let i1 ← i + 36028797018963664#u64
  let i2 ← Array.index_usize _rhs 0#usize
  let i3 ← i1 - i2
  let i4 ← Array.index_usize self 1#usize
  let i5 ← i4 + 36028797018963952#u64
  let i6 ← Array.index_usize _rhs 1#usize
  let i7 ← i5 - i6
  let i8 ← Array.index_usize self 2#usize
  let i9 ← i8 + 36028797018963952#u64
  let i10 ← Array.index_usize _rhs 2#usize
  let i11 ← i9 - i10
  let i12 ← Array.index_usize self 3#usize
  let i13 ← i12 + 36028797018963952#u64
  let i14 ← Array.index_usize _rhs 3#usize
  let i15 ← i13 - i14
  let i16 ← Array.index_usize self 4#usize
  let i17 ← i16 + 36028797018963952#u64
  let i18 ← Array.index_usize _rhs 4#usize
  let i19 ← i17 - i18
  backend.serial.u64.field.FieldElement51.reduce
    (Array.make 5#usize [ i3, i7, i11, i15, i19 ])

/-- [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::AddAssign<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51)> for curve25519_dalek::backend::serial::u64::field::FieldElement51}::add_assign]: loop 0:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 61:8-64:9 -/
def
  backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithAddAssignSharedAFieldElement51.add_assign_loop
  (self : backend.serial.u64.field.FieldElement51)
  (_rhs : backend.serial.u64.field.FieldElement51) (i : Std.Usize) :
  Result backend.serial.u64.field.FieldElement51
  := do
  if i < 5#usize
  then
    let i1 ← Array.index_usize _rhs i
    let i2 ← Array.index_usize self i
    let i3 ← i2 + i1
    let a ← Array.update self i i3
    let i4 ← i + 1#usize
    backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithAddAssignSharedAFieldElement51.add_assign_loop
      a _rhs i4
  else ok self
partial_fixpoint

/-- [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::AddAssign<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51)> for curve25519_dalek::backend::serial::u64::field::FieldElement51}::add_assign]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 59:4-65:5 -/
@[reducible]
def
  backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithAddAssignSharedAFieldElement51.add_assign
  (self : backend.serial.u64.field.FieldElement51)
  (_rhs : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithAddAssignSharedAFieldElement51.add_assign_loop
    self _rhs 0#usize

/-- [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::Add<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51), curve25519_dalek::backend::serial::u64::field::FieldElement51> for &1 (curve25519_dalek::backend::serial::u64::field::FieldElement51)}::add]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 70:4-74:5 -/
def
  Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
  (self : backend.serial.u64.field.FieldElement51)
  (_rhs : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithAddAssignSharedAFieldElement51.add_assign
    self _rhs

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::from_limbs]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 260:4-262:5 -/
def backend.serial.u64.field.FieldElement51.from_limbs
  (limbs : Array Std.U64 5#usize) :
  Result backend.serial.u64.field.FieldElement51
  := do
  ok limbs

/-- [curve25519_dalek::backend::serial::u64::constants::EDWARDS_D2]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 54:0-60:3 -/
@[global_simps]
def backend.serial.u64.constants.EDWARDS_D2_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [
      1859910466990425#u64, 932731440258426#u64, 1072319116312658#u64,
      1815898335770999#u64, 633789495995903#u64
      ])
@[global_simps, irreducible]
def backend.serial.u64.constants.EDWARDS_D2
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.EDWARDS_D2_body

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::as_projective_niels]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 520:4-527:5 -/
def edwards.EdwardsPoint.as_projective_niels
  (self : edwards.EdwardsPoint) :
  Result backend.serial.curve_models.ProjectiveNielsPoint
  := do
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      self.Y self.X
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      self.Y self.X
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.T backend.serial.u64.constants.EDWARDS_D2
  ok { Y_plus_X := fe, Y_minus_X := fe1, Z := self.Z, T2d := fe2 }

/-- [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Add<&'a (curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint), curve25519_dalek::backend::serial::curve_models::CompletedPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}::add]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 415:4-430:5 -/
def
  Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAProjectiveNielsPointCompletedPoint.add
  (self : edwards.EdwardsPoint)
  (other : backend.serial.curve_models.ProjectiveNielsPoint) :
  Result backend.serial.curve_models.CompletedPoint
  := do
  let Y_plus_X ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      self.Y self.X
  let Y_minus_X ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      self.Y self.X
  let PP ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      Y_plus_X other.Y_plus_X
  let MM ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      Y_minus_X other.Y_minus_X
  let TT2d ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.T other.T2d
  let ZZ ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Z other.Z
  let ZZ2 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      ZZ ZZ
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      PP MM
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      PP MM
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      ZZ2 TT2d
  let fe3 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      ZZ2 TT2d
  ok { X := fe, Y := fe1, Z := fe2, T := fe3 }

/-- [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::backend::serial::curve_models::CompletedPoint}::as_extended]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 366:4-373:5 -/
def backend.serial.curve_models.CompletedPoint.as_extended
  (self : backend.serial.curve_models.CompletedPoint) :
  Result edwards.EdwardsPoint
  := do
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X self.T
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Y self.Z
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Z self.T
  let fe3 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X self.Y
  ok { X := fe, Y := fe1, Z := fe2, T := fe3 }

/-- [curve25519_dalek::window::{core::convert::From<&'a (curve25519_dalek::edwards::EdwardsPoint)> for curve25519_dalek::window::LookupTable<curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint>}::from]: loop 0:
   Source: 'curve25519-dalek/src/window.rs', lines 102:16-139:26 -/
def
  window.LookupTableProjectiveNielsPoint.Insts.CoreConvertFromSharedAEdwardsPoint.from_loop
  (P : edwards.EdwardsPoint)
  (points : Array backend.serial.curve_models.ProjectiveNielsPoint 8#usize)
  (iter : core.ops.range.Range Std.Usize) :
  Result (Array backend.serial.curve_models.ProjectiveNielsPoint 8#usize)
  := do
  let (o, iter1) ←
    core.iter.range.IteratorRange.next core.iter.range.StepUsize iter
  match o with
  | none => ok points
  | some j =>
    let pnp ← Array.index_usize points j
    let cp ←
      Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAProjectiveNielsPointCompletedPoint.add
        P pnp
    let ep ← backend.serial.curve_models.CompletedPoint.as_extended cp
    let pnp1 ← edwards.EdwardsPoint.as_projective_niels ep
    let i ← j + 1#usize
    let a ← Array.update points i pnp1
    window.LookupTableProjectiveNielsPoint.Insts.CoreConvertFromSharedAEdwardsPoint.from_loop
      P a iter1
partial_fixpoint

/-- [curve25519_dalek::window::{core::convert::From<&'a (curve25519_dalek::edwards::EdwardsPoint)> for curve25519_dalek::window::LookupTable<curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint>}::from]:
   Source: 'curve25519-dalek/src/window.rs', lines 100:12-106:13 -/
def
  window.LookupTableProjectiveNielsPoint.Insts.CoreConvertFromSharedAEdwardsPoint.from
  (P : edwards.EdwardsPoint) :
  Result (window.LookupTable backend.serial.curve_models.ProjectiveNielsPoint)
  := do
  let pnp ← edwards.EdwardsPoint.as_projective_niels P
  let points := Array.repeat 8#usize pnp
  let iter ←
    core.iter.traits.collect.IntoIterator.Blanket.into_iter
      (core.iter.traits.iterator.IteratorRange core.iter.range.StepUsize)
      { start := 0#usize, «end» := 7#usize }
  let points1 ←
    window.LookupTableProjectiveNielsPoint.Insts.CoreConvertFromSharedAEdwardsPoint.from_loop
      P points iter
  ok points1

/-- [curve25519_dalek::window::{curve25519_dalek::window::LookupTable<T>}::select]: loop 0:
   Source: 'curve25519-dalek/src/window.rs', lines 65:16-138:20 -/
noncomputable def window.LookupTable.select_loop
  {T : Type} (subtleConditionallySelectableInst :
  subtle.ConditionallySelectable T) (self : window.LookupTable T)
  (xabs : Std.I16) (t : T) (iter : core.ops.range.Range Std.Usize) :
  Result T
  := do
  let (o, iter1) ←
    core.iter.range.IteratorRange.next core.iter.range.StepUsize iter
  match o with
  | none => ok t
  | some j =>
    let i ← (↑(IScalar.hcast .U16 xabs) : Result Std.U16)
    let i1 ← (↑(UScalar.cast .U16 j) : Result Std.U16)
    let c ← U16.Insts.SubtleConstantTimeEq.ct_eq i i1
    let i2 ← j - 1#usize
    let t1 ← Array.index_usize self i2
    let t2 ← subtleConditionallySelectableInst.conditional_assign t t1 c
    window.LookupTable.select_loop subtleConditionallySelectableInst self xabs
      t2 iter1
partial_fixpoint

/-- [curve25519_dalek::window::{curve25519_dalek::window::LookupTable<T>}::select]:
   Source: 'curve25519-dalek/src/window.rs', lines 55:12-78:13 -/
noncomputable def window.LookupTable.select
  {T : Type} (traitsIdentityInst : traits.Identity T)
  (subtleConditionallySelectableInst : subtle.ConditionallySelectable T)
  (coremarkerCopyInst : core.marker.Copy T) (coreopsarithNegInst :
  core.ops.arith.Neg T T) (self : window.LookupTable T) (x : Std.I8) :
  Result T
  := do
  massert (x >= (-8)#i8)
  let i ← (↑(IScalar.cast .I16 x) : Result Std.I16)
  massert (i <= 8#i16)
  let i1 ← (↑(IScalar.cast .I16 x) : Result Std.I16)
  let xmask ← i1 >>> 7#i32
  let i2 ← (↑(IScalar.cast .I16 x) : Result Std.I16)
  let i3 ← i2 + xmask
  let xabs ← (↑(i3 ^^^ xmask) : Result Std.I16)
  let t ← traitsIdentityInst.identity
  let iter ←
    core.iter.traits.collect.IntoIterator.Blanket.into_iter
      (core.iter.traits.iterator.IteratorRange core.iter.range.StepUsize)
      { start := 1#usize, «end» := 9#usize }
  let t1 ←
    window.LookupTable.select_loop subtleConditionallySelectableInst self xabs
      t iter
  let i4 ← (↑(xmask &&& 1#i16) : Result Std.I16)
  let i5 ← (↑(IScalar.hcast .U8 i4) : Result Std.U8)
  let neg_mask ← subtle.Choice.Insts.CoreConvertFromU8.from i5
  let t_neg ← coreopsarithNegInst.neg t1
  subtleConditionallySelectableInst.conditional_assign t1 t_neg neg_mask

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::as_radix_16::top_half]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1007:8-1009:9 -/
def scalar.Scalar.as_radix_16.top_half (x : Std.U8) : Result Std.U8 := do
  let i ← x >>> 4#i32
  ok (i &&& 15#u8)

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::as_radix_16::bot_half]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1003:8-1005:9 -/
def scalar.Scalar.as_radix_16.bot_half (x : Std.U8) : Result Std.U8 := do
  let i ← x >>> 0#i32
  ok (i &&& 15#u8)

/-- [curve25519_dalek::scalar::{core::ops::index::Index<usize, u8> for curve25519_dalek::scalar::Scalar}::index]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 310:4-312:5 -/
def scalar.Scalar.Insts.CoreOpsIndexIndexUsizeU8.index
  (self : scalar.Scalar) (_index : Std.Usize) : Result Std.U8 := do
  Array.index_usize self.bytes _index

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::as_radix_16]: loop 0:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1012:8-1016:9 -/
def scalar.Scalar.as_radix_16_loop0
  (self : scalar.Scalar) (output : Array Std.I8 64#usize) (i : Std.Usize) :
  Result (Array Std.I8 64#usize)
  := do
  if i < 32#usize
  then
    let i1 ← scalar.Scalar.Insts.CoreOpsIndexIndexUsizeU8.index self i
    let i2 ← scalar.Scalar.as_radix_16.bot_half i1
    let i3 ← 2#usize * i
    let i4 ← (↑(UScalar.hcast .I8 i2) : Result Std.I8)
    let output1 ← Array.update output i3 i4
    let i5 ← scalar.Scalar.as_radix_16.top_half i1
    let i6 ← i3 + 1#usize
    let i7 ← (↑(UScalar.hcast .I8 i5) : Result Std.I8)
    let a ← Array.update output1 i6 i7
    let i8 ← i + 1#usize
    scalar.Scalar.as_radix_16_loop0 self a i8
  else ok output
partial_fixpoint

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::as_radix_16]: loop 1:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1021:8-1026:9 -/
def scalar.Scalar.as_radix_16_loop1
  (output : Array Std.I8 64#usize) (i : Std.Usize) :
  Result (Array Std.I8 64#usize)
  := do
  if i < 63#usize
  then
    let i1 ← Array.index_usize output i
    let i2 ← i1 + 8#i8
    let carry ← i2 >>> 4#i32
    let i3 ← carry <<< 4#i32
    let i4 ← i1 - i3
    let output1 ← Array.update output i i4
    let i5 ← i + 1#usize
    let i6 ← Array.index_usize output1 i5
    let i7 ← i6 + carry
    let a ← Array.update output1 i5 i7
    scalar.Scalar.as_radix_16_loop1 a i5
  else ok output
partial_fixpoint

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::as_radix_16]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 995:4-1031:5 -/
def scalar.Scalar.as_radix_16
  (self : scalar.Scalar) : Result (Array Std.I8 64#usize) := do
  let i ← scalar.Scalar.Insts.CoreOpsIndexIndexUsizeU8.index self 31#usize
  massert (i <= 127#u8)
  let output := Array.repeat 64#usize 0#i8
  let output1 ← scalar.Scalar.as_radix_16_loop0 self output 0#usize
  scalar.Scalar.as_radix_16_loop1 output1 0#usize

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::ONE]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 267:4-267:80 -/
@[global_simps]
def backend.serial.u64.field.FieldElement51.ONE_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [ 1#u64, 0#u64, 0#u64, 0#u64, 0#u64 ])
@[global_simps, irreducible]
def backend.serial.u64.field.FieldElement51.ONE
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.field.FieldElement51.ONE_body

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::ZERO]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 265:4-265:81 -/
@[global_simps]
def backend.serial.u64.field.FieldElement51.ZERO_body
  : Result backend.serial.u64.field.FieldElement51 := do
  let a := Array.repeat 5#usize 0#u64
  backend.serial.u64.field.FieldElement51.from_limbs a
@[global_simps, irreducible]
def backend.serial.u64.field.FieldElement51.ZERO
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.field.FieldElement51.ZERO_body

/-- [curve25519_dalek::edwards::{curve25519_dalek::traits::Identity for curve25519_dalek::edwards::EdwardsPoint}::identity]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 421:4-428:5 -/
def edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsIdentity.identity
  : Result edwards.EdwardsPoint := do
  ok
    {
      X := backend.serial.u64.field.FieldElement51.ZERO,
      Y := backend.serial.u64.field.FieldElement51.ONE,
      Z := backend.serial.u64.field.FieldElement51.ONE,
      T := backend.serial.u64.field.FieldElement51.ZERO
    }

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::negate]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 278:4-288:5 -/
def backend.serial.u64.field.FieldElement51.negate
  (self : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let i ← Array.index_usize self 0#usize
  let i1 ← 36028797018963664#u64 - i
  let i2 ← Array.index_usize self 1#usize
  let i3 ← 36028797018963952#u64 - i2
  let i4 ← Array.index_usize self 2#usize
  let i5 ← 36028797018963952#u64 - i4
  let i6 ← Array.index_usize self 3#usize
  let i7 ← 36028797018963952#u64 - i6
  let i8 ← Array.index_usize self 4#usize
  let i9 ← 36028797018963952#u64 - i8
  let neg ←
    backend.serial.u64.field.FieldElement51.reduce
      (Array.make 5#usize [ i1, i3, i5, i7, i9 ])
  ok neg

/-- [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::Neg<curve25519_dalek::backend::serial::u64::field::FieldElement51> for &0 (curve25519_dalek::backend::serial::u64::field::FieldElement51)}::neg]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 220:4-224:5 -/
def Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg
  (self : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  backend.serial.u64.field.FieldElement51.negate self

/-- [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Neg<curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint> for &0 (curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint)}::neg]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 504:4-511:5 -/
def Shared0ProjectiveNielsPoint.Insts.CoreOpsArithNegProjectiveNielsPoint.neg
  (self : backend.serial.curve_models.ProjectiveNielsPoint) :
  Result backend.serial.curve_models.ProjectiveNielsPoint
  := do
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg self.T2d
  ok
    {
      self
        with
        Y_plus_X := self.Y_minus_X, Y_minus_X := self.Y_plus_X, T2d := fe
    }

/-- [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Neg<curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint> for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}::neg]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 517:4-519:5 -/
def
  backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreOpsArithNegProjectiveNielsPoint.neg
  (self : backend.serial.curve_models.ProjectiveNielsPoint) :
  Result backend.serial.curve_models.ProjectiveNielsPoint
  := do
  Shared0ProjectiveNielsPoint.Insts.CoreOpsArithNegProjectiveNielsPoint.neg
    self

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Neg<curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint> for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 514:0-520:1 -/
@[reducible]
def
  backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreOpsArithNegProjectiveNielsPoint
  : core.ops.arith.Neg backend.serial.curve_models.ProjectiveNielsPoint
  backend.serial.curve_models.ProjectiveNielsPoint := {
  neg :=
    backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreOpsArithNegProjectiveNielsPoint.neg
}

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::pow2k::LOW_51_BIT_MASK]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 519:12-519:58 -/
@[global_simps]
def backend.serial.u64.field.FieldElement51.pow2k.LOW_51_BIT_MASK_body
  : Result Std.U64 := do
  let i ← 1#u64 <<< 51#i32
  i - 1#u64
@[global_simps, irreducible]
def backend.serial.u64.field.FieldElement51.pow2k.LOW_51_BIT_MASK : Std.U64 :=
  eval_global
    backend.serial.u64.field.FieldElement51.pow2k.LOW_51_BIT_MASK_body

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::pow2k::m]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 468:8-470:9 -/
def backend.serial.u64.field.FieldElement51.pow2k.m
  (x : Std.U64) (y : Std.U64) : Result Std.U128 := do
  let i ← (↑(UScalar.cast .U128 x) : Result Std.U128)
  let i1 ← (↑(UScalar.cast .U128 y) : Result Std.U128)
  i * i1

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::pow2k]: loop 0:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 488:16-500:86 -/
def backend.serial.u64.field.FieldElement51.pow2k_loop
  (k : Std.U32) (a : Array Std.U64 5#usize) :
  Result (Array Std.U64 5#usize)
  := do
  let i ← Array.index_usize a 3#usize
  let a3_19 ← 19#u64 * i
  let i1 ← Array.index_usize a 4#usize
  let a4_19 ← 19#u64 * i1
  let i2 ← Array.index_usize a 0#usize
  let i3 ← backend.serial.u64.field.FieldElement51.pow2k.m i2 i2
  let i4 ← Array.index_usize a 1#usize
  let i5 ← backend.serial.u64.field.FieldElement51.pow2k.m i4 a4_19
  let i6 ← Array.index_usize a 2#usize
  let i7 ← backend.serial.u64.field.FieldElement51.pow2k.m i6 a3_19
  let i8 ← i5 + i7
  let i9 ← 2#u128 * i8
  let c0 ← i3 + i9
  let i10 ← backend.serial.u64.field.FieldElement51.pow2k.m i a3_19
  let i11 ← backend.serial.u64.field.FieldElement51.pow2k.m i2 i4
  let i12 ← backend.serial.u64.field.FieldElement51.pow2k.m i6 a4_19
  let i13 ← i11 + i12
  let i14 ← 2#u128 * i13
  let c1 ← i10 + i14
  let i15 ← backend.serial.u64.field.FieldElement51.pow2k.m i4 i4
  let i16 ← backend.serial.u64.field.FieldElement51.pow2k.m i2 i6
  let i17 ← backend.serial.u64.field.FieldElement51.pow2k.m i1 a3_19
  let i18 ← i16 + i17
  let i19 ← 2#u128 * i18
  let c2 ← i15 + i19
  let i20 ← backend.serial.u64.field.FieldElement51.pow2k.m i1 a4_19
  let i21 ← backend.serial.u64.field.FieldElement51.pow2k.m i2 i
  let i22 ← backend.serial.u64.field.FieldElement51.pow2k.m i4 i6
  let i23 ← i21 + i22
  let i24 ← 2#u128 * i23
  let c3 ← i20 + i24
  let i25 ← backend.serial.u64.field.FieldElement51.pow2k.m i6 i6
  let i26 ← backend.serial.u64.field.FieldElement51.pow2k.m i2 i1
  let i27 ← backend.serial.u64.field.FieldElement51.pow2k.m i4 i
  let i28 ← i26 + i27
  let i29 ← 2#u128 * i28
  let c4 ← i25 + i29
  let i30 ← 1#u64 <<< 54#i32
  if i2 < i30
  then
    if i4 < i30
    then
      if i6 < i30
      then
        if i < i30
        then
          if i1 < i30
          then
            let i31 ← c0 >>> 51#i32
            let i32 ← (↑(UScalar.cast .U64 i31) : Result Std.U64)
            let i33 ← (↑(UScalar.cast .U128 i32) : Result Std.U128)
            let c11 ← c1 + i33
            let i34 ← (↑(UScalar.cast .U64 c0) : Result Std.U64)
            let i35 ←
              (↑(i34 &&&
                backend.serial.u64.field.FieldElement51.pow2k.LOW_51_BIT_MASK)
                : Result Std.U64)
            let a1 ← Array.update a 0#usize i35
            let i36 ← c11 >>> 51#i32
            let i37 ← (↑(UScalar.cast .U64 i36) : Result Std.U64)
            let i38 ← (↑(UScalar.cast .U128 i37) : Result Std.U128)
            let c21 ← c2 + i38
            let i39 ← (↑(UScalar.cast .U64 c11) : Result Std.U64)
            let i40 ←
              (↑(i39 &&&
                backend.serial.u64.field.FieldElement51.pow2k.LOW_51_BIT_MASK)
                : Result Std.U64)
            let a2 ← Array.update a1 1#usize i40
            let i41 ← c21 >>> 51#i32
            let i42 ← (↑(UScalar.cast .U64 i41) : Result Std.U64)
            let i43 ← (↑(UScalar.cast .U128 i42) : Result Std.U128)
            let c31 ← c3 + i43
            let i44 ← (↑(UScalar.cast .U64 c21) : Result Std.U64)
            let i45 ←
              (↑(i44 &&&
                backend.serial.u64.field.FieldElement51.pow2k.LOW_51_BIT_MASK)
                : Result Std.U64)
            let a3 ← Array.update a2 2#usize i45
            let i46 ← c31 >>> 51#i32
            let i47 ← (↑(UScalar.cast .U64 i46) : Result Std.U64)
            let i48 ← (↑(UScalar.cast .U128 i47) : Result Std.U128)
            let c41 ← c4 + i48
            let i49 ← (↑(UScalar.cast .U64 c31) : Result Std.U64)
            let i50 ←
              (↑(i49 &&&
                backend.serial.u64.field.FieldElement51.pow2k.LOW_51_BIT_MASK)
                : Result Std.U64)
            let a4 ← Array.update a3 3#usize i50
            let i51 ← c41 >>> 51#i32
            let carry ← (↑(UScalar.cast .U64 i51) : Result Std.U64)
            let i52 ← (↑(UScalar.cast .U64 c41) : Result Std.U64)
            let i53 ←
              (↑(i52 &&&
                backend.serial.u64.field.FieldElement51.pow2k.LOW_51_BIT_MASK)
                : Result Std.U64)
            let a5 ← Array.update a4 4#usize i53
            let i54 ← carry * 19#u64
            let i55 ← Array.index_usize a5 0#usize
            let i56 ← i55 + i54
            let a6 ← Array.update a5 0#usize i56
            let i57 ← Array.index_usize a6 0#usize
            let i58 ← i57 >>> 51#i32
            let i59 ← Array.index_usize a6 1#usize
            let i60 ← i59 + i58
            let a7 ← Array.update a6 1#usize i60
            let i61 ← Array.index_usize a7 0#usize
            let i62 ←
              (↑(i61 &&&
                backend.serial.u64.field.FieldElement51.pow2k.LOW_51_BIT_MASK)
                : Result Std.U64)
            let (_, index_mut_back) ← Array.index_mut_usize a7 0#usize
            let k1 ← k - 1#u32
            if k1 = 0#u32
            then ok (index_mut_back i62)
            else
              let a8 := index_mut_back i62
              backend.serial.u64.field.FieldElement51.pow2k_loop k1 a8
          else fail panic
        else fail panic
      else fail panic
    else fail panic
  else fail panic
partial_fixpoint

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::pow2k]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 462:4-567:5 -/
def backend.serial.u64.field.FieldElement51.pow2k
  (self : backend.serial.u64.field.FieldElement51) (k : Std.U32) :
  Result backend.serial.u64.field.FieldElement51
  := do
  massert (k > 0#u32)
  let a ← backend.serial.u64.field.FieldElement51.pow2k_loop k self
  ok a

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::square2]: loop 0:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 578:8-581:9 -/
def backend.serial.u64.field.FieldElement51.square2_loop
  (square : backend.serial.u64.field.FieldElement51) (i : Std.Usize) :
  Result backend.serial.u64.field.FieldElement51
  := do
  if i < 5#usize
  then
    let i1 ← Array.index_usize square i
    let i2 ← i1 * 2#u64
    let a ← Array.update square i i2
    let i3 ← i + 1#usize
    backend.serial.u64.field.FieldElement51.square2_loop a i3
  else ok square
partial_fixpoint

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::square2]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 575:4-584:5 -/
def backend.serial.u64.field.FieldElement51.square2
  (self : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let square ← backend.serial.u64.field.FieldElement51.pow2k self 1#u32
  backend.serial.u64.field.FieldElement51.square2_loop square 0#usize

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::square]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 570:4-572:5 -/
def backend.serial.u64.field.FieldElement51.square
  (self : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  backend.serial.u64.field.FieldElement51.pow2k self 1#u32

/-- [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::backend::serial::curve_models::ProjectivePoint}::double]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 382:4-398:5 -/
def backend.serial.curve_models.ProjectivePoint.double
  (self : backend.serial.curve_models.ProjectivePoint) :
  Result backend.serial.curve_models.CompletedPoint
  := do
  let XX ← backend.serial.u64.field.FieldElement51.square self.X
  let YY ← backend.serial.u64.field.FieldElement51.square self.Y
  let ZZ2 ← backend.serial.u64.field.FieldElement51.square2 self.Z
  let X_plus_Y ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      self.X self.Y
  let X_plus_Y_sq ← backend.serial.u64.field.FieldElement51.square X_plus_Y
  let YY_plus_XX ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      YY XX
  let YY_minus_XX ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      YY XX
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      X_plus_Y_sq YY_plus_XX
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      ZZ2 YY_minus_XX
  ok { X := fe, Y := YY_plus_XX, Z := YY_minus_XX, T := fe1 }

/-- [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::backend::serial::curve_models::CompletedPoint}::as_projective]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 354:4-360:5 -/
def backend.serial.curve_models.CompletedPoint.as_projective
  (self : backend.serial.curve_models.CompletedPoint) :
  Result backend.serial.curve_models.ProjectivePoint
  := do
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X self.T
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Y self.Z
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Z self.T
  ok { X := fe, Y := fe1, Z := fe2 }

/-- [curve25519_dalek::backend::serial::u64::field::{subtle::ConditionallySelectable for curve25519_dalek::backend::serial::u64::field::FieldElement51}::conditional_assign]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 250:4-256:5 -/
def
  backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
  (self : backend.serial.u64.field.FieldElement51)
  (other : backend.serial.u64.field.FieldElement51) (choice : subtle.Choice) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let (i, index_mut_back) ← Array.index_mut_usize self 0#usize
  let i1 ← Array.index_usize other 0#usize
  let i2 ←
    U64.Insts.SubtleConditionallySelectable.conditional_assign i i1 choice
  let a := index_mut_back i2
  let (i3, index_mut_back1) ← Array.index_mut_usize a 1#usize
  let i4 ← Array.index_usize other 1#usize
  let i5 ←
    U64.Insts.SubtleConditionallySelectable.conditional_assign i3 i4 choice
  let a1 := index_mut_back1 i5
  let (i6, index_mut_back2) ← Array.index_mut_usize a1 2#usize
  let i7 ← Array.index_usize other 2#usize
  let i8 ←
    U64.Insts.SubtleConditionallySelectable.conditional_assign i6 i7 choice
  let a2 := index_mut_back2 i8
  let (i9, index_mut_back3) ← Array.index_mut_usize a2 3#usize
  let i10 ← Array.index_usize other 3#usize
  let i11 ←
    U64.Insts.SubtleConditionallySelectable.conditional_assign i9 i10 choice
  let a3 := index_mut_back3 i11
  let (i12, index_mut_back4) ← Array.index_mut_usize a3 4#usize
  let i13 ← Array.index_usize other 4#usize
  let i14 ←
    U64.Insts.SubtleConditionallySelectable.conditional_assign i12 i13 choice
  let a4 := index_mut_back4 i14
  ok a4

/-- [curve25519_dalek::backend::serial::curve_models::{subtle::ConditionallySelectable for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}::conditional_assign]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 306:4-311:5 -/
def
  backend.serial.curve_models.ProjectiveNielsPoint.Insts.SubtleConditionallySelectable.conditional_assign
  (self : backend.serial.curve_models.ProjectiveNielsPoint)
  (other : backend.serial.curve_models.ProjectiveNielsPoint)
  (choice : subtle.Choice) :
  Result backend.serial.curve_models.ProjectiveNielsPoint
  := do
  let fe ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      self.Y_plus_X other.Y_plus_X choice
  let fe1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      self.Y_minus_X other.Y_minus_X choice
  let fe2 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      self.Z other.Z choice
  let fe3 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      self.T2d other.T2d choice
  ok { Y_plus_X := fe, Y_minus_X := fe1, Z := fe2, T2d := fe3 }

/-- [curve25519_dalek::backend::serial::u64::field::{subtle::ConditionallySelectable for curve25519_dalek::backend::serial::u64::field::FieldElement51}::conditional_select]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 228:4-240:5 -/
def
  backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
  (a : backend.serial.u64.field.FieldElement51)
  (b : backend.serial.u64.field.FieldElement51) (choice : subtle.Choice) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let i ← Array.index_usize a 0#usize
  let i1 ← Array.index_usize b 0#usize
  let i2 ←
    U64.Insts.SubtleConditionallySelectable.conditional_select i i1 choice
  let i3 ← Array.index_usize a 1#usize
  let i4 ← Array.index_usize b 1#usize
  let i5 ←
    U64.Insts.SubtleConditionallySelectable.conditional_select i3 i4 choice
  let i6 ← Array.index_usize a 2#usize
  let i7 ← Array.index_usize b 2#usize
  let i8 ←
    U64.Insts.SubtleConditionallySelectable.conditional_select i6 i7 choice
  let i9 ← Array.index_usize a 3#usize
  let i10 ← Array.index_usize b 3#usize
  let i11 ←
    U64.Insts.SubtleConditionallySelectable.conditional_select i9 i10 choice
  let i12 ← Array.index_usize a 4#usize
  let i13 ← Array.index_usize b 4#usize
  let i14 ←
    U64.Insts.SubtleConditionallySelectable.conditional_select i12 i13 choice
  ok (Array.make 5#usize [ i2, i5, i8, i11, i14 ])

/-- [curve25519_dalek::backend::serial::curve_models::{subtle::ConditionallySelectable for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}::conditional_select]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 297:4-304:5 -/
def
  backend.serial.curve_models.ProjectiveNielsPoint.Insts.SubtleConditionallySelectable.conditional_select
  (a : backend.serial.curve_models.ProjectiveNielsPoint)
  (b : backend.serial.curve_models.ProjectiveNielsPoint)
  (choice : subtle.Choice) :
  Result backend.serial.curve_models.ProjectiveNielsPoint
  := do
  let fe ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.Y_plus_X b.Y_plus_X choice
  let fe1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.Y_minus_X b.Y_minus_X choice
  let fe2 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.Z b.Z choice
  let fe3 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.T2d b.T2d choice
  ok { Y_plus_X := fe, Y_minus_X := fe1, Z := fe2, T2d := fe3 }

/-- [curve25519_dalek::backend::serial::curve_models::{core::clone::Clone for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}::clone]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 204:15-204:20 -/
def backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreCloneClone.clone
  (self : backend.serial.curve_models.ProjectiveNielsPoint) :
  Result backend.serial.curve_models.ProjectiveNielsPoint
  := do
  ok self

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::clone::Clone for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 204:15-204:20 -/
@[reducible]
def backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreCloneClone :
  core.clone.Clone backend.serial.curve_models.ProjectiveNielsPoint := {
  clone :=
    backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::marker::Copy for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 204:9-204:13 -/
@[reducible]
def backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreMarkerCopy :
  core.marker.Copy backend.serial.curve_models.ProjectiveNielsPoint := {
  cloneInst :=
    backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreCloneClone
}

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{subtle::ConditionallySelectable for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 296:0-312:1 -/
@[reducible]
def
  backend.serial.curve_models.ProjectiveNielsPoint.Insts.SubtleConditionallySelectable
  : subtle.ConditionallySelectable
  backend.serial.curve_models.ProjectiveNielsPoint := {
  coremarkerCopyInst :=
    backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreMarkerCopy
  conditional_select :=
    backend.serial.curve_models.ProjectiveNielsPoint.Insts.SubtleConditionallySelectable.conditional_select
  conditional_assign :=
    backend.serial.curve_models.ProjectiveNielsPoint.Insts.SubtleConditionallySelectable.conditional_assign
  conditional_swap :=
    backend.serial.curve_models.ProjectiveNielsPoint.Insts.SubtleConditionallySelectable.conditional_swap
}

/-- [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::traits::Identity for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}::identity]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 241:4-248:5 -/
def
  backend.serial.curve_models.ProjectiveNielsPoint.Insts.Curve25519_dalekTraitsIdentity.identity
  : Result backend.serial.curve_models.ProjectiveNielsPoint := do
  ok
    {
      Y_plus_X := backend.serial.u64.field.FieldElement51.ONE,
      Y_minus_X := backend.serial.u64.field.FieldElement51.ONE,
      Z := backend.serial.u64.field.FieldElement51.ONE,
      T2d := backend.serial.u64.field.FieldElement51.ZERO
    }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::traits::Identity for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 240:0-249:1 -/
@[reducible]
def
  backend.serial.curve_models.ProjectiveNielsPoint.Insts.Curve25519_dalekTraitsIdentity
  : traits.Identity backend.serial.curve_models.ProjectiveNielsPoint := {
  identity :=
    backend.serial.curve_models.ProjectiveNielsPoint.Insts.Curve25519_dalekTraitsIdentity.identity
}

/-- [curve25519_dalek::backend::serial::scalar_mul::variable_base::mul]: loop 0:
   Source: 'curve25519-dalek/src/backend/serial/scalar_mul/variable_base.rs', lines 36:4-49:5 -/
noncomputable def backend.serial.scalar_mul.variable_base.mul_loop
  (lookup_table : window.LookupTable
  backend.serial.curve_models.ProjectiveNielsPoint)
  (scalar_digits : Array Std.I8 64#usize) (tmp3 : edwards.EdwardsPoint)
  (tmp1 : backend.serial.curve_models.CompletedPoint) (i : Std.Usize) :
  Result backend.serial.curve_models.CompletedPoint
  := do
  if i > 0#usize
  then
    let i1 ← i - 1#usize
    let tmp2 ← backend.serial.curve_models.CompletedPoint.as_projective tmp1
    let tmp11 ← backend.serial.curve_models.ProjectivePoint.double tmp2
    let tmp21 ←
      backend.serial.curve_models.CompletedPoint.as_projective tmp11
    let tmp12 ← backend.serial.curve_models.ProjectivePoint.double tmp21
    let tmp22 ←
      backend.serial.curve_models.CompletedPoint.as_projective tmp12
    let tmp13 ← backend.serial.curve_models.ProjectivePoint.double tmp22
    let tmp23 ←
      backend.serial.curve_models.CompletedPoint.as_projective tmp13
    let tmp14 ← backend.serial.curve_models.ProjectivePoint.double tmp23
    let tmp31 ← backend.serial.curve_models.CompletedPoint.as_extended tmp14
    let i2 ← Array.index_usize scalar_digits i1
    let pnp ←
      window.LookupTable.select
        backend.serial.curve_models.ProjectiveNielsPoint.Insts.Curve25519_dalekTraitsIdentity
        backend.serial.curve_models.ProjectiveNielsPoint.Insts.SubtleConditionallySelectable
        backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreMarkerCopy
        backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreOpsArithNegProjectiveNielsPoint
        lookup_table i2
    let tmp15 ←
      Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAProjectiveNielsPointCompletedPoint.add
        tmp31 pnp
    backend.serial.scalar_mul.variable_base.mul_loop lookup_table scalar_digits
      tmp31 tmp15 i1
  else ok tmp1
partial_fixpoint

/-- [curve25519_dalek::backend::serial::scalar_mul::variable_base::mul]:
   Source: 'curve25519-dalek/src/backend/serial/scalar_mul/variable_base.rs', lines 11:0-51:1 -/
def backend.serial.scalar_mul.variable_base.mul
  (point : edwards.EdwardsPoint) (scalar : scalar.Scalar) :
  Result edwards.EdwardsPoint
  := do
  let lookup_table ←
    window.LookupTableProjectiveNielsPoint.Insts.CoreConvertFromSharedAEdwardsPoint.from
      point
  let scalar_digits ← scalar.as_radix_16
  let tmp3 ←
    edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsIdentity.identity
  let i ← Array.index_usize scalar_digits 63#usize
  let pnp ←
    window.LookupTable.select
      backend.serial.curve_models.ProjectiveNielsPoint.Insts.Curve25519_dalekTraitsIdentity
      backend.serial.curve_models.ProjectiveNielsPoint.Insts.SubtleConditionallySelectable
      backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreMarkerCopy
      backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreOpsArithNegProjectiveNielsPoint
      lookup_table i
  let tmp1 ←
    Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAProjectiveNielsPointCompletedPoint.add
      tmp3 pnp
  let tmp11 ←
    backend.serial.scalar_mul.variable_base.mul_loop lookup_table scalar_digits
      tmp3 tmp1 63#usize
  backend.serial.curve_models.CompletedPoint.as_extended tmp11

/-- [curve25519_dalek::backend::variable_base_mul]:
   Source: 'curve25519-dalek/src/backend/mod.rs', lines 253:0-263:1 -/
noncomputable def backend.variable_base_mul
  (point : edwards.EdwardsPoint) (scalar : scalar.Scalar) :
  Result edwards.EdwardsPoint
  := do
  let _ ← backend.get_selected_backend
  backend.serial.scalar_mul.variable_base.mul point scalar

/-- [curve25519_dalek::backend::serial::curve_models::{core::clone::Clone for curve25519_dalek::backend::serial::curve_models::CompletedPoint}::clone]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 167:15-167:20 -/
def backend.serial.curve_models.CompletedPoint.Insts.CoreCloneClone.clone
  (self : backend.serial.curve_models.CompletedPoint) :
  Result backend.serial.curve_models.CompletedPoint
  := do
  ok self

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::clone::Clone for curve25519_dalek::backend::serial::curve_models::CompletedPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 167:15-167:20 -/
@[reducible]
def backend.serial.curve_models.CompletedPoint.Insts.CoreCloneClone :
  core.clone.Clone backend.serial.curve_models.CompletedPoint := {
  clone :=
    backend.serial.curve_models.CompletedPoint.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::marker::Copy for curve25519_dalek::backend::serial::curve_models::CompletedPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 167:9-167:13 -/
@[reducible]
def backend.serial.curve_models.CompletedPoint.Insts.CoreMarkerCopy :
  core.marker.Copy backend.serial.curve_models.CompletedPoint := {
  cloneInst := backend.serial.curve_models.CompletedPoint.Insts.CoreCloneClone
}

/-- [curve25519_dalek::backend::serial::curve_models::{core::clone::Clone for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}::clone]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 182:15-182:20 -/
def backend.serial.curve_models.AffineNielsPoint.Insts.CoreCloneClone.clone
  (self : backend.serial.curve_models.AffineNielsPoint) :
  Result backend.serial.curve_models.AffineNielsPoint
  := do
  ok self

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::clone::Clone for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 182:15-182:20 -/
@[reducible]
def backend.serial.curve_models.AffineNielsPoint.Insts.CoreCloneClone :
  core.clone.Clone backend.serial.curve_models.AffineNielsPoint := {
  clone :=
    backend.serial.curve_models.AffineNielsPoint.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::marker::Copy for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 182:9-182:13 -/
@[reducible]
def backend.serial.curve_models.AffineNielsPoint.Insts.CoreMarkerCopy :
  core.marker.Copy backend.serial.curve_models.AffineNielsPoint := {
  cloneInst :=
    backend.serial.curve_models.AffineNielsPoint.Insts.CoreCloneClone
}

set_option maxRecDepth 4096 in
/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::to_bytes]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 376:4-458:5 -/
def backend.serial.u64.field.FieldElement51.to_bytes
  (self : backend.serial.u64.field.FieldElement51) :
  Result (Array Std.U8 32#usize)
  := do
  let fe ← backend.serial.u64.field.FieldElement51.reduce self
  let i ← Array.index_usize fe 0#usize
  let i1 ← i + 19#u64
  let q ← i1 >>> 51#i32
  let i2 ← Array.index_usize fe 1#usize
  let i3 ← i2 + q
  let q1 ← i3 >>> 51#i32
  let i4 ← Array.index_usize fe 2#usize
  let i5 ← i4 + q1
  let q2 ← i5 >>> 51#i32
  let i6 ← Array.index_usize fe 3#usize
  let i7 ← i6 + q2
  let q3 ← i7 >>> 51#i32
  let i8 ← Array.index_usize fe 4#usize
  let i9 ← i8 + q3
  let q4 ← i9 >>> 51#i32
  let i10 ← 19#u64 * q4
  let i11 ← i + i10
  let limbs ← Array.update fe 0#usize i11
  let i12 ← 1#u64 <<< 51#i32
  let low_51_bit_mask ← i12 - 1#u64
  let i13 ← Array.index_usize limbs 0#usize
  let i14 ← i13 >>> 51#i32
  let i15 ← Array.index_usize limbs 1#usize
  let i16 ← i15 + i14
  let limbs1 ← Array.update limbs 1#usize i16
  let i17 ← Array.index_usize limbs1 0#usize
  let i18 ← (↑(i17 &&& low_51_bit_mask) : Result Std.U64)
  let limbs2 ← Array.update limbs1 0#usize i18
  let i19 ← Array.index_usize limbs2 1#usize
  let i20 ← i19 >>> 51#i32
  let i21 ← Array.index_usize limbs2 2#usize
  let i22 ← i21 + i20
  let limbs3 ← Array.update limbs2 2#usize i22
  let i23 ← Array.index_usize limbs3 1#usize
  let i24 ← (↑(i23 &&& low_51_bit_mask) : Result Std.U64)
  let limbs4 ← Array.update limbs3 1#usize i24
  let i25 ← Array.index_usize limbs4 2#usize
  let i26 ← i25 >>> 51#i32
  let i27 ← Array.index_usize limbs4 3#usize
  let i28 ← i27 + i26
  let limbs5 ← Array.update limbs4 3#usize i28
  let i29 ← Array.index_usize limbs5 2#usize
  let i30 ← (↑(i29 &&& low_51_bit_mask) : Result Std.U64)
  let limbs6 ← Array.update limbs5 2#usize i30
  let i31 ← Array.index_usize limbs6 3#usize
  let i32 ← i31 >>> 51#i32
  let i33 ← Array.index_usize limbs6 4#usize
  let i34 ← i33 + i32
  let limbs7 ← Array.update limbs6 4#usize i34
  let i35 ← Array.index_usize limbs7 3#usize
  let i36 ← (↑(i35 &&& low_51_bit_mask) : Result Std.U64)
  let limbs8 ← Array.update limbs7 3#usize i36
  let i37 ← Array.index_usize limbs8 4#usize
  let i38 ← (↑(i37 &&& low_51_bit_mask) : Result Std.U64)
  let limbs9 ← Array.update limbs8 4#usize i38
  let s := Array.repeat 32#usize 0#u8
  let i39 ← Array.index_usize limbs9 0#usize
  let i40 ← (↑(UScalar.cast .U8 i39) : Result Std.U8)
  let s1 ← Array.update s 0#usize i40
  let i41 ← i39 >>> 8#i32
  let i42 ← (↑(UScalar.cast .U8 i41) : Result Std.U8)
  let s2 ← Array.update s1 1#usize i42
  let i43 ← i39 >>> 16#i32
  let i44 ← (↑(UScalar.cast .U8 i43) : Result Std.U8)
  let s3 ← Array.update s2 2#usize i44
  let i45 ← i39 >>> 24#i32
  let i46 ← (↑(UScalar.cast .U8 i45) : Result Std.U8)
  let s4 ← Array.update s3 3#usize i46
  let i47 ← i39 >>> 32#i32
  let i48 ← (↑(UScalar.cast .U8 i47) : Result Std.U8)
  let s5 ← Array.update s4 4#usize i48
  let i49 ← i39 >>> 40#i32
  let i50 ← (↑(UScalar.cast .U8 i49) : Result Std.U8)
  let s6 ← Array.update s5 5#usize i50
  let i51 ← i39 >>> 48#i32
  let i52 ← Array.index_usize limbs9 1#usize
  let i53 ← i52 <<< 3#i32
  let i54 ← (↑(i51 ||| i53) : Result Std.U64)
  let i55 ← (↑(UScalar.cast .U8 i54) : Result Std.U8)
  let s7 ← Array.update s6 6#usize i55
  let i56 ← i52 >>> 5#i32
  let i57 ← (↑(UScalar.cast .U8 i56) : Result Std.U8)
  let s8 ← Array.update s7 7#usize i57
  let i58 ← i52 >>> 13#i32
  let i59 ← (↑(UScalar.cast .U8 i58) : Result Std.U8)
  let s9 ← Array.update s8 8#usize i59
  let i60 ← i52 >>> 21#i32
  let i61 ← (↑(UScalar.cast .U8 i60) : Result Std.U8)
  let s10 ← Array.update s9 9#usize i61
  let i62 ← i52 >>> 29#i32
  let i63 ← (↑(UScalar.cast .U8 i62) : Result Std.U8)
  let s11 ← Array.update s10 10#usize i63
  let i64 ← i52 >>> 37#i32
  let i65 ← (↑(UScalar.cast .U8 i64) : Result Std.U8)
  let s12 ← Array.update s11 11#usize i65
  let i66 ← i52 >>> 45#i32
  let i67 ← Array.index_usize limbs9 2#usize
  let i68 ← i67 <<< 6#i32
  let i69 ← (↑(i66 ||| i68) : Result Std.U64)
  let i70 ← (↑(UScalar.cast .U8 i69) : Result Std.U8)
  let s13 ← Array.update s12 12#usize i70
  let i71 ← i67 >>> 2#i32
  let i72 ← (↑(UScalar.cast .U8 i71) : Result Std.U8)
  let s14 ← Array.update s13 13#usize i72
  let i73 ← i67 >>> 10#i32
  let i74 ← (↑(UScalar.cast .U8 i73) : Result Std.U8)
  let s15 ← Array.update s14 14#usize i74
  let i75 ← i67 >>> 18#i32
  let i76 ← (↑(UScalar.cast .U8 i75) : Result Std.U8)
  let s16 ← Array.update s15 15#usize i76
  let i77 ← i67 >>> 26#i32
  let i78 ← (↑(UScalar.cast .U8 i77) : Result Std.U8)
  let s17 ← Array.update s16 16#usize i78
  let i79 ← i67 >>> 34#i32
  let i80 ← (↑(UScalar.cast .U8 i79) : Result Std.U8)
  let s18 ← Array.update s17 17#usize i80
  let i81 ← i67 >>> 42#i32
  let i82 ← (↑(UScalar.cast .U8 i81) : Result Std.U8)
  let s19 ← Array.update s18 18#usize i82
  let i83 ← i67 >>> 50#i32
  let i84 ← Array.index_usize limbs9 3#usize
  let i85 ← i84 <<< 1#i32
  let i86 ← (↑(i83 ||| i85) : Result Std.U64)
  let i87 ← (↑(UScalar.cast .U8 i86) : Result Std.U8)
  let s20 ← Array.update s19 19#usize i87
  let i88 ← i84 >>> 7#i32
  let i89 ← (↑(UScalar.cast .U8 i88) : Result Std.U8)
  let s21 ← Array.update s20 20#usize i89
  let i90 ← i84 >>> 15#i32
  let i91 ← (↑(UScalar.cast .U8 i90) : Result Std.U8)
  let s22 ← Array.update s21 21#usize i91
  let i92 ← i84 >>> 23#i32
  let i93 ← (↑(UScalar.cast .U8 i92) : Result Std.U8)
  let s23 ← Array.update s22 22#usize i93
  let i94 ← i84 >>> 31#i32
  let i95 ← (↑(UScalar.cast .U8 i94) : Result Std.U8)
  let s24 ← Array.update s23 23#usize i95
  let i96 ← i84 >>> 39#i32
  let i97 ← (↑(UScalar.cast .U8 i96) : Result Std.U8)
  let s25 ← Array.update s24 24#usize i97
  let i98 ← i84 >>> 47#i32
  let i99 ← Array.index_usize limbs9 4#usize
  let i100 ← i99 <<< 4#i32
  let i101 ← (↑(i98 ||| i100) : Result Std.U64)
  let i102 ← (↑(UScalar.cast .U8 i101) : Result Std.U8)
  let s26 ← Array.update s25 25#usize i102
  let i103 ← i99 >>> 4#i32
  let i104 ← (↑(UScalar.cast .U8 i103) : Result Std.U8)
  let s27 ← Array.update s26 26#usize i104
  let i105 ← i99 >>> 12#i32
  let i106 ← (↑(UScalar.cast .U8 i105) : Result Std.U8)
  let s28 ← Array.update s27 27#usize i106
  let i107 ← i99 >>> 20#i32
  let i108 ← (↑(UScalar.cast .U8 i107) : Result Std.U8)
  let s29 ← Array.update s28 28#usize i108
  let i109 ← i99 >>> 28#i32
  let i110 ← (↑(UScalar.cast .U8 i109) : Result Std.U8)
  let s30 ← Array.update s29 29#usize i110
  let i111 ← i99 >>> 36#i32
  let i112 ← (↑(UScalar.cast .U8 i111) : Result Std.U8)
  let s31 ← Array.update s30 30#usize i112
  let i113 ← i99 >>> 44#i32
  let i114 ← (↑(UScalar.cast .U8 i113) : Result Std.U8)
  let s32 ← Array.update s31 31#usize i114
  let i115 ← Array.index_usize s32 31#usize
  let i116 ← (↑(i115 &&& 128#u8) : Result Std.U8)
  massert (i116 = 0#u8)
  ok s32

/-- [curve25519_dalek::field::{subtle::ConstantTimeEq for curve25519_dalek::backend::serial::u64::field::FieldElement51}::ct_eq]:
   Source: 'curve25519-dalek/src/field.rs', lines 95:4-97:5 -/
def backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
  (self : backend.serial.u64.field.FieldElement51)
  (other : backend.serial.u64.field.FieldElement51) :
  Result subtle.Choice
  := do
  let a ← backend.serial.u64.field.FieldElement51.to_bytes self
  let s ← (↑(Array.to_slice a) : Result (Slice Std.U8))
  let a1 ← backend.serial.u64.field.FieldElement51.to_bytes other
  let s1 ← (↑(Array.to_slice a1) : Result (Slice Std.U8))
  Slice.Insts.SubtleConstantTimeEq.ct_eq U8.Insts.SubtleConstantTimeEq s s1

/-- [curve25519_dalek::field::{core::cmp::PartialEq<curve25519_dalek::backend::serial::u64::field::FieldElement51> for curve25519_dalek::backend::serial::u64::field::FieldElement51}::eq]:
   Source: 'curve25519-dalek/src/field.rs', lines 86:4-88:5 -/
def
  backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51.eq
  (self : backend.serial.u64.field.FieldElement51)
  (other : backend.serial.u64.field.FieldElement51) :
  Result Bool
  := do
  let c ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
      self other
  core.convert.IntoFrom.into Bool.Insts.CoreConvertFromChoice c

/-- [curve25519_dalek::backend::serial::curve_models::{core::cmp::PartialEq<curve25519_dalek::backend::serial::curve_models::AffineNielsPoint> for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}::eq]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 182:26-182:35 -/
def
  backend.serial.curve_models.AffineNielsPoint.Insts.CoreCmpPartialEqAffineNielsPoint.eq
  (self : backend.serial.curve_models.AffineNielsPoint)
  (other : backend.serial.curve_models.AffineNielsPoint) :
  Result Bool
  := do
  let b ←
    backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51.eq
      self.y_plus_x other.y_plus_x
  if b
  then
    let b1 ←
      backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51.eq
        self.y_minus_x other.y_minus_x
    if b1
    then
      backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51.eq
        self.xy2d other.xy2d
    else ok false
  else ok false

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::cmp::PartialEq<curve25519_dalek::backend::serial::curve_models::AffineNielsPoint> for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 182:26-182:35 -/
@[reducible]
def
  backend.serial.curve_models.AffineNielsPoint.Insts.CoreCmpPartialEqAffineNielsPoint
  : core.cmp.PartialEq backend.serial.curve_models.AffineNielsPoint
  backend.serial.curve_models.AffineNielsPoint := {
  eq :=
    backend.serial.curve_models.AffineNielsPoint.Insts.CoreCmpPartialEqAffineNielsPoint.eq
  ne :=
    backend.serial.curve_models.AffineNielsPoint.Insts.CoreCmpPartialEqAffineNielsPoint.ne
}

/-- [curve25519_dalek::backend::serial::curve_models::{core::cmp::Eq for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}::assert_receiver_is_total_eq]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 182:22-182:24 -/
def
  backend.serial.curve_models.AffineNielsPoint.Insts.CoreCmpEq.assert_receiver_is_total_eq
  (self : backend.serial.curve_models.AffineNielsPoint) : Result Unit := do
  ok ()

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::cmp::Eq for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 182:22-182:24 -/
@[reducible]
def backend.serial.curve_models.AffineNielsPoint.Insts.CoreCmpEq : core.cmp.Eq
  backend.serial.curve_models.AffineNielsPoint := {
  partialEqInst :=
    backend.serial.curve_models.AffineNielsPoint.Insts.CoreCmpPartialEqAffineNielsPoint
  assert_receiver_is_total_eq :=
    backend.serial.curve_models.AffineNielsPoint.Insts.CoreCmpEq.assert_receiver_is_total_eq
}

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::marker::StructuralPartialEq for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 182:26-182:35 -/
@[reducible]
def
  backend.serial.curve_models.AffineNielsPoint.Insts.CoreMarkerStructuralPartialEq
  : core.marker.StructuralPartialEq
  backend.serial.curve_models.AffineNielsPoint := {
}

/-- [curve25519_dalek::backend::serial::u64::field::{zeroize::Zeroize for curve25519_dalek::backend::serial::u64::field::FieldElement51}::zeroize]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 53:4-55:5 -/
def backend.serial.u64.field.FieldElement51.Insts.ZeroizeZeroize.zeroize
  (self : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let a ←
    Array.Insts.ZeroizeZeroize.zeroize (zeroize.Zeroize.Blanket
      U64.Insts.ZeroizeDefaultIsZeroes) self
  ok a

/-- [curve25519_dalek::backend::serial::curve_models::{zeroize::Zeroize for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}::zeroize]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 192:4-196:5 -/
def backend.serial.curve_models.AffineNielsPoint.Insts.ZeroizeZeroize.zeroize
  (self : backend.serial.curve_models.AffineNielsPoint) :
  Result backend.serial.curve_models.AffineNielsPoint
  := do
  let fe ←
    backend.serial.u64.field.FieldElement51.Insts.ZeroizeZeroize.zeroize
      self.y_plus_x
  let fe1 ←
    backend.serial.u64.field.FieldElement51.Insts.ZeroizeZeroize.zeroize
      self.y_minus_x
  let fe2 ←
    backend.serial.u64.field.FieldElement51.Insts.ZeroizeZeroize.zeroize
      self.xy2d
  ok { y_plus_x := fe, y_minus_x := fe1, xy2d := fe2 }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{zeroize::Zeroize for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 191:0-197:1 -/
@[reducible]
def backend.serial.curve_models.AffineNielsPoint.Insts.ZeroizeZeroize :
  zeroize.Zeroize backend.serial.curve_models.AffineNielsPoint := {
  zeroize :=
    backend.serial.curve_models.AffineNielsPoint.Insts.ZeroizeZeroize.zeroize
}

/-- [curve25519_dalek::backend::serial::curve_models::{zeroize::Zeroize for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}::zeroize]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 215:4-220:5 -/
def
  backend.serial.curve_models.ProjectiveNielsPoint.Insts.ZeroizeZeroize.zeroize
  (self : backend.serial.curve_models.ProjectiveNielsPoint) :
  Result backend.serial.curve_models.ProjectiveNielsPoint
  := do
  let fe ←
    backend.serial.u64.field.FieldElement51.Insts.ZeroizeZeroize.zeroize
      self.Y_plus_X
  let fe1 ←
    backend.serial.u64.field.FieldElement51.Insts.ZeroizeZeroize.zeroize
      self.Y_minus_X
  let fe2 ←
    backend.serial.u64.field.FieldElement51.Insts.ZeroizeZeroize.zeroize self.Z
  let fe3 ←
    backend.serial.u64.field.FieldElement51.Insts.ZeroizeZeroize.zeroize
      self.T2d
  ok { Y_plus_X := fe, Y_minus_X := fe1, Z := fe2, T2d := fe3 }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{zeroize::Zeroize for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 214:0-221:1 -/
@[reducible]
def backend.serial.curve_models.ProjectiveNielsPoint.Insts.ZeroizeZeroize :
  zeroize.Zeroize backend.serial.curve_models.ProjectiveNielsPoint := {
  zeroize :=
    backend.serial.curve_models.ProjectiveNielsPoint.Insts.ZeroizeZeroize.zeroize
}

/-- [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::traits::Identity for curve25519_dalek::backend::serial::curve_models::ProjectivePoint}::identity]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 231:4-237:5 -/
def IdentityCurveModelsProjectivePoint.identity
  : Result backend.serial.curve_models.ProjectivePoint := do
  ok
    {
      X := backend.serial.u64.field.FieldElement51.ZERO,
      Y := backend.serial.u64.field.FieldElement51.ONE,
      Z := backend.serial.u64.field.FieldElement51.ONE
    }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::traits::Identity for curve25519_dalek::backend::serial::curve_models::ProjectivePoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 230:0-238:1 -/
@[reducible]
def IdentityCurveModelsProjectivePoint : traits.Identity
  backend.serial.curve_models.ProjectivePoint := {
  identity := IdentityCurveModelsProjectivePoint.identity
}

/-- [curve25519_dalek::backend::serial::curve_models::{core::default::Default for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}::default]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 252:4-254:5 -/
def
  backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreDefaultDefault.default
  : Result backend.serial.curve_models.ProjectiveNielsPoint := do
  backend.serial.curve_models.ProjectiveNielsPoint.Insts.Curve25519_dalekTraitsIdentity.identity

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::default::Default for curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 251:0-255:1 -/
@[reducible]
def backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreDefaultDefault :
  core.default.Default backend.serial.curve_models.ProjectiveNielsPoint := {
  default :=
    backend.serial.curve_models.ProjectiveNielsPoint.Insts.CoreDefaultDefault.default
}

/-- [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::traits::Identity for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}::identity]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 258:4-264:5 -/
def
  backend.serial.curve_models.AffineNielsPoint.Insts.Curve25519_dalekTraitsIdentity.identity
  : Result backend.serial.curve_models.AffineNielsPoint := do
  ok
    {
      y_plus_x := backend.serial.u64.field.FieldElement51.ONE,
      y_minus_x := backend.serial.u64.field.FieldElement51.ONE,
      xy2d := backend.serial.u64.field.FieldElement51.ZERO
    }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::traits::Identity for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 257:0-265:1 -/
@[reducible]
def
  backend.serial.curve_models.AffineNielsPoint.Insts.Curve25519_dalekTraitsIdentity
  : traits.Identity backend.serial.curve_models.AffineNielsPoint := {
  identity :=
    backend.serial.curve_models.AffineNielsPoint.Insts.Curve25519_dalekTraitsIdentity.identity
}

/-- [curve25519_dalek::backend::serial::curve_models::{core::default::Default for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}::default]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 268:4-270:5 -/
def
  backend.serial.curve_models.AffineNielsPoint.Insts.CoreDefaultDefault.default
  : Result backend.serial.curve_models.AffineNielsPoint := do
  backend.serial.curve_models.AffineNielsPoint.Insts.Curve25519_dalekTraitsIdentity.identity

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::default::Default for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 267:0-271:1 -/
@[reducible]
def backend.serial.curve_models.AffineNielsPoint.Insts.CoreDefaultDefault :
  core.default.Default backend.serial.curve_models.AffineNielsPoint := {
  default :=
    backend.serial.curve_models.AffineNielsPoint.Insts.CoreDefaultDefault.default
}

/-- [curve25519_dalek::backend::serial::u64::constants::EDWARDS_D]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 45:0-51:3 -/
@[global_simps]
def backend.serial.u64.constants.EDWARDS_D_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [
      929955233495203#u64, 466365720129213#u64, 1662059464998953#u64,
      2033849074728123#u64, 1442794654840575#u64
      ])
@[global_simps, irreducible]
def backend.serial.u64.constants.EDWARDS_D
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.EDWARDS_D_body

/-- [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::traits::ValidityCheck for curve25519_dalek::backend::serial::curve_models::ProjectivePoint}::is_valid]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 278:4-289:5 -/
def
  backend.serial.curve_models.ProjectivePoint.Insts.Curve25519_dalekTraitsValidityCheck.is_valid
  (self : backend.serial.curve_models.ProjectivePoint) : Result Bool := do
  let XX ← backend.serial.u64.field.FieldElement51.square self.X
  let YY ← backend.serial.u64.field.FieldElement51.square self.Y
  let ZZ ← backend.serial.u64.field.FieldElement51.square self.Z
  let ZZZZ ← backend.serial.u64.field.FieldElement51.square ZZ
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      YY XX
  let lhs ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      fe ZZ
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      XX YY
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      backend.serial.u64.constants.EDWARDS_D fe1
  let rhs ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      ZZZZ fe2
  backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51.eq
    lhs rhs

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::traits::ValidityCheck for curve25519_dalek::backend::serial::curve_models::ProjectivePoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 277:0-290:1 -/
@[reducible]
def
  backend.serial.curve_models.ProjectivePoint.Insts.Curve25519_dalekTraitsValidityCheck
  : traits.ValidityCheck backend.serial.curve_models.ProjectivePoint := {
  is_valid :=
    backend.serial.curve_models.ProjectivePoint.Insts.Curve25519_dalekTraitsValidityCheck.is_valid
}

/-- [curve25519_dalek::backend::serial::curve_models::{subtle::ConditionallySelectable for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}::conditional_assign]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 323:4-327:5 -/
def
  backend.serial.curve_models.AffineNielsPoint.Insts.SubtleConditionallySelectable.conditional_assign
  (self : backend.serial.curve_models.AffineNielsPoint)
  (other : backend.serial.curve_models.AffineNielsPoint)
  (choice : subtle.Choice) :
  Result backend.serial.curve_models.AffineNielsPoint
  := do
  let fe ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      self.y_plus_x other.y_plus_x choice
  let fe1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      self.y_minus_x other.y_minus_x choice
  let fe2 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      self.xy2d other.xy2d choice
  ok { y_plus_x := fe, y_minus_x := fe1, xy2d := fe2 }

/-- [curve25519_dalek::backend::serial::curve_models::{subtle::ConditionallySelectable for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}::conditional_select]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 315:4-321:5 -/
def
  backend.serial.curve_models.AffineNielsPoint.Insts.SubtleConditionallySelectable.conditional_select
  (a : backend.serial.curve_models.AffineNielsPoint)
  (b : backend.serial.curve_models.AffineNielsPoint) (choice : subtle.Choice) :
  Result backend.serial.curve_models.AffineNielsPoint
  := do
  let fe ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.y_plus_x b.y_plus_x choice
  let fe1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.y_minus_x b.y_minus_x choice
  let fe2 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.xy2d b.xy2d choice
  ok { y_plus_x := fe, y_minus_x := fe1, xy2d := fe2 }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{subtle::ConditionallySelectable for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 314:0-328:1 -/
@[reducible]
def
  backend.serial.curve_models.AffineNielsPoint.Insts.SubtleConditionallySelectable
  : subtle.ConditionallySelectable backend.serial.curve_models.AffineNielsPoint
  := {
  coremarkerCopyInst :=
    backend.serial.curve_models.AffineNielsPoint.Insts.CoreMarkerCopy
  conditional_select :=
    backend.serial.curve_models.AffineNielsPoint.Insts.SubtleConditionallySelectable.conditional_select
  conditional_assign :=
    backend.serial.curve_models.AffineNielsPoint.Insts.SubtleConditionallySelectable.conditional_assign
  conditional_swap :=
    backend.serial.curve_models.AffineNielsPoint.Insts.SubtleConditionallySelectable.conditional_swap
}

/-- [curve25519_dalek::backend::serial::curve_models::{curve25519_dalek::backend::serial::curve_models::ProjectivePoint}::as_extended]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 339:4-346:5 -/
def backend.serial.curve_models.ProjectivePoint.as_extended
  (self : backend.serial.curve_models.ProjectivePoint) :
  Result edwards.EdwardsPoint
  := do
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X self.Z
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Y self.Z
  let fe2 ← backend.serial.u64.field.FieldElement51.square self.Z
  let fe3 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X self.Y
  ok { X := fe, Y := fe1, Z := fe2, T := fe3 }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Add<&'a (curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint), curve25519_dalek::backend::serial::curve_models::CompletedPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 412:0-431:1 -/
@[reducible]
def
  Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAProjectiveNielsPointCompletedPoint
  : core.ops.arith.Add edwards.EdwardsPoint
  backend.serial.curve_models.ProjectiveNielsPoint
  backend.serial.curve_models.CompletedPoint := {
  add :=
    Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAProjectiveNielsPointCompletedPoint.add
}

/-- [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Sub<&'a (curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint), curve25519_dalek::backend::serial::curve_models::CompletedPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}::sub]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 437:4-452:5 -/
def
  Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAProjectiveNielsPointCompletedPoint.sub
  (self : edwards.EdwardsPoint)
  (other : backend.serial.curve_models.ProjectiveNielsPoint) :
  Result backend.serial.curve_models.CompletedPoint
  := do
  let Y_plus_X ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      self.Y self.X
  let Y_minus_X ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      self.Y self.X
  let PM ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      Y_plus_X other.Y_minus_X
  let MP ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      Y_minus_X other.Y_plus_X
  let TT2d ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.T other.T2d
  let ZZ ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Z other.Z
  let ZZ2 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      ZZ ZZ
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      PM MP
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      PM MP
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      ZZ2 TT2d
  let fe3 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      ZZ2 TT2d
  ok { X := fe, Y := fe1, Z := fe2, T := fe3 }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Sub<&'a (curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint), curve25519_dalek::backend::serial::curve_models::CompletedPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 434:0-453:1 -/
@[reducible]
def
  Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAProjectiveNielsPointCompletedPoint
  : core.ops.arith.Sub edwards.EdwardsPoint
  backend.serial.curve_models.ProjectiveNielsPoint
  backend.serial.curve_models.CompletedPoint := {
  sub :=
    Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAProjectiveNielsPointCompletedPoint.sub
}

/-- [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Add<&'a (curve25519_dalek::backend::serial::curve_models::AffineNielsPoint), curve25519_dalek::backend::serial::curve_models::CompletedPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}::add]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 459:4-473:5 -/
def
  Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAAffineNielsPointCompletedPoint.add
  (self : edwards.EdwardsPoint)
  (other : backend.serial.curve_models.AffineNielsPoint) :
  Result backend.serial.curve_models.CompletedPoint
  := do
  let Y_plus_X ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      self.Y self.X
  let Y_minus_X ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      self.Y self.X
  let PP ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      Y_plus_X other.y_plus_x
  let MM ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      Y_minus_X other.y_minus_x
  let Txy2d ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.T other.xy2d
  let Z2 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      self.Z self.Z
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      PP MM
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      PP MM
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      Z2 Txy2d
  let fe3 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      Z2 Txy2d
  ok { X := fe, Y := fe1, Z := fe2, T := fe3 }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Add<&'a (curve25519_dalek::backend::serial::curve_models::AffineNielsPoint), curve25519_dalek::backend::serial::curve_models::CompletedPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 456:0-474:1 -/
@[reducible]
def
  Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAAffineNielsPointCompletedPoint
  : core.ops.arith.Add edwards.EdwardsPoint
  backend.serial.curve_models.AffineNielsPoint
  backend.serial.curve_models.CompletedPoint := {
  add :=
    Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAAffineNielsPointCompletedPoint.add
}

/-- [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Sub<&'a (curve25519_dalek::backend::serial::curve_models::AffineNielsPoint), curve25519_dalek::backend::serial::curve_models::CompletedPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}::sub]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 480:4-494:5 -/
def
  Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAAffineNielsPointCompletedPoint.sub
  (self : edwards.EdwardsPoint)
  (other : backend.serial.curve_models.AffineNielsPoint) :
  Result backend.serial.curve_models.CompletedPoint
  := do
  let Y_plus_X ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      self.Y self.X
  let Y_minus_X ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      self.Y self.X
  let PM ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      Y_plus_X other.y_minus_x
  let MP ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      Y_minus_X other.y_plus_x
  let Txy2d ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.T other.xy2d
  let Z2 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      self.Z self.Z
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      PM MP
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      PM MP
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      Z2 Txy2d
  let fe3 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      Z2 Txy2d
  ok { X := fe, Y := fe1, Z := fe2, T := fe3 }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Sub<&'a (curve25519_dalek::backend::serial::curve_models::AffineNielsPoint), curve25519_dalek::backend::serial::curve_models::CompletedPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 477:0-495:1 -/
@[reducible]
def
  Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAAffineNielsPointCompletedPoint
  : core.ops.arith.Sub edwards.EdwardsPoint
  backend.serial.curve_models.AffineNielsPoint
  backend.serial.curve_models.CompletedPoint := {
  sub :=
    Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAAffineNielsPointCompletedPoint.sub
}

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Neg<curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint> for &0 (curve25519_dalek::backend::serial::curve_models::ProjectiveNielsPoint)}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 501:0-512:1 -/
@[reducible]
def Shared0ProjectiveNielsPoint.Insts.CoreOpsArithNegProjectiveNielsPoint :
  core.ops.arith.Neg backend.serial.curve_models.ProjectiveNielsPoint
  backend.serial.curve_models.ProjectiveNielsPoint := {
  neg :=
    Shared0ProjectiveNielsPoint.Insts.CoreOpsArithNegProjectiveNielsPoint.neg
}

/-- [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Neg<curve25519_dalek::backend::serial::curve_models::AffineNielsPoint> for &0 (curve25519_dalek::backend::serial::curve_models::AffineNielsPoint)}::neg]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 525:4-531:5 -/
def Shared0AffineNielsPoint.Insts.CoreOpsArithNegAffineNielsPoint.neg
  (self : backend.serial.curve_models.AffineNielsPoint) :
  Result backend.serial.curve_models.AffineNielsPoint
  := do
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg self.xy2d
  ok { y_plus_x := self.y_minus_x, y_minus_x := self.y_plus_x, xy2d := fe }

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Neg<curve25519_dalek::backend::serial::curve_models::AffineNielsPoint> for &0 (curve25519_dalek::backend::serial::curve_models::AffineNielsPoint)}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 522:0-532:1 -/
@[reducible]
def Shared0AffineNielsPoint.Insts.CoreOpsArithNegAffineNielsPoint :
  core.ops.arith.Neg backend.serial.curve_models.AffineNielsPoint
  backend.serial.curve_models.AffineNielsPoint := {
  neg := Shared0AffineNielsPoint.Insts.CoreOpsArithNegAffineNielsPoint.neg
}

/-- [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Neg<curve25519_dalek::backend::serial::curve_models::AffineNielsPoint> for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}::neg]:
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 537:4-539:5 -/
def
  backend.serial.curve_models.AffineNielsPoint.Insts.CoreOpsArithNegAffineNielsPoint.neg
  (self : backend.serial.curve_models.AffineNielsPoint) :
  Result backend.serial.curve_models.AffineNielsPoint
  := do
  Shared0AffineNielsPoint.Insts.CoreOpsArithNegAffineNielsPoint.neg self

/-- Trait implementation: [curve25519_dalek::backend::serial::curve_models::{core::ops::arith::Neg<curve25519_dalek::backend::serial::curve_models::AffineNielsPoint> for curve25519_dalek::backend::serial::curve_models::AffineNielsPoint}]
   Source: 'curve25519-dalek/src/backend/serial/curve_models/mod.rs', lines 534:0-540:1 -/
@[reducible]
def
  backend.serial.curve_models.AffineNielsPoint.Insts.CoreOpsArithNegAffineNielsPoint
  : core.ops.arith.Neg backend.serial.curve_models.AffineNielsPoint
  backend.serial.curve_models.AffineNielsPoint := {
  neg :=
    backend.serial.curve_models.AffineNielsPoint.Insts.CoreOpsArithNegAffineNielsPoint.neg
}

/-- [curve25519_dalek::backend::serial::u64::constants::MINUS_ONE]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 26:0-32:3 -/
@[global_simps]
def backend.serial.u64.constants.MINUS_ONE_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [
      2251799813685228#u64, 2251799813685247#u64, 2251799813685247#u64,
      2251799813685247#u64, 2251799813685247#u64
      ])
@[global_simps, irreducible]
def backend.serial.u64.constants.MINUS_ONE
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.MINUS_ONE_body

/-- [curve25519_dalek::backend::serial::u64::constants::ONE_MINUS_EDWARDS_D_SQUARED]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 63:0-69:3 -/
@[global_simps]
def backend.serial.u64.constants.ONE_MINUS_EDWARDS_D_SQUARED_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [
      1136626929484150#u64, 1998550399581263#u64, 496427632559748#u64,
      118527312129759#u64, 45110755273534#u64
      ])
@[global_simps, irreducible]
def backend.serial.u64.constants.ONE_MINUS_EDWARDS_D_SQUARED
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.ONE_MINUS_EDWARDS_D_SQUARED_body

/-- [curve25519_dalek::backend::serial::u64::constants::EDWARDS_D_MINUS_ONE_SQUARED]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 72:0-78:3 -/
@[global_simps]
def backend.serial.u64.constants.EDWARDS_D_MINUS_ONE_SQUARED_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [
      1507062230895904#u64, 1572317787530805#u64, 683053064812840#u64,
      317374165784489#u64, 1572899562415810#u64
      ])
@[global_simps, irreducible]
def backend.serial.u64.constants.EDWARDS_D_MINUS_ONE_SQUARED
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.EDWARDS_D_MINUS_ONE_SQUARED_body

/-- [curve25519_dalek::backend::serial::u64::constants::SQRT_AD_MINUS_ONE]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 81:0-87:3 -/
@[global_simps]
def backend.serial.u64.constants.SQRT_AD_MINUS_ONE_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [
      2241493124984347#u64, 425987919032274#u64, 2207028919301688#u64,
      1220490630685848#u64, 974799131293748#u64
      ])
@[global_simps, irreducible]
def backend.serial.u64.constants.SQRT_AD_MINUS_ONE
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.SQRT_AD_MINUS_ONE_body

/-- [curve25519_dalek::backend::serial::u64::constants::INVSQRT_A_MINUS_D]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 90:0-96:3 -/
@[global_simps]
def backend.serial.u64.constants.INVSQRT_A_MINUS_D_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [
      278908739862762#u64, 821645201101625#u64, 8113234426968#u64,
      1777959178193151#u64, 2118520810568447#u64
      ])
@[global_simps, irreducible]
def backend.serial.u64.constants.INVSQRT_A_MINUS_D
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.INVSQRT_A_MINUS_D_body

/-- [curve25519_dalek::backend::serial::u64::constants::SQRT_M1]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 99:0-105:3 -/
@[global_simps]
def backend.serial.u64.constants.SQRT_M1_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [
      1718705420411056#u64, 234908883556509#u64, 2233514472574048#u64,
      2117202627021982#u64, 765476049583133#u64
      ])
@[global_simps, irreducible]
def backend.serial.u64.constants.SQRT_M1
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.SQRT_M1_body

/-- [curve25519_dalek::backend::serial::u64::constants::APLUS2_OVER_FOUR]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 108:0-109:53 -/
@[global_simps]
def backend.serial.u64.constants.APLUS2_OVER_FOUR_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [ 121666#u64, 0#u64, 0#u64, 0#u64, 0#u64 ])
@[global_simps, irreducible]
def backend.serial.u64.constants.APLUS2_OVER_FOUR
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.APLUS2_OVER_FOUR_body

/-- [curve25519_dalek::backend::serial::u64::constants::MONTGOMERY_A]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 114:0-114:97 -/
@[global_simps]
def backend.serial.u64.constants.MONTGOMERY_A_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [ 486662#u64, 0#u64, 0#u64, 0#u64, 0#u64 ])
@[global_simps, irreducible]
def backend.serial.u64.constants.MONTGOMERY_A
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.MONTGOMERY_A_body

/-- [curve25519_dalek::backend::serial::u64::constants::MONTGOMERY_A_NEG]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 118:0-124:3 -/
@[global_simps]
def backend.serial.u64.constants.MONTGOMERY_A_NEG_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [
      2251799813198567#u64, 2251799813685247#u64, 2251799813685247#u64,
      2251799813685247#u64, 2251799813685247#u64
      ])
@[global_simps, irreducible]
def backend.serial.u64.constants.MONTGOMERY_A_NEG
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.constants.MONTGOMERY_A_NEG_body

/-- [curve25519_dalek::backend::serial::u64::constants::L]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 127:0-133:3 -/
@[global_simps, irreducible]
def backend.serial.u64.constants.L : backend.serial.u64.scalar.Scalar52 :=
  Array.make 5#usize [
    671914833335277#u64, 3916664325105025#u64, 1367801#u64, 0#u64,
    17592186044416#u64
    ]

/-- [curve25519_dalek::backend::serial::u64::constants::LFACTOR]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 136:0-136:48 -/
@[global_simps, irreducible]
def backend.serial.u64.constants.LFACTOR : Std.U64 := 1439961107955227#u64

/-- [curve25519_dalek::backend::serial::u64::constants::R]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 139:0-145:3 -/
@[global_simps, irreducible]
def backend.serial.u64.constants.R : backend.serial.u64.scalar.Scalar52 :=
  Array.make 5#usize [
    4302102966953709#u64, 1049714374468698#u64, 4503599278581019#u64,
    4503599627370495#u64, 17592186044415#u64
    ]

/-- [curve25519_dalek::backend::serial::u64::constants::RR]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 148:0-154:3 -/
@[global_simps, irreducible]
def backend.serial.u64.constants.RR : backend.serial.u64.scalar.Scalar52 :=
  Array.make 5#usize [
    2764609938444603#u64, 3768881411696287#u64, 1616719297148420#u64,
    1087343033131391#u64, 10175238647962#u64
    ]

/-- [curve25519_dalek::backend::serial::u64::constants::ED25519_BASEPOINT_POINT]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 161:0-184:2 -/
@[global_simps]
def backend.serial.u64.constants.ED25519_BASEPOINT_POINT_body
  : Result edwards.EdwardsPoint := do
  let fe ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        1738742601995546#u64, 1146398526822698#u64, 2070867633025821#u64,
        562264141797630#u64, 587772402128613#u64
        ])
  let fe1 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        1801439850948184#u64, 1351079888211148#u64, 450359962737049#u64,
        900719925474099#u64, 1801439850948198#u64
        ])
  let fe2 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [ 1#u64, 0#u64, 0#u64, 0#u64, 0#u64 ])
  let fe3 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        1841354044333475#u64, 16398895984059#u64, 755974180946558#u64,
        900171276175154#u64, 1821297809914039#u64
        ])
  ok { X := fe, Y := fe1, Z := fe2, T := fe3 }
@[global_simps, irreducible]
def backend.serial.u64.constants.ED25519_BASEPOINT_POINT
  : edwards.EdwardsPoint :=
  eval_global backend.serial.u64.constants.ED25519_BASEPOINT_POINT_body

/-- [curve25519_dalek::backend::serial::u64::constants::EIGHT_TORSION_INNER_DOC_HIDDEN]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 198:0-337:2 -/
@[global_simps]
def backend.serial.u64.constants.EIGHT_TORSION_INNER_DOC_HIDDEN_body
  : Result (Array edwards.EdwardsPoint 8#usize) := do
  let a := Array.repeat 5#usize 0#u64
  let fe ← backend.serial.u64.field.FieldElement51.from_limbs a
  let fe1 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [ 1#u64, 0#u64, 0#u64, 0#u64, 0#u64 ])
  let a1 := Array.repeat 5#usize 0#u64
  let fe2 ← backend.serial.u64.field.FieldElement51.from_limbs a1
  let fe3 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        358744748052810#u64, 1691584618240980#u64, 977650209285361#u64,
        1429865912637724#u64, 560044844278676#u64
        ])
  let fe4 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        84926274344903#u64, 473620666599931#u64, 365590438845504#u64,
        1028470286882429#u64, 2146499180330972#u64
        ])
  let fe5 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        1448326834587521#u64, 1857896831960481#u64, 1093722731865333#u64,
        1677408490711241#u64, 1915505153018406#u64
        ])
  let fe6 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        533094393274173#u64, 2016890930128738#u64, 18285341111199#u64,
        134597186663265#u64, 1486323764102114#u64
        ])
  let a2 := Array.repeat 5#usize 0#u64
  let fe7 ← backend.serial.u64.field.FieldElement51.from_limbs a2
  let a3 := Array.repeat 5#usize 0#u64
  let fe8 ← backend.serial.u64.field.FieldElement51.from_limbs a3
  let fe9 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        2166873539340326#u64, 1778179147085316#u64, 1886209374839743#u64,
        1223329526802818#u64, 105300633354275#u64
        ])
  let fe10 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        803472979097708#u64, 393902981724766#u64, 1158077081819914#u64,
        574391322974006#u64, 336294660666841#u64
        ])
  let a4 := Array.repeat 5#usize 0#u64
  let fe11 ← backend.serial.u64.field.FieldElement51.from_limbs a4
  let fe12 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        2251799813685228#u64, 2251799813685247#u64, 2251799813685247#u64,
        2251799813685247#u64, 2251799813685247#u64
        ])
  let a5 := Array.repeat 5#usize 0#u64
  let fe13 ← backend.serial.u64.field.FieldElement51.from_limbs a5
  let fe14 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        1893055065632419#u64, 560215195444267#u64, 1274149604399886#u64,
        821933901047523#u64, 1691754969406571#u64
        ])
  let fe15 ←
    backend.serial.u64.field.FieldElement51.from_limbs
      (Array.make 5#usize [
        1718705420411056#u64, 234908883556509#u64, 2233514472574048#u64,
        2117202627021982#u64, 765476049583133#u64
        ])
  let a6 := Array.repeat 5#usize 0#u64
  let fe16 ← backend.serial.u64.field.FieldElement51.from_limbs a6
  let a7 := Array.repeat 5#usize 0#u64
  let fe17 ← backend.serial.u64.field.FieldElement51.from_limbs a7
  ok
    (Array.make 8#usize [
      { X := fe, Y := fe1, Z := fe1, T := fe2 },
      { X := fe3, Y := fe4, Z := fe1, T := fe5 },
      { X := fe6, Y := fe7, Z := fe1, T := fe8 },
      { X := fe3, Y := fe9, Z := fe1, T := fe10 },
      { X := fe11, Y := fe12, Z := fe1, T := fe13 },
      { X := fe14, Y := fe9, Z := fe1, T := fe5 },
      { X := fe15, Y := fe16, Z := fe1, T := fe17 },
      { X := fe14, Y := fe4, Z := fe1, T := fe10 }
      ])
@[global_simps, irreducible]
def backend.serial.u64.constants.EIGHT_TORSION_INNER_DOC_HIDDEN
  : Array edwards.EdwardsPoint 8#usize :=
  eval_global backend.serial.u64.constants.EIGHT_TORSION_INNER_DOC_HIDDEN_body

/-- [curve25519_dalek::backend::serial::u64::constants::EIGHT_TORSION]
   Source: 'curve25519-dalek/src/backend/serial/u64/constants.rs', lines 194:0-194:76 -/
@[global_simps, irreducible]
def backend.serial.u64.constants.EIGHT_TORSION
  : Array edwards.EdwardsPoint 8#usize :=
  backend.serial.u64.constants.EIGHT_TORSION_INNER_DOC_HIDDEN

/-- [curve25519_dalek::backend::serial::u64::field::{core::clone::Clone for curve25519_dalek::backend::serial::u64::field::FieldElement51}::clone]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 42:15-42:20 -/
def backend.serial.u64.field.FieldElement51.Insts.CoreCloneClone.clone
  (self : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  ok self

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{core::clone::Clone for curve25519_dalek::backend::serial::u64::field::FieldElement51}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 42:15-42:20 -/
@[reducible]
def backend.serial.u64.field.FieldElement51.Insts.CoreCloneClone :
  core.clone.Clone backend.serial.u64.field.FieldElement51 := {
  clone := backend.serial.u64.field.FieldElement51.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{core::marker::Copy for curve25519_dalek::backend::serial::u64::field::FieldElement51}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 42:9-42:13 -/
@[reducible]
def backend.serial.u64.field.FieldElement51.Insts.CoreMarkerCopy :
  core.marker.Copy backend.serial.u64.field.FieldElement51 := {
  cloneInst := backend.serial.u64.field.FieldElement51.Insts.CoreCloneClone
}

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{zeroize::Zeroize for curve25519_dalek::backend::serial::u64::field::FieldElement51}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 52:0-56:1 -/
@[reducible]
def backend.serial.u64.field.FieldElement51.Insts.ZeroizeZeroize :
  zeroize.Zeroize backend.serial.u64.field.FieldElement51 := {
  zeroize :=
    backend.serial.u64.field.FieldElement51.Insts.ZeroizeZeroize.zeroize
}

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::AddAssign<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51)> for curve25519_dalek::backend::serial::u64::field::FieldElement51}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 58:0-66:1 -/
@[reducible]
def
  backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithAddAssignSharedAFieldElement51
  : core.ops.arith.AddAssign backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51 := {
  add_assign :=
    backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithAddAssignSharedAFieldElement51.add_assign
}

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::Add<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51), curve25519_dalek::backend::serial::u64::field::FieldElement51> for &1 (curve25519_dalek::backend::serial::u64::field::FieldElement51)}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 68:0-75:1 -/
@[reducible]
def
  Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51
  : core.ops.arith.Add backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51 := {
  add :=
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
}

/-- [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::SubAssign<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51)> for curve25519_dalek::backend::serial::u64::field::FieldElement51}::sub_assign]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 78:4-81:5 -/
def
  backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithSubAssignSharedAFieldElement51.sub_assign
  (self : backend.serial.u64.field.FieldElement51)
  (_rhs : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let result ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      self _rhs
  ok result

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::SubAssign<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51)> for curve25519_dalek::backend::serial::u64::field::FieldElement51}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 77:0-82:1 -/
@[reducible]
def
  backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithSubAssignSharedAFieldElement51
  : core.ops.arith.SubAssign backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51 := {
  sub_assign :=
    backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithSubAssignSharedAFieldElement51.sub_assign
}

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::Sub<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51), curve25519_dalek::backend::serial::u64::field::FieldElement51> for &1 (curve25519_dalek::backend::serial::u64::field::FieldElement51)}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 84:0-104:1 -/
@[reducible]
def
  Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51
  : core.ops.arith.Sub backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51 := {
  sub :=
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
}

/-- [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::MulAssign<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51)> for curve25519_dalek::backend::serial::u64::field::FieldElement51}::mul_assign]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 107:4-110:5 -/
def
  backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithMulAssignSharedAFieldElement51.mul_assign
  (self : backend.serial.u64.field.FieldElement51)
  (_rhs : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let result ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self _rhs
  ok result

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::MulAssign<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51)> for curve25519_dalek::backend::serial::u64::field::FieldElement51}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 106:0-111:1 -/
@[reducible]
def
  backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithMulAssignSharedAFieldElement51
  : core.ops.arith.MulAssign backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51 := {
  mul_assign :=
    backend.serial.u64.field.FieldElement51.Insts.CoreOpsArithMulAssignSharedAFieldElement51.mul_assign
}

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::Mul<&'a (curve25519_dalek::backend::serial::u64::field::FieldElement51), curve25519_dalek::backend::serial::u64::field::FieldElement51> for &1 (curve25519_dalek::backend::serial::u64::field::FieldElement51)}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 113:0-216:1 -/
@[reducible]
def
  Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51
  : core.ops.arith.Mul backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51 := {
  mul :=
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
}

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{core::ops::arith::Neg<curve25519_dalek::backend::serial::u64::field::FieldElement51> for &0 (curve25519_dalek::backend::serial::u64::field::FieldElement51)}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 218:0-225:1 -/
@[reducible]
def Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51 :
  core.ops.arith.Neg backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51 := {
  neg := Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg
}

/-- [curve25519_dalek::backend::serial::u64::field::{subtle::ConditionallySelectable for curve25519_dalek::backend::serial::u64::field::FieldElement51}::conditional_swap]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 242:4-248:5 -/
def
  backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_swap
  (a : backend.serial.u64.field.FieldElement51)
  (b : backend.serial.u64.field.FieldElement51) (choice : subtle.Choice) :
  Result (backend.serial.u64.field.FieldElement51 ×
    backend.serial.u64.field.FieldElement51)
  := do
  let (i, index_mut_back) ← Array.index_mut_usize a 0#usize
  let (i1, index_mut_back1) ← Array.index_mut_usize b 0#usize
  let (i2, i3) ←
    U64.Insts.SubtleConditionallySelectable.conditional_swap i i1 choice
  let a1 := index_mut_back i2
  let (i4, index_mut_back2) ← Array.index_mut_usize a1 1#usize
  let a2 := index_mut_back1 i3
  let (i5, index_mut_back3) ← Array.index_mut_usize a2 1#usize
  let (i6, i7) ←
    U64.Insts.SubtleConditionallySelectable.conditional_swap i4 i5 choice
  let a3 := index_mut_back2 i6
  let (i8, index_mut_back4) ← Array.index_mut_usize a3 2#usize
  let a4 := index_mut_back3 i7
  let (i9, index_mut_back5) ← Array.index_mut_usize a4 2#usize
  let (i10, i11) ←
    U64.Insts.SubtleConditionallySelectable.conditional_swap i8 i9 choice
  let a5 := index_mut_back4 i10
  let (i12, index_mut_back6) ← Array.index_mut_usize a5 3#usize
  let a6 := index_mut_back5 i11
  let (i13, index_mut_back7) ← Array.index_mut_usize a6 3#usize
  let (i14, i15) ←
    U64.Insts.SubtleConditionallySelectable.conditional_swap i12 i13 choice
  let a7 := index_mut_back6 i14
  let (i16, index_mut_back8) ← Array.index_mut_usize a7 4#usize
  let a8 := index_mut_back7 i15
  let (i17, index_mut_back9) ← Array.index_mut_usize a8 4#usize
  let (i18, i19) ←
    U64.Insts.SubtleConditionallySelectable.conditional_swap i16 i17 choice
  let a9 := index_mut_back8 i18
  let a10 := index_mut_back9 i19
  ok (a9, a10)

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::field::{subtle::ConditionallySelectable for curve25519_dalek::backend::serial::u64::field::FieldElement51}]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 227:0-257:1 -/
@[reducible]
def backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable
  : subtle.ConditionallySelectable backend.serial.u64.field.FieldElement51 := {
  coremarkerCopyInst :=
    backend.serial.u64.field.FieldElement51.Insts.CoreMarkerCopy
  conditional_select :=
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
  conditional_assign :=
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
  conditional_swap :=
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_swap
}

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::MINUS_ONE]
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 269:4-275:7 -/
@[global_simps]
def backend.serial.u64.field.FieldElement51.MINUS_ONE_body
  : Result backend.serial.u64.field.FieldElement51 := do
  backend.serial.u64.field.FieldElement51.from_limbs
    (Array.make 5#usize [
      2251799813685228#u64, 2251799813685247#u64, 2251799813685247#u64,
      2251799813685247#u64, 2251799813685247#u64
      ])
@[global_simps, irreducible]
def backend.serial.u64.field.FieldElement51.MINUS_ONE
  : backend.serial.u64.field.FieldElement51 :=
  eval_global backend.serial.u64.field.FieldElement51.MINUS_ONE_body

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::from_bytes::load8_at]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 341:8-350:9 -/
def backend.serial.u64.field.FieldElement51.from_bytes.load8_at
  (input : Slice Std.U8) (i : Std.Usize) : Result Std.U64 := do
  let i1 ← Slice.index_usize input i
  let i2 ← (↑(UScalar.cast .U64 i1) : Result Std.U64)
  let i3 ← i + 1#usize
  let i4 ← Slice.index_usize input i3
  let i5 ← (↑(UScalar.cast .U64 i4) : Result Std.U64)
  let i6 ← i5 <<< 8#i32
  let i7 ← (↑(i2 ||| i6) : Result Std.U64)
  let i8 ← i + 2#usize
  let i9 ← Slice.index_usize input i8
  let i10 ← (↑(UScalar.cast .U64 i9) : Result Std.U64)
  let i11 ← i10 <<< 16#i32
  let i12 ← (↑(i7 ||| i11) : Result Std.U64)
  let i13 ← i + 3#usize
  let i14 ← Slice.index_usize input i13
  let i15 ← (↑(UScalar.cast .U64 i14) : Result Std.U64)
  let i16 ← i15 <<< 24#i32
  let i17 ← (↑(i12 ||| i16) : Result Std.U64)
  let i18 ← i + 4#usize
  let i19 ← Slice.index_usize input i18
  let i20 ← (↑(UScalar.cast .U64 i19) : Result Std.U64)
  let i21 ← i20 <<< 32#i32
  let i22 ← (↑(i17 ||| i21) : Result Std.U64)
  let i23 ← i + 5#usize
  let i24 ← Slice.index_usize input i23
  let i25 ← (↑(UScalar.cast .U64 i24) : Result Std.U64)
  let i26 ← i25 <<< 40#i32
  let i27 ← (↑(i22 ||| i26) : Result Std.U64)
  let i28 ← i + 6#usize
  let i29 ← Slice.index_usize input i28
  let i30 ← (↑(UScalar.cast .U64 i29) : Result Std.U64)
  let i31 ← i30 <<< 48#i32
  let i32 ← (↑(i27 ||| i31) : Result Std.U64)
  let i33 ← i + 7#usize
  let i34 ← Slice.index_usize input i33
  let i35 ← (↑(UScalar.cast .U64 i34) : Result Std.U64)
  let i36 ← i35 <<< 56#i32
  ok (i32 ||| i36)

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::from_bytes]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 340:4-365:5 -/
def backend.serial.u64.field.FieldElement51.from_bytes
  (bytes : Array Std.U8 32#usize) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let i ← 1#u64 <<< 51#i32
  let low_51_bit_mask ← i - 1#u64
  let s ← (↑(Array.to_slice bytes) : Result (Slice Std.U8))
  let i1 ←
    backend.serial.u64.field.FieldElement51.from_bytes.load8_at s 0#usize
  let i2 ← (↑(i1 &&& low_51_bit_mask) : Result Std.U64)
  let s1 ← (↑(Array.to_slice bytes) : Result (Slice Std.U8))
  let i3 ←
    backend.serial.u64.field.FieldElement51.from_bytes.load8_at s1 6#usize
  let i4 ← i3 >>> 3#i32
  let i5 ← (↑(i4 &&& low_51_bit_mask) : Result Std.U64)
  let s2 ← (↑(Array.to_slice bytes) : Result (Slice Std.U8))
  let i6 ←
    backend.serial.u64.field.FieldElement51.from_bytes.load8_at s2 12#usize
  let i7 ← i6 >>> 6#i32
  let i8 ← (↑(i7 &&& low_51_bit_mask) : Result Std.U64)
  let s3 ← (↑(Array.to_slice bytes) : Result (Slice Std.U8))
  let i9 ←
    backend.serial.u64.field.FieldElement51.from_bytes.load8_at s3 19#usize
  let i10 ← i9 >>> 1#i32
  let i11 ← (↑(i10 &&& low_51_bit_mask) : Result Std.U64)
  let s4 ← (↑(Array.to_slice bytes) : Result (Slice Std.U8))
  let i12 ←
    backend.serial.u64.field.FieldElement51.from_bytes.load8_at s4 24#usize
  let i13 ← i12 >>> 12#i32
  let i14 ← (↑(i13 &&& low_51_bit_mask) : Result Std.U64)
  ok (Array.make 5#usize [ i2, i5, i8, i11, i14 ])

/-- [curve25519_dalek::backend::serial::u64::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::as_bytes]:
   Source: 'curve25519-dalek/src/backend/serial/u64/field.rs', lines 369:4-371:5 -/
def backend.serial.u64.field.FieldElement51.as_bytes
  (self : backend.serial.u64.field.FieldElement51) :
  Result (Array Std.U8 32#usize)
  := do
  backend.serial.u64.field.FieldElement51.to_bytes self

/-- [curve25519_dalek::backend::serial::u64::scalar::{core::clone::Clone for curve25519_dalek::backend::serial::u64::scalar::Scalar52}::clone]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 25:15-25:20 -/
def backend.serial.u64.scalar.Scalar52.Insts.CoreCloneClone.clone
  (self : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  ok self

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::scalar::{core::clone::Clone for curve25519_dalek::backend::serial::u64::scalar::Scalar52}]
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 25:15-25:20 -/
@[reducible]
def backend.serial.u64.scalar.Scalar52.Insts.CoreCloneClone : core.clone.Clone
  backend.serial.u64.scalar.Scalar52 := {
  clone := backend.serial.u64.scalar.Scalar52.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::scalar::{core::marker::Copy for curve25519_dalek::backend::serial::u64::scalar::Scalar52}]
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 25:9-25:13 -/
@[reducible]
def backend.serial.u64.scalar.Scalar52.Insts.CoreMarkerCopy : core.marker.Copy
  backend.serial.u64.scalar.Scalar52 := {
  cloneInst := backend.serial.u64.scalar.Scalar52.Insts.CoreCloneClone
}

/-- [curve25519_dalek::backend::serial::u64::scalar::{zeroize::Zeroize for curve25519_dalek::backend::serial::u64::scalar::Scalar52}::zeroize]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 36:4-38:5 -/
def backend.serial.u64.scalar.Scalar52.Insts.ZeroizeZeroize.zeroize
  (self : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let a ←
    Array.Insts.ZeroizeZeroize.zeroize (zeroize.Zeroize.Blanket
      U64.Insts.ZeroizeDefaultIsZeroes) self
  ok a

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::scalar::{zeroize::Zeroize for curve25519_dalek::backend::serial::u64::scalar::Scalar52}]
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 35:0-39:1 -/
@[reducible]
def backend.serial.u64.scalar.Scalar52.Insts.ZeroizeZeroize : zeroize.Zeroize
  backend.serial.u64.scalar.Scalar52 := {
  zeroize := backend.serial.u64.scalar.Scalar52.Insts.ZeroizeZeroize.zeroize
}

/-- [curve25519_dalek::backend::serial::u64::scalar::{core::ops::index::Index<usize, u64> for curve25519_dalek::backend::serial::u64::scalar::Scalar52}::index]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 43:4-45:5 -/
def backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
  (self : backend.serial.u64.scalar.Scalar52) (_index : Std.Usize) :
  Result Std.U64
  := do
  Array.index_usize self _index

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::scalar::{core::ops::index::Index<usize, u64> for curve25519_dalek::backend::serial::u64::scalar::Scalar52}]
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 41:0-46:1 -/
@[reducible]
def backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64 :
  core.ops.index.Index backend.serial.u64.scalar.Scalar52 Std.Usize Std.U64
  := {
  index :=
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
}

/-- [curve25519_dalek::backend::serial::u64::scalar::{core::ops::index::IndexMut<usize, u64> for curve25519_dalek::backend::serial::u64::scalar::Scalar52}::index_mut]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 49:4-51:5 -/
def
  backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
  (self : backend.serial.u64.scalar.Scalar52) (_index : Std.Usize) :
  Result (Std.U64 × (Std.U64 → backend.serial.u64.scalar.Scalar52))
  := do
  let (i, index_mut_back) ← Array.index_mut_usize self _index
  let back := fun i1 => let a := index_mut_back i1
                        a
  ok (i, back)

/-- Trait implementation: [curve25519_dalek::backend::serial::u64::scalar::{core::ops::index::IndexMut<usize, u64> for curve25519_dalek::backend::serial::u64::scalar::Scalar52}]
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 48:0-52:1 -/
@[reducible]
def backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64 :
  core.ops.index.IndexMut backend.serial.u64.scalar.Scalar52 Std.Usize Std.U64
  := {
  indexInst :=
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64
  index_mut :=
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
}

/-- [curve25519_dalek::backend::serial::u64::scalar::m]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 56:0-58:1 -/
def backend.serial.u64.scalar.m
  (x : Std.U64) (y : Std.U64) : Result Std.U128 := do
  let i ← (↑(UScalar.cast .U128 x) : Result Std.U128)
  let i1 ← (↑(UScalar.cast .U128 y) : Result Std.U128)
  i * i1

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::ZERO]
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 62:4-62:57 -/
@[global_simps]
def backend.serial.u64.scalar.Scalar52.ZERO_body
  : Result backend.serial.u64.scalar.Scalar52 := do
  let a := Array.repeat 5#usize 0#u64
  ok a
@[global_simps, irreducible]
def backend.serial.u64.scalar.Scalar52.ZERO
  : backend.serial.u64.scalar.Scalar52 :=
  eval_global backend.serial.u64.scalar.Scalar52.ZERO_body

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::from_bytes]: loop 0:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 69:8-80:9 -/
def backend.serial.u64.scalar.Scalar52.from_bytes_loop
  (bytes : Array Std.U8 32#usize) (words : Array Std.U64 4#usize)
  (i : Std.Usize) :
  Result (Array Std.U64 4#usize)
  := do
  if i < 4#usize
  then
    let base ← i * 8#usize
    let i1 ← Array.index_usize bytes base
    let i2 ← (↑(UScalar.cast .U64 i1) : Result Std.U64)
    let i3 ← base + 1#usize
    let i4 ← Array.index_usize bytes i3
    let i5 ← (↑(UScalar.cast .U64 i4) : Result Std.U64)
    let i6 ← i5 <<< 8#i32
    let i7 ← (↑(i2 ||| i6) : Result Std.U64)
    let i8 ← base + 2#usize
    let i9 ← Array.index_usize bytes i8
    let i10 ← (↑(UScalar.cast .U64 i9) : Result Std.U64)
    let i11 ← i10 <<< 16#i32
    let i12 ← (↑(i7 ||| i11) : Result Std.U64)
    let i13 ← base + 3#usize
    let i14 ← Array.index_usize bytes i13
    let i15 ← (↑(UScalar.cast .U64 i14) : Result Std.U64)
    let i16 ← i15 <<< 24#i32
    let i17 ← (↑(i12 ||| i16) : Result Std.U64)
    let i18 ← base + 4#usize
    let i19 ← Array.index_usize bytes i18
    let i20 ← (↑(UScalar.cast .U64 i19) : Result Std.U64)
    let i21 ← i20 <<< 32#i32
    let i22 ← (↑(i17 ||| i21) : Result Std.U64)
    let i23 ← base + 5#usize
    let i24 ← Array.index_usize bytes i23
    let i25 ← (↑(UScalar.cast .U64 i24) : Result Std.U64)
    let i26 ← i25 <<< 40#i32
    let i27 ← (↑(i22 ||| i26) : Result Std.U64)
    let i28 ← base + 6#usize
    let i29 ← Array.index_usize bytes i28
    let i30 ← (↑(UScalar.cast .U64 i29) : Result Std.U64)
    let i31 ← i30 <<< 48#i32
    let i32 ← (↑(i27 ||| i31) : Result Std.U64)
    let i33 ← base + 7#usize
    let i34 ← Array.index_usize bytes i33
    let i35 ← (↑(UScalar.cast .U64 i34) : Result Std.U64)
    let i36 ← i35 <<< 56#i32
    let i37 ← (↑(i32 ||| i36) : Result Std.U64)
    let a ← Array.update words i i37
    let i38 ← i + 1#usize
    backend.serial.u64.scalar.Scalar52.from_bytes_loop bytes a i38
  else ok words
partial_fixpoint

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::from_bytes]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 66:4-93:5 -/
def backend.serial.u64.scalar.Scalar52.from_bytes
  (bytes : Array Std.U8 32#usize) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let words := Array.repeat 4#usize 0#u64
  let words1 ←
    backend.serial.u64.scalar.Scalar52.from_bytes_loop bytes words 0#usize
  let i ← 1#u64 <<< 52#i32
  let mask ← i - 1#u64
  let i1 ← 1#u64 <<< 48#i32
  let top_mask ← i1 - 1#u64
  let i2 ← Array.index_usize words1 0#usize
  let (_, index_mut_back) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      backend.serial.u64.scalar.Scalar52.ZERO 0#usize
  let i3 ← (↑(i2 &&& mask) : Result Std.U64)
  let i4 ← i2 >>> 52#i32
  let i5 ← Array.index_usize words1 1#usize
  let i6 ← i5 <<< 12#i32
  let i7 ← (↑(i4 ||| i6) : Result Std.U64)
  let s := index_mut_back i3
  let (_, index_mut_back1) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      s 1#usize
  let i8 ← (↑(i7 &&& mask) : Result Std.U64)
  let i9 ← i5 >>> 40#i32
  let i10 ← Array.index_usize words1 2#usize
  let i11 ← i10 <<< 24#i32
  let i12 ← (↑(i9 ||| i11) : Result Std.U64)
  let s1 := index_mut_back1 i8
  let (_, index_mut_back2) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      s1 2#usize
  let i13 ← (↑(i12 &&& mask) : Result Std.U64)
  let i14 ← i10 >>> 28#i32
  let i15 ← Array.index_usize words1 3#usize
  let i16 ← i15 <<< 36#i32
  let i17 ← (↑(i14 ||| i16) : Result Std.U64)
  let s2 := index_mut_back2 i13
  let (_, index_mut_back3) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      s2 3#usize
  let i18 ← (↑(i17 &&& mask) : Result Std.U64)
  let i19 ← i15 >>> 16#i32
  let s3 := index_mut_back3 i18
  let (_, index_mut_back4) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      s3 4#usize
  let i20 ← (↑(i19 &&& top_mask) : Result Std.U64)
  ok (index_mut_back4 i20)

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::montgomery_reduce::part2]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 283:8-286:9 -/
def backend.serial.u64.scalar.Scalar52.montgomery_reduce.part2
  (sum : Std.U128) : Result (Std.U128 × Std.U64) := do
  let i ← (↑(UScalar.cast .U64 sum) : Result Std.U64)
  let i1 ← 1#u64 <<< 52#i32
  let i2 ← i1 - 1#u64
  let w ← (↑(i &&& i2) : Result Std.U64)
  let i3 ← sum >>> 52#i32
  ok (i3, w)

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::montgomery_reduce::part1]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 277:8-280:9 -/
def backend.serial.u64.scalar.Scalar52.montgomery_reduce.part1
  (sum : Std.U128) : Result (Std.U128 × Std.U64) := do
  let i ← (↑(UScalar.cast .U64 sum) : Result Std.U64)
  let i1 ←
    (↑(core.num.U64.wrapping_mul i backend.serial.u64.constants.LFACTOR) :
      Result Std.U64)
  let i2 ← 1#u64 <<< 52#i32
  let i3 ← i2 - 1#u64
  let p ← (↑(i1 &&& i3) : Result Std.U64)
  let i4 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
      backend.serial.u64.constants.L 0#usize
  let i5 ← backend.serial.u64.scalar.m p i4
  let i6 ← sum + i5
  let i7 ← i6 >>> 52#i32
  ok (i7, p)

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::conditional_add_l]: loop 0:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 218:14-218:19 -/
def backend.serial.u64.scalar.Scalar52.conditional_add_l_loop
  (self : backend.serial.u64.scalar.Scalar52) (condition : subtle.Choice)
  (carry : Std.U64) (mask : Std.U64) (i : Std.Usize) :
  Result (Std.U64 × backend.serial.u64.scalar.Scalar52)
  := do
  if i < 5#usize
  then
    let i1 ←
      backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
        backend.serial.u64.constants.L i
    let addend ←
      U64.Insts.SubtleConditionallySelectable.conditional_select 0#u64 i1
        condition
    let i2 ← carry >>> 52#i32
    let i3 ←
      backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
        self i
    let i4 ← i2 + i3
    let carry1 ← i4 + addend
    let (_, index_mut_back) ←
      backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
        self i
    let i5 ← (↑(carry1 &&& mask) : Result Std.U64)
    let i6 ← i + 1#usize
    let self1 := index_mut_back i5
    backend.serial.u64.scalar.Scalar52.conditional_add_l_loop self1 condition
      carry1 mask i6
  else ok (carry, self)
partial_fixpoint

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::conditional_add_l]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 213:4-226:5 -/
def backend.serial.u64.scalar.Scalar52.conditional_add_l
  (self : backend.serial.u64.scalar.Scalar52) (condition : subtle.Choice) :
  Result (Std.U64 × backend.serial.u64.scalar.Scalar52)
  := do
  let i ← 1#u64 <<< 52#i32
  let mask ← i - 1#u64
  backend.serial.u64.scalar.Scalar52.conditional_add_l_loop self condition
    0#u64 mask 0#usize

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::sub]: loop 0:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 202:8-206:9 -/
def backend.serial.u64.scalar.Scalar52.sub_loop
  (a : backend.serial.u64.scalar.Scalar52)
  (b : backend.serial.u64.scalar.Scalar52)
  (difference : backend.serial.u64.scalar.Scalar52) (mask : Std.U64)
  (borrow : Std.U64) (i : Std.Usize) :
  Result (backend.serial.u64.scalar.Scalar52 × Std.U64)
  := do
  if i < 5#usize
  then
    let i1 ←
      backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
        a i
    let i2 ←
      backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
        b i
    let i3 ← borrow >>> 63#i32
    let i4 ← i2 + i3
    let borrow1 ← (↑(core.num.U64.wrapping_sub i1 i4) : Result Std.U64)
    let (_, index_mut_back) ←
      backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
        difference i
    let i5 ← (↑(borrow1 &&& mask) : Result Std.U64)
    let i6 ← i + 1#usize
    let difference1 := index_mut_back i5
    backend.serial.u64.scalar.Scalar52.sub_loop a b difference1 mask borrow1 i6
  else ok (difference, borrow)
partial_fixpoint

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::sub]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 195:4-211:5 -/
def backend.serial.u64.scalar.Scalar52.sub
  (a : backend.serial.u64.scalar.Scalar52)
  (b : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let i ← 1#u64 <<< 52#i32
  let mask ← i - 1#u64
  let (difference, borrow) ←
    backend.serial.u64.scalar.Scalar52.sub_loop a b
      backend.serial.u64.scalar.Scalar52.ZERO mask 0#u64 0#usize
  let i1 ← borrow >>> 63#i32
  let i2 ← (↑(UScalar.cast .U8 i1) : Result Std.U8)
  let c ← subtle.Choice.Insts.CoreConvertFromU8.from i2
  let (_, difference1) ←
    backend.serial.u64.scalar.Scalar52.conditional_add_l difference c
  ok difference1

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::montgomery_reduce]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 274:4-307:5 -/
def backend.serial.u64.scalar.Scalar52.montgomery_reduce
  (limbs : Array Std.U128 9#usize) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let i ← Array.index_usize limbs 0#usize
  let (carry, n0) ←
    backend.serial.u64.scalar.Scalar52.montgomery_reduce.part1 i
  let i1 ← Array.index_usize limbs 1#usize
  let i2 ← carry + i1
  let i3 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
      backend.serial.u64.constants.L 1#usize
  let i4 ← backend.serial.u64.scalar.m n0 i3
  let i5 ← i2 + i4
  let (carry1, n1) ←
    backend.serial.u64.scalar.Scalar52.montgomery_reduce.part1 i5
  let i6 ← Array.index_usize limbs 2#usize
  let i7 ← carry1 + i6
  let i8 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
      backend.serial.u64.constants.L 2#usize
  let i9 ← backend.serial.u64.scalar.m n0 i8
  let i10 ← i7 + i9
  let i11 ← backend.serial.u64.scalar.m n1 i3
  let i12 ← i10 + i11
  let (carry2, n2) ←
    backend.serial.u64.scalar.Scalar52.montgomery_reduce.part1 i12
  let i13 ← Array.index_usize limbs 3#usize
  let i14 ← carry2 + i13
  let i15 ← backend.serial.u64.scalar.m n1 i8
  let i16 ← i14 + i15
  let i17 ← backend.serial.u64.scalar.m n2 i3
  let i18 ← i16 + i17
  let (carry3, n3) ←
    backend.serial.u64.scalar.Scalar52.montgomery_reduce.part1 i18
  let i19 ← Array.index_usize limbs 4#usize
  let i20 ← carry3 + i19
  let i21 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
      backend.serial.u64.constants.L 4#usize
  let i22 ← backend.serial.u64.scalar.m n0 i21
  let i23 ← i20 + i22
  let i24 ← backend.serial.u64.scalar.m n2 i8
  let i25 ← i23 + i24
  let i26 ← backend.serial.u64.scalar.m n3 i3
  let i27 ← i25 + i26
  let (carry4, n4) ←
    backend.serial.u64.scalar.Scalar52.montgomery_reduce.part1 i27
  let i28 ← Array.index_usize limbs 5#usize
  let i29 ← carry4 + i28
  let i30 ← backend.serial.u64.scalar.m n1 i21
  let i31 ← i29 + i30
  let i32 ← backend.serial.u64.scalar.m n3 i8
  let i33 ← i31 + i32
  let i34 ← backend.serial.u64.scalar.m n4 i3
  let i35 ← i33 + i34
  let (carry5, r0) ←
    backend.serial.u64.scalar.Scalar52.montgomery_reduce.part2 i35
  let i36 ← Array.index_usize limbs 6#usize
  let i37 ← carry5 + i36
  let i38 ← backend.serial.u64.scalar.m n2 i21
  let i39 ← i37 + i38
  let i40 ← backend.serial.u64.scalar.m n4 i8
  let i41 ← i39 + i40
  let (carry6, r1) ←
    backend.serial.u64.scalar.Scalar52.montgomery_reduce.part2 i41
  let i42 ← Array.index_usize limbs 7#usize
  let i43 ← carry6 + i42
  let i44 ← backend.serial.u64.scalar.m n3 i21
  let i45 ← i43 + i44
  let (carry7, r2) ←
    backend.serial.u64.scalar.Scalar52.montgomery_reduce.part2 i45
  let i46 ← Array.index_usize limbs 8#usize
  let i47 ← carry7 + i46
  let i48 ← backend.serial.u64.scalar.m n4 i21
  let i49 ← i47 + i48
  let (carry8, r3) ←
    backend.serial.u64.scalar.Scalar52.montgomery_reduce.part2 i49
  let r4 ← (↑(UScalar.cast .U64 carry8) : Result Std.U64)
  backend.serial.u64.scalar.Scalar52.sub
    (Array.make 5#usize [ r0, r1, r2, r3, r4 ]) backend.serial.u64.constants.L

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::mul_internal]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 231:4-245:5 -/
def backend.serial.u64.scalar.Scalar52.mul_internal
  (a : backend.serial.u64.scalar.Scalar52)
  (b : backend.serial.u64.scalar.Scalar52) :
  Result (Array Std.U128 9#usize)
  := do
  let z := Array.repeat 9#usize 0#u128
  let i ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index a
      0#usize
  let i1 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index b
      0#usize
  let i2 ← backend.serial.u64.scalar.m i i1
  let z1 ← Array.update z 0#usize i2
  let i3 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index b
      1#usize
  let i4 ← backend.serial.u64.scalar.m i i3
  let i5 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index a
      1#usize
  let i6 ← backend.serial.u64.scalar.m i5 i1
  let i7 ← i4 + i6
  let z2 ← Array.update z1 1#usize i7
  let i8 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index b
      2#usize
  let i9 ← backend.serial.u64.scalar.m i i8
  let i10 ← backend.serial.u64.scalar.m i5 i3
  let i11 ← i9 + i10
  let i12 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index a
      2#usize
  let i13 ← backend.serial.u64.scalar.m i12 i1
  let i14 ← i11 + i13
  let z3 ← Array.update z2 2#usize i14
  let i15 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index b
      3#usize
  let i16 ← backend.serial.u64.scalar.m i i15
  let i17 ← backend.serial.u64.scalar.m i5 i8
  let i18 ← i16 + i17
  let i19 ← backend.serial.u64.scalar.m i12 i3
  let i20 ← i18 + i19
  let i21 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index a
      3#usize
  let i22 ← backend.serial.u64.scalar.m i21 i1
  let i23 ← i20 + i22
  let z4 ← Array.update z3 3#usize i23
  let i24 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index b
      4#usize
  let i25 ← backend.serial.u64.scalar.m i i24
  let i26 ← backend.serial.u64.scalar.m i5 i15
  let i27 ← i25 + i26
  let i28 ← backend.serial.u64.scalar.m i12 i8
  let i29 ← i27 + i28
  let i30 ← backend.serial.u64.scalar.m i21 i3
  let i31 ← i29 + i30
  let i32 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index a
      4#usize
  let i33 ← backend.serial.u64.scalar.m i32 i1
  let i34 ← i31 + i33
  let z5 ← Array.update z4 4#usize i34
  let i35 ← backend.serial.u64.scalar.m i5 i24
  let i36 ← backend.serial.u64.scalar.m i12 i15
  let i37 ← i35 + i36
  let i38 ← backend.serial.u64.scalar.m i21 i8
  let i39 ← i37 + i38
  let i40 ← backend.serial.u64.scalar.m i32 i3
  let i41 ← i39 + i40
  let z6 ← Array.update z5 5#usize i41
  let i42 ← backend.serial.u64.scalar.m i12 i24
  let i43 ← backend.serial.u64.scalar.m i21 i15
  let i44 ← i42 + i43
  let i45 ← backend.serial.u64.scalar.m i32 i8
  let i46 ← i44 + i45
  let z7 ← Array.update z6 6#usize i46
  let i47 ← backend.serial.u64.scalar.m i21 i24
  let i48 ← backend.serial.u64.scalar.m i32 i15
  let i49 ← i47 + i48
  let z8 ← Array.update z7 7#usize i49
  let i50 ← backend.serial.u64.scalar.m i32 i24
  Array.update z8 8#usize i50

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::montgomery_mul]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 326:4-328:5 -/
def backend.serial.u64.scalar.Scalar52.montgomery_mul
  (a : backend.serial.u64.scalar.Scalar52)
  (b : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let a1 ← backend.serial.u64.scalar.Scalar52.mul_internal a b
  backend.serial.u64.scalar.Scalar52.montgomery_reduce a1

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::add]: loop 0:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 184:8-188:9 -/
def backend.serial.u64.scalar.Scalar52.add_loop
  (a : backend.serial.u64.scalar.Scalar52)
  (b : backend.serial.u64.scalar.Scalar52)
  (sum : backend.serial.u64.scalar.Scalar52) (mask : Std.U64) (carry : Std.U64)
  (i : Std.Usize) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  if i < 5#usize
  then
    let i1 ←
      backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
        a i
    let i2 ←
      backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
        b i
    let i3 ← i1 + i2
    let i4 ← carry >>> 52#i32
    let carry1 ← i3 + i4
    let (_, index_mut_back) ←
      backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
        sum i
    let i5 ← (↑(carry1 &&& mask) : Result Std.U64)
    let i6 ← i + 1#usize
    let sum1 := index_mut_back i5
    backend.serial.u64.scalar.Scalar52.add_loop a b sum1 mask carry1 i6
  else ok sum
partial_fixpoint

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::add]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 177:4-192:5 -/
def backend.serial.u64.scalar.Scalar52.add
  (a : backend.serial.u64.scalar.Scalar52)
  (b : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let i ← 1#u64 <<< 52#i32
  let mask ← i - 1#u64
  let sum ←
    backend.serial.u64.scalar.Scalar52.add_loop a b
      backend.serial.u64.scalar.Scalar52.ZERO mask 0#u64 0#usize
  backend.serial.u64.scalar.Scalar52.sub sum backend.serial.u64.constants.L

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::from_bytes_wide]: loop 0:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 100:8-111:9 -/
def backend.serial.u64.scalar.Scalar52.from_bytes_wide_loop
  (bytes : Array Std.U8 64#usize) (words : Array Std.U64 8#usize)
  (i : Std.Usize) :
  Result (Array Std.U64 8#usize)
  := do
  if i < 8#usize
  then
    let i1 ← i * 8#usize
    let i2 ← Array.index_usize bytes i1
    let i3 ← (↑(UScalar.cast .U64 i2) : Result Std.U64)
    let i4 ← i3 <<< 0#i32
    let i5 ← Array.index_usize words i
    let i6 ← (↑(i5 ||| i4) : Result Std.U64)
    let words1 ← Array.update words i i6
    let i7 ← i1 + 1#usize
    let i8 ← Array.index_usize bytes i7
    let i9 ← (↑(UScalar.cast .U64 i8) : Result Std.U64)
    let i10 ← i9 <<< 8#i32
    let i11 ← Array.index_usize words1 i
    let i12 ← (↑(i11 ||| i10) : Result Std.U64)
    let words2 ← Array.update words1 i i12
    let i13 ← i1 + 2#usize
    let i14 ← Array.index_usize bytes i13
    let i15 ← (↑(UScalar.cast .U64 i14) : Result Std.U64)
    let i16 ← 2#i32 * 8#i32
    let i17 ← i15 <<< i16
    let i18 ← Array.index_usize words2 i
    let i19 ← (↑(i18 ||| i17) : Result Std.U64)
    let words3 ← Array.update words2 i i19
    let i20 ← i1 + 3#usize
    let i21 ← Array.index_usize bytes i20
    let i22 ← (↑(UScalar.cast .U64 i21) : Result Std.U64)
    let i23 ← 3#i32 * 8#i32
    let i24 ← i22 <<< i23
    let i25 ← Array.index_usize words3 i
    let i26 ← (↑(i25 ||| i24) : Result Std.U64)
    let words4 ← Array.update words3 i i26
    let i27 ← i1 + 4#usize
    let i28 ← Array.index_usize bytes i27
    let i29 ← (↑(UScalar.cast .U64 i28) : Result Std.U64)
    let i30 ← 4#i32 * 8#i32
    let i31 ← i29 <<< i30
    let i32 ← Array.index_usize words4 i
    let i33 ← (↑(i32 ||| i31) : Result Std.U64)
    let words5 ← Array.update words4 i i33
    let i34 ← i1 + 5#usize
    let i35 ← Array.index_usize bytes i34
    let i36 ← (↑(UScalar.cast .U64 i35) : Result Std.U64)
    let i37 ← 5#i32 * 8#i32
    let i38 ← i36 <<< i37
    let i39 ← Array.index_usize words5 i
    let i40 ← (↑(i39 ||| i38) : Result Std.U64)
    let words6 ← Array.update words5 i i40
    let i41 ← i1 + 6#usize
    let i42 ← Array.index_usize bytes i41
    let i43 ← (↑(UScalar.cast .U64 i42) : Result Std.U64)
    let i44 ← 6#i32 * 8#i32
    let i45 ← i43 <<< i44
    let i46 ← Array.index_usize words6 i
    let i47 ← (↑(i46 ||| i45) : Result Std.U64)
    let words7 ← Array.update words6 i i47
    let i48 ← i1 + 7#usize
    let i49 ← Array.index_usize bytes i48
    let i50 ← (↑(UScalar.cast .U64 i49) : Result Std.U64)
    let i51 ← 7#i32 * 8#i32
    let i52 ← i50 <<< i51
    let i53 ← Array.index_usize words7 i
    let i54 ← (↑(i53 ||| i52) : Result Std.U64)
    let a ← Array.update words7 i i54
    let i55 ← i + 1#usize
    backend.serial.u64.scalar.Scalar52.from_bytes_wide_loop bytes a i55
  else ok words
partial_fixpoint

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::from_bytes_wide]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 97:4-132:5 -/
def backend.serial.u64.scalar.Scalar52.from_bytes_wide
  (bytes : Array Std.U8 64#usize) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let words := Array.repeat 8#usize 0#u64
  let words1 ←
    backend.serial.u64.scalar.Scalar52.from_bytes_wide_loop bytes words 0#usize
  let i ← 1#u64 <<< 52#i32
  let mask ← i - 1#u64
  let i1 ← Array.index_usize words1 0#usize
  let (_, index_mut_back) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      backend.serial.u64.scalar.Scalar52.ZERO 0#usize
  let i2 ← (↑(i1 &&& mask) : Result Std.U64)
  let i3 ← i1 >>> 52#i32
  let i4 ← Array.index_usize words1 1#usize
  let i5 ← i4 <<< 12#i32
  let i6 ← (↑(i3 ||| i5) : Result Std.U64)
  let lo := index_mut_back i2
  let (_, index_mut_back1) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      lo 1#usize
  let i7 ← (↑(i6 &&& mask) : Result Std.U64)
  let i8 ← i4 >>> 40#i32
  let i9 ← Array.index_usize words1 2#usize
  let i10 ← i9 <<< 24#i32
  let i11 ← (↑(i8 ||| i10) : Result Std.U64)
  let lo1 := index_mut_back1 i7
  let (_, index_mut_back2) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      lo1 2#usize
  let i12 ← (↑(i11 &&& mask) : Result Std.U64)
  let i13 ← i9 >>> 28#i32
  let i14 ← Array.index_usize words1 3#usize
  let i15 ← i14 <<< 36#i32
  let i16 ← (↑(i13 ||| i15) : Result Std.U64)
  let lo2 := index_mut_back2 i12
  let (_, index_mut_back3) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      lo2 3#usize
  let i17 ← (↑(i16 &&& mask) : Result Std.U64)
  let i18 ← i14 >>> 16#i32
  let i19 ← Array.index_usize words1 4#usize
  let i20 ← i19 <<< 48#i32
  let i21 ← (↑(i18 ||| i20) : Result Std.U64)
  let lo3 := index_mut_back3 i17
  let (_, index_mut_back4) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      lo3 4#usize
  let i22 ← (↑(i21 &&& mask) : Result Std.U64)
  let i23 ← i19 >>> 4#i32
  let i24 ← (↑(i23 &&& mask) : Result Std.U64)
  let i25 ← i19 >>> 56#i32
  let i26 ← Array.index_usize words1 5#usize
  let i27 ← i26 <<< 8#i32
  let i28 ← (↑(i25 ||| i27) : Result Std.U64)
  let hi := index_mut_back i24
  let (_, index_mut_back5) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      hi 1#usize
  let i29 ← (↑(i28 &&& mask) : Result Std.U64)
  let i30 ← i26 >>> 44#i32
  let i31 ← Array.index_usize words1 6#usize
  let i32 ← i31 <<< 20#i32
  let i33 ← (↑(i30 ||| i32) : Result Std.U64)
  let hi1 := index_mut_back5 i29
  let (_, index_mut_back6) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      hi1 2#usize
  let i34 ← (↑(i33 &&& mask) : Result Std.U64)
  let i35 ← i31 >>> 32#i32
  let i36 ← Array.index_usize words1 7#usize
  let i37 ← i36 <<< 32#i32
  let i38 ← (↑(i35 ||| i37) : Result Std.U64)
  let hi2 := index_mut_back6 i34
  let (_, index_mut_back7) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      hi2 3#usize
  let i39 ← (↑(i38 &&& mask) : Result Std.U64)
  let i40 ← (↑(IScalar.hcast .U32 20#i32) : Result Std.U32)
  massert (i40 < 64#u32)
  let hi3 := index_mut_back7 i39
  let (_, index_mut_back8) ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexMutUsizeU64.index_mut
      hi3 4#usize
  let i41 ← i36 >>> 20#i32
  let lo4 := index_mut_back4 i22
  let lo5 ←
    backend.serial.u64.scalar.Scalar52.montgomery_mul lo4
      backend.serial.u64.constants.R
  let hi4 := index_mut_back8 i41
  let hi5 ←
    backend.serial.u64.scalar.Scalar52.montgomery_mul hi4
      backend.serial.u64.constants.RR
  backend.serial.u64.scalar.Scalar52.add hi5 lo5

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::to_bytes]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 137:4-174:5 -/
def backend.serial.u64.scalar.Scalar52.to_bytes
  (self : backend.serial.u64.scalar.Scalar52) :
  Result (Array Std.U8 32#usize)
  := do
  let s := Array.repeat 32#usize 0#u8
  let i ← Array.index_usize self 0#usize
  let i1 ← i >>> 0#i32
  let i2 ← (↑(UScalar.cast .U8 i1) : Result Std.U8)
  let s1 ← Array.update s 0#usize i2
  let i3 ← i >>> 8#i32
  let i4 ← (↑(UScalar.cast .U8 i3) : Result Std.U8)
  let s2 ← Array.update s1 1#usize i4
  let i5 ← i >>> 16#i32
  let i6 ← (↑(UScalar.cast .U8 i5) : Result Std.U8)
  let s3 ← Array.update s2 2#usize i6
  let i7 ← i >>> 24#i32
  let i8 ← (↑(UScalar.cast .U8 i7) : Result Std.U8)
  let s4 ← Array.update s3 3#usize i8
  let i9 ← i >>> 32#i32
  let i10 ← (↑(UScalar.cast .U8 i9) : Result Std.U8)
  let s5 ← Array.update s4 4#usize i10
  let i11 ← i >>> 40#i32
  let i12 ← (↑(UScalar.cast .U8 i11) : Result Std.U8)
  let s6 ← Array.update s5 5#usize i12
  let i13 ← i >>> 48#i32
  let i14 ← Array.index_usize self 1#usize
  let i15 ← i14 <<< 4#i32
  let i16 ← (↑(i13 ||| i15) : Result Std.U64)
  let i17 ← (↑(UScalar.cast .U8 i16) : Result Std.U8)
  let s7 ← Array.update s6 6#usize i17
  let i18 ← i14 >>> 4#i32
  let i19 ← (↑(UScalar.cast .U8 i18) : Result Std.U8)
  let s8 ← Array.update s7 7#usize i19
  let i20 ← i14 >>> 12#i32
  let i21 ← (↑(UScalar.cast .U8 i20) : Result Std.U8)
  let s9 ← Array.update s8 8#usize i21
  let i22 ← i14 >>> 20#i32
  let i23 ← (↑(UScalar.cast .U8 i22) : Result Std.U8)
  let s10 ← Array.update s9 9#usize i23
  let i24 ← i14 >>> 28#i32
  let i25 ← (↑(UScalar.cast .U8 i24) : Result Std.U8)
  let s11 ← Array.update s10 10#usize i25
  let i26 ← i14 >>> 36#i32
  let i27 ← (↑(UScalar.cast .U8 i26) : Result Std.U8)
  let s12 ← Array.update s11 11#usize i27
  let i28 ← i14 >>> 44#i32
  let i29 ← (↑(UScalar.cast .U8 i28) : Result Std.U8)
  let s13 ← Array.update s12 12#usize i29
  let i30 ← Array.index_usize self 2#usize
  let i31 ← i30 >>> 0#i32
  let i32 ← (↑(UScalar.cast .U8 i31) : Result Std.U8)
  let s14 ← Array.update s13 13#usize i32
  let i33 ← i30 >>> 8#i32
  let i34 ← (↑(UScalar.cast .U8 i33) : Result Std.U8)
  let s15 ← Array.update s14 14#usize i34
  let i35 ← i30 >>> 16#i32
  let i36 ← (↑(UScalar.cast .U8 i35) : Result Std.U8)
  let s16 ← Array.update s15 15#usize i36
  let i37 ← i30 >>> 24#i32
  let i38 ← (↑(UScalar.cast .U8 i37) : Result Std.U8)
  let s17 ← Array.update s16 16#usize i38
  let i39 ← i30 >>> 32#i32
  let i40 ← (↑(UScalar.cast .U8 i39) : Result Std.U8)
  let s18 ← Array.update s17 17#usize i40
  let i41 ← i30 >>> 40#i32
  let i42 ← (↑(UScalar.cast .U8 i41) : Result Std.U8)
  let s19 ← Array.update s18 18#usize i42
  let i43 ← i30 >>> 48#i32
  let i44 ← Array.index_usize self 3#usize
  let i45 ← i44 <<< 4#i32
  let i46 ← (↑(i43 ||| i45) : Result Std.U64)
  let i47 ← (↑(UScalar.cast .U8 i46) : Result Std.U8)
  let s20 ← Array.update s19 19#usize i47
  let i48 ← i44 >>> 4#i32
  let i49 ← (↑(UScalar.cast .U8 i48) : Result Std.U8)
  let s21 ← Array.update s20 20#usize i49
  let i50 ← i44 >>> 12#i32
  let i51 ← (↑(UScalar.cast .U8 i50) : Result Std.U8)
  let s22 ← Array.update s21 21#usize i51
  let i52 ← i44 >>> 20#i32
  let i53 ← (↑(UScalar.cast .U8 i52) : Result Std.U8)
  let s23 ← Array.update s22 22#usize i53
  let i54 ← i44 >>> 28#i32
  let i55 ← (↑(UScalar.cast .U8 i54) : Result Std.U8)
  let s24 ← Array.update s23 23#usize i55
  let i56 ← i44 >>> 36#i32
  let i57 ← (↑(UScalar.cast .U8 i56) : Result Std.U8)
  let s25 ← Array.update s24 24#usize i57
  let i58 ← i44 >>> 44#i32
  let i59 ← (↑(UScalar.cast .U8 i58) : Result Std.U8)
  let s26 ← Array.update s25 25#usize i59
  let i60 ← Array.index_usize self 4#usize
  let i61 ← i60 >>> 0#i32
  let i62 ← (↑(UScalar.cast .U8 i61) : Result Std.U8)
  let s27 ← Array.update s26 26#usize i62
  let i63 ← i60 >>> 8#i32
  let i64 ← (↑(UScalar.cast .U8 i63) : Result Std.U8)
  let s28 ← Array.update s27 27#usize i64
  let i65 ← i60 >>> 16#i32
  let i66 ← (↑(UScalar.cast .U8 i65) : Result Std.U8)
  let s29 ← Array.update s28 28#usize i66
  let i67 ← i60 >>> 24#i32
  let i68 ← (↑(UScalar.cast .U8 i67) : Result Std.U8)
  let s30 ← Array.update s29 29#usize i68
  let i69 ← i60 >>> 32#i32
  let i70 ← (↑(UScalar.cast .U8 i69) : Result Std.U8)
  let s31 ← Array.update s30 30#usize i70
  let i71 ← i60 >>> 40#i32
  let i72 ← (↑(UScalar.cast .U8 i71) : Result Std.U8)
  Array.update s31 31#usize i72

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::square_internal]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 250:4-269:5 -/
def backend.serial.u64.scalar.Scalar52.square_internal
  (a : backend.serial.u64.scalar.Scalar52) :
  Result (Array Std.U128 9#usize)
  := do
  let i ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index a
      0#usize
  let i1 ← i * 2#u64
  let i2 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index a
      1#usize
  let i3 ← i2 * 2#u64
  let i4 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index a
      2#usize
  let i5 ← i4 * 2#u64
  let i6 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index a
      3#usize
  let i7 ← i6 * 2#u64
  let i8 ← backend.serial.u64.scalar.m i i
  let i9 ← Array.index_usize (Array.make 4#usize [ i1, i3, i5, i7 ]) 0#usize
  let i10 ← backend.serial.u64.scalar.m i9 i2
  let i11 ← backend.serial.u64.scalar.m i9 i4
  let i12 ← backend.serial.u64.scalar.m i2 i2
  let i13 ← i11 + i12
  let i14 ← backend.serial.u64.scalar.m i9 i6
  let i15 ← Array.index_usize (Array.make 4#usize [ i1, i3, i5, i7 ]) 1#usize
  let i16 ← backend.serial.u64.scalar.m i15 i4
  let i17 ← i14 + i16
  let i18 ←
    backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index a
      4#usize
  let i19 ← backend.serial.u64.scalar.m i9 i18
  let i20 ← backend.serial.u64.scalar.m i15 i6
  let i21 ← i19 + i20
  let i22 ← backend.serial.u64.scalar.m i4 i4
  let i23 ← i21 + i22
  let i24 ← backend.serial.u64.scalar.m i15 i18
  let i25 ← Array.index_usize (Array.make 4#usize [ i1, i3, i5, i7 ]) 2#usize
  let i26 ← backend.serial.u64.scalar.m i25 i6
  let i27 ← i24 + i26
  let i28 ← backend.serial.u64.scalar.m i25 i18
  let i29 ← backend.serial.u64.scalar.m i6 i6
  let i30 ← i28 + i29
  let i31 ← Array.index_usize (Array.make 4#usize [ i1, i3, i5, i7 ]) 3#usize
  let i32 ← backend.serial.u64.scalar.m i31 i18
  let i33 ← backend.serial.u64.scalar.m i18 i18
  ok (Array.make 9#usize [ i8, i10, i13, i17, i23, i27, i30, i32, i33 ])

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::mul]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 311:4-314:5 -/
def backend.serial.u64.scalar.Scalar52.mul
  (a : backend.serial.u64.scalar.Scalar52)
  (b : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let a1 ← backend.serial.u64.scalar.Scalar52.mul_internal a b
  let ab ← backend.serial.u64.scalar.Scalar52.montgomery_reduce a1
  let a2 ←
    backend.serial.u64.scalar.Scalar52.mul_internal ab
      backend.serial.u64.constants.RR
  backend.serial.u64.scalar.Scalar52.montgomery_reduce a2

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::square]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 319:4-322:5 -/
def backend.serial.u64.scalar.Scalar52.square
  (self : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let a ← backend.serial.u64.scalar.Scalar52.square_internal self
  let aa ← backend.serial.u64.scalar.Scalar52.montgomery_reduce a
  let a1 ←
    backend.serial.u64.scalar.Scalar52.mul_internal aa
      backend.serial.u64.constants.RR
  backend.serial.u64.scalar.Scalar52.montgomery_reduce a1

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::montgomery_square]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 332:4-334:5 -/
def backend.serial.u64.scalar.Scalar52.montgomery_square
  (self : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let a ← backend.serial.u64.scalar.Scalar52.square_internal self
  backend.serial.u64.scalar.Scalar52.montgomery_reduce a

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::as_montgomery]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 338:4-340:5 -/
def backend.serial.u64.scalar.Scalar52.as_montgomery
  (self : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  backend.serial.u64.scalar.Scalar52.montgomery_mul self
    backend.serial.u64.constants.RR

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::from_montgomery]: loop 0:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 348:8-351:9 -/
def backend.serial.u64.scalar.Scalar52.from_montgomery_loop
  (self : backend.serial.u64.scalar.Scalar52) (limbs : Array Std.U128 9#usize)
  (i : Std.Usize) :
  Result (Array Std.U128 9#usize)
  := do
  if i < 5#usize
  then
    let i1 ←
      backend.serial.u64.scalar.Scalar52.Insts.CoreOpsIndexIndexUsizeU64.index
        self i
    let i2 ← (↑(UScalar.cast .U128 i1) : Result Std.U128)
    let a ← Array.update limbs i i2
    let i3 ← i + 1#usize
    backend.serial.u64.scalar.Scalar52.from_montgomery_loop self a i3
  else ok limbs
partial_fixpoint

/-- [curve25519_dalek::backend::serial::u64::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::from_montgomery]:
   Source: 'curve25519-dalek/src/backend/serial/u64/scalar.rs', lines 345:4-353:5 -/
def backend.serial.u64.scalar.Scalar52.from_montgomery
  (self : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let limbs := Array.repeat 9#usize 0#u128
  let limbs1 ←
    backend.serial.u64.scalar.Scalar52.from_montgomery_loop self limbs 0#usize
  backend.serial.u64.scalar.Scalar52.montgomery_reduce limbs1

/-- [curve25519_dalek::constants::RISTRETTO_BASEPOINT_POINT]
   Source: 'curve25519-dalek/src/constants.rs', lines 66:0-66:94 -/
@[global_simps, irreducible]
def constants.RISTRETTO_BASEPOINT_POINT : ristretto.RistrettoPoint :=
  backend.serial.u64.constants.ED25519_BASEPOINT_POINT

/-- [curve25519_dalek::constants::BASEPOINT_ORDER_PRIVATE]
   Source: 'curve25519-dalek/src/constants.rs', lines 75:0-81:2 -/
@[global_simps, irreducible]
def constants.BASEPOINT_ORDER_PRIVATE : scalar.Scalar :=
  {
    bytes :=
      (Array.make 32#usize [
        237#u8, 211#u8, 245#u8, 92#u8, 26#u8, 99#u8, 18#u8, 88#u8, 214#u8,
        156#u8, 247#u8, 162#u8, 222#u8, 249#u8, 222#u8, 20#u8, 0#u8, 0#u8,
        0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8,
        0#u8, 16#u8
        ])
  }

/-- [curve25519_dalek::edwards::affine::{core::clone::Clone for curve25519_dalek::edwards::affine::AffinePoint}::clone]:
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 11:15-11:20 -/
def edwards.affine.AffinePoint.Insts.CoreCloneClone.clone
  (self : edwards.affine.AffinePoint) : Result edwards.affine.AffinePoint := do
  ok self

/-- Trait implementation: [curve25519_dalek::edwards::affine::{core::clone::Clone for curve25519_dalek::edwards::affine::AffinePoint}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 11:15-11:20 -/
@[reducible]
def edwards.affine.AffinePoint.Insts.CoreCloneClone : core.clone.Clone
  edwards.affine.AffinePoint := {
  clone := edwards.affine.AffinePoint.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::edwards::affine::{core::marker::Copy for curve25519_dalek::edwards::affine::AffinePoint}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 11:9-11:13 -/
@[reducible]
def edwards.affine.AffinePoint.Insts.CoreMarkerCopy : core.marker.Copy
  edwards.affine.AffinePoint := {
  cloneInst := edwards.affine.AffinePoint.Insts.CoreCloneClone
}

/-- [curve25519_dalek::edwards::affine::{subtle::ConstantTimeEq for curve25519_dalek::edwards::affine::AffinePoint}::ct_eq]:
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 18:4-20:5 -/
def edwards.affine.AffinePoint.Insts.SubtleConstantTimeEq.ct_eq
  (self : edwards.affine.AffinePoint) (other : edwards.affine.AffinePoint) :
  Result subtle.Choice
  := do
  let c ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
      self.x other.x
  let c1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
      self.y other.y
  subtle.Choice.Insts.CoreOpsBitBitAndChoiceChoice.bitand c c1

/-- Trait implementation: [curve25519_dalek::edwards::affine::{subtle::ConstantTimeEq for curve25519_dalek::edwards::affine::AffinePoint}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 17:0-21:1 -/
@[reducible]
def edwards.affine.AffinePoint.Insts.SubtleConstantTimeEq :
  subtle.ConstantTimeEq edwards.affine.AffinePoint := {
  ct_eq := edwards.affine.AffinePoint.Insts.SubtleConstantTimeEq.ct_eq
}

/-- [curve25519_dalek::edwards::affine::{subtle::ConditionallySelectable for curve25519_dalek::edwards::affine::AffinePoint}::conditional_select]:
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 24:4-29:5 -/
def
  edwards.affine.AffinePoint.Insts.SubtleConditionallySelectable.conditional_select
  (a : edwards.affine.AffinePoint) (b : edwards.affine.AffinePoint)
  (choice : subtle.Choice) :
  Result edwards.affine.AffinePoint
  := do
  let fe ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.x b.x choice
  let fe1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.y b.y choice
  ok { x := fe, y := fe1 }

/-- Trait implementation: [curve25519_dalek::edwards::affine::{subtle::ConditionallySelectable for curve25519_dalek::edwards::affine::AffinePoint}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 23:0-30:1 -/
@[reducible]
def edwards.affine.AffinePoint.Insts.SubtleConditionallySelectable :
  subtle.ConditionallySelectable edwards.affine.AffinePoint := {
  coremarkerCopyInst := edwards.affine.AffinePoint.Insts.CoreMarkerCopy
  conditional_select :=
    edwards.affine.AffinePoint.Insts.SubtleConditionallySelectable.conditional_select
  conditional_assign :=
    edwards.affine.AffinePoint.Insts.SubtleConditionallySelectable.conditional_assign
  conditional_swap :=
    edwards.affine.AffinePoint.Insts.SubtleConditionallySelectable.conditional_swap
}

/-- [curve25519_dalek::edwards::affine::{curve25519_dalek::traits::Identity for curve25519_dalek::edwards::affine::AffinePoint}::identity]:
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 39:4-44:5 -/
def edwards.affine.AffinePoint.Insts.Curve25519_dalekTraitsIdentity.identity
  : Result edwards.affine.AffinePoint := do
  ok
    {
      x := backend.serial.u64.field.FieldElement51.ZERO,
      y := backend.serial.u64.field.FieldElement51.ONE
    }

/-- [curve25519_dalek::edwards::affine::{core::default::Default for curve25519_dalek::edwards::affine::AffinePoint}::default]:
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 33:4-35:5 -/
def edwards.affine.AffinePoint.Insts.CoreDefaultDefault.default
  : Result edwards.affine.AffinePoint := do
  edwards.affine.AffinePoint.Insts.Curve25519_dalekTraitsIdentity.identity

/-- Trait implementation: [curve25519_dalek::edwards::affine::{core::default::Default for curve25519_dalek::edwards::affine::AffinePoint}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 32:0-36:1 -/
@[reducible]
def edwards.affine.AffinePoint.Insts.CoreDefaultDefault : core.default.Default
  edwards.affine.AffinePoint := {
  default := edwards.affine.AffinePoint.Insts.CoreDefaultDefault.default
}

/-- Trait implementation: [curve25519_dalek::edwards::affine::{curve25519_dalek::traits::Identity for curve25519_dalek::edwards::affine::AffinePoint}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 38:0-45:1 -/
@[reducible]
def edwards.affine.AffinePoint.Insts.Curve25519_dalekTraitsIdentity :
  traits.Identity edwards.affine.AffinePoint := {
  identity :=
    edwards.affine.AffinePoint.Insts.Curve25519_dalekTraitsIdentity.identity
}

/-- [curve25519_dalek::edwards::affine::{core::cmp::PartialEq<curve25519_dalek::edwards::affine::AffinePoint> for curve25519_dalek::edwards::affine::AffinePoint}::eq]:
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 48:4-50:5 -/
def edwards.affine.AffinePoint.Insts.CoreCmpPartialEqAffinePoint.eq
  (self : edwards.affine.AffinePoint) (other : edwards.affine.AffinePoint) :
  Result Bool
  := do
  let c ←
    edwards.affine.AffinePoint.Insts.SubtleConstantTimeEq.ct_eq self other
  core.convert.IntoFrom.into Bool.Insts.CoreConvertFromChoice c

/-- Trait implementation: [curve25519_dalek::edwards::affine::{core::cmp::PartialEq<curve25519_dalek::edwards::affine::AffinePoint> for curve25519_dalek::edwards::affine::AffinePoint}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 47:0-51:1 -/
@[reducible]
def edwards.affine.AffinePoint.Insts.CoreCmpPartialEqAffinePoint :
  core.cmp.PartialEq edwards.affine.AffinePoint edwards.affine.AffinePoint := {
  eq := edwards.affine.AffinePoint.Insts.CoreCmpPartialEqAffinePoint.eq
  ne := edwards.affine.AffinePoint.Insts.CoreCmpPartialEqAffinePoint.ne
}

/-- Trait implementation: [curve25519_dalek::edwards::affine::{core::cmp::Eq for curve25519_dalek::edwards::affine::AffinePoint}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 53:0-53:26 -/
@[reducible]
def edwards.affine.AffinePoint.Insts.CoreCmpEq : core.cmp.Eq
  edwards.affine.AffinePoint := {
  partialEqInst := edwards.affine.AffinePoint.Insts.CoreCmpPartialEqAffinePoint
  assert_receiver_is_total_eq :=
    edwards.affine.AffinePoint.Insts.CoreCmpEq.assert_receiver_is_total_eq
}

/-- Trait implementation: [curve25519_dalek::edwards::affine::{zeroize::DefaultIsZeroes for curve25519_dalek::edwards::affine::AffinePoint}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 56:0-56:39 -/
@[reducible]
def edwards.affine.AffinePoint.Insts.ZeroizeDefaultIsZeroes :
  zeroize.DefaultIsZeroes edwards.affine.AffinePoint := {
  coremarkerCopyInst := edwards.affine.AffinePoint.Insts.CoreMarkerCopy
  coredefaultDefaultInst := edwards.affine.AffinePoint.Insts.CoreDefaultDefault
}

/-- [curve25519_dalek::edwards::affine::{curve25519_dalek::edwards::affine::AffinePoint}::to_edwards]:
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 60:4-67:5 -/
def edwards.affine.AffinePoint.to_edwards
  (self : edwards.affine.AffinePoint) : Result edwards.EdwardsPoint := do
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.x self.y
  ok
    {
      X := self.x,
      Y := self.y,
      Z := backend.serial.u64.field.FieldElement51.ONE,
      T := fe
    }

/-- [curve25519_dalek::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::is_negative]:
   Source: 'curve25519-dalek/src/field.rs', lines 149:4-152:5 -/
def field.FieldElement51.is_negative
  (self : backend.serial.u64.field.FieldElement51) : Result subtle.Choice := do
  let bytes ← backend.serial.u64.field.FieldElement51.to_bytes self
  let i ← Array.index_usize bytes 0#usize
  let i1 ← (↑(i &&& 1#u8) : Result Std.U8)
  core.convert.IntoFrom.into subtle.Choice.Insts.CoreConvertFromU8 i1

/-- [curve25519_dalek::edwards::affine::{curve25519_dalek::edwards::affine::AffinePoint}::compress]:
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 71:4-75:5 -/
def edwards.affine.AffinePoint.compress
  (self : edwards.affine.AffinePoint) : Result edwards.CompressedEdwardsY := do
  let s ← backend.serial.u64.field.FieldElement51.to_bytes self.y
  let c ← field.FieldElement51.is_negative self.x
  let i ← subtle.Choice.unwrap_u8 c
  let i1 ← i <<< 7#i32
  let i2 ← Array.index_usize s 31#usize
  let i3 ← (↑(i2 ^^^ i1) : Result Std.U8)
  let s1 ← Array.update s 31#usize i3
  ok s1

/-- [curve25519_dalek::edwards::{core::ops::arith::Mul<&'a (curve25519_dalek::scalar::Scalar), curve25519_dalek::edwards::EdwardsPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}::mul]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 855:4-857:5 -/
def Shared0EdwardsPoint.Insts.CoreOpsArithMulSharedAScalarEdwardsPoint.mul
  (self : edwards.EdwardsPoint) (scalar : scalar.Scalar) :
  Result edwards.EdwardsPoint
  := do
  backend.variable_base_mul self scalar

/-- [curve25519_dalek::edwards::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 107:12-109:13 -/
def edwards.EdwardsPoint.Insts.CoreOpsArithMulScalarEdwardsPoint.mul
  (self : edwards.EdwardsPoint) (rhs : scalar.Scalar) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithMulSharedAScalarEdwardsPoint.mul self
    rhs

/-- [curve25519_dalek::edwards::affine::{core::ops::arith::Mul<&0 (curve25519_dalek::edwards::affine::AffinePoint), curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::scalar::Scalar}::mul]:
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 91:4-93:5 -/
def scalar.Scalar.Insts.CoreOpsArithMulShared0AffinePointEdwardsPoint.mul
  (self : scalar.Scalar) (rhs : edwards.affine.AffinePoint) :
  Result edwards.EdwardsPoint
  := do
  let ep ← edwards.affine.AffinePoint.to_edwards rhs
  edwards.EdwardsPoint.Insts.CoreOpsArithMulScalarEdwardsPoint.mul ep self

/-- [curve25519_dalek::edwards::affine::{core::ops::arith::Mul<curve25519_dalek::edwards::affine::AffinePoint, curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::scalar::Scalar}::mul]:
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 82:4-84:5 -/
def scalar.Scalar.Insts.CoreOpsArithMulAffinePointEdwardsPoint.mul
  (self : scalar.Scalar) (rhs : edwards.affine.AffinePoint) :
  Result edwards.EdwardsPoint
  := do
  scalar.Scalar.Insts.CoreOpsArithMulShared0AffinePointEdwardsPoint.mul self
    rhs

/-- Trait implementation: [curve25519_dalek::edwards::affine::{core::ops::arith::Mul<curve25519_dalek::edwards::affine::AffinePoint, curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 78:0-85:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulAffinePointEdwardsPoint :
  core.ops.arith.Mul scalar.Scalar edwards.affine.AffinePoint
  edwards.EdwardsPoint := {
  mul := scalar.Scalar.Insts.CoreOpsArithMulAffinePointEdwardsPoint.mul
}

/-- Trait implementation: [curve25519_dalek::edwards::affine::{core::ops::arith::Mul<&0 (curve25519_dalek::edwards::affine::AffinePoint), curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/edwards/affine.rs', lines 87:0-94:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulShared0AffinePointEdwardsPoint :
  core.ops.arith.Mul scalar.Scalar edwards.affine.AffinePoint
  edwards.EdwardsPoint := {
  mul := scalar.Scalar.Insts.CoreOpsArithMulShared0AffinePointEdwardsPoint.mul
}

/-- [curve25519_dalek::edwards::{core::clone::Clone for curve25519_dalek::edwards::CompressedEdwardsY}::clone]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 171:15-171:20 -/
def edwards.CompressedEdwardsY.Insts.CoreCloneClone.clone
  (self : edwards.CompressedEdwardsY) : Result edwards.CompressedEdwardsY := do
  ok self

/-- Trait implementation: [curve25519_dalek::edwards::{core::clone::Clone for curve25519_dalek::edwards::CompressedEdwardsY}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 171:15-171:20 -/
@[reducible]
def edwards.CompressedEdwardsY.Insts.CoreCloneClone : core.clone.Clone
  edwards.CompressedEdwardsY := {
  clone := edwards.CompressedEdwardsY.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::marker::Copy for curve25519_dalek::edwards::CompressedEdwardsY}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 171:9-171:13 -/
@[reducible]
def edwards.CompressedEdwardsY.Insts.CoreMarkerCopy : core.marker.Copy
  edwards.CompressedEdwardsY := {
  cloneInst := edwards.CompressedEdwardsY.Insts.CoreCloneClone
}

/-- [curve25519_dalek::edwards::{core::cmp::PartialEq<curve25519_dalek::edwards::CompressedEdwardsY> for curve25519_dalek::edwards::CompressedEdwardsY}::eq]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 171:26-171:35 -/
def edwards.CompressedEdwardsY.Insts.CoreCmpPartialEqCompressedEdwardsY.eq
  (self : edwards.CompressedEdwardsY) (other : edwards.CompressedEdwardsY) :
  Result Bool
  := do
  core.array.equality.PartialEqArray.eq core.cmp.PartialEqU8 self other

/-- Trait implementation: [curve25519_dalek::edwards::{core::cmp::PartialEq<curve25519_dalek::edwards::CompressedEdwardsY> for curve25519_dalek::edwards::CompressedEdwardsY}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 171:26-171:35 -/
@[reducible]
def edwards.CompressedEdwardsY.Insts.CoreCmpPartialEqCompressedEdwardsY :
  core.cmp.PartialEq edwards.CompressedEdwardsY edwards.CompressedEdwardsY := {
  eq := edwards.CompressedEdwardsY.Insts.CoreCmpPartialEqCompressedEdwardsY.eq
  ne := edwards.CompressedEdwardsY.Insts.CoreCmpPartialEqCompressedEdwardsY.ne
}

/-- [curve25519_dalek::edwards::{core::cmp::Eq for curve25519_dalek::edwards::CompressedEdwardsY}::assert_receiver_is_total_eq]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 171:22-171:24 -/
def edwards.CompressedEdwardsY.Insts.CoreCmpEq.assert_receiver_is_total_eq
  (self : edwards.CompressedEdwardsY) : Result Unit := do
  ok ()

/-- Trait implementation: [curve25519_dalek::edwards::{core::cmp::Eq for curve25519_dalek::edwards::CompressedEdwardsY}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 171:22-171:24 -/
@[reducible]
def edwards.CompressedEdwardsY.Insts.CoreCmpEq : core.cmp.Eq
  edwards.CompressedEdwardsY := {
  partialEqInst :=
    edwards.CompressedEdwardsY.Insts.CoreCmpPartialEqCompressedEdwardsY
  assert_receiver_is_total_eq :=
    edwards.CompressedEdwardsY.Insts.CoreCmpEq.assert_receiver_is_total_eq
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::marker::StructuralPartialEq for curve25519_dalek::edwards::CompressedEdwardsY}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 171:26-171:35 -/
@[reducible]
def edwards.CompressedEdwardsY.Insts.CoreMarkerStructuralPartialEq :
  core.marker.StructuralPartialEq edwards.CompressedEdwardsY := {
}

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::CompressedEdwardsY}::as_bytes]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 188:4-190:5 -/
def edwards.CompressedEdwardsY.as_bytes
  (self : edwards.CompressedEdwardsY) : Result (Array Std.U8 32#usize) := do
  ok self

/-- [curve25519_dalek::edwards::{subtle::ConstantTimeEq for curve25519_dalek::edwards::CompressedEdwardsY}::ct_eq]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 175:4-177:5 -/
def edwards.CompressedEdwardsY.Insts.SubtleConstantTimeEq.ct_eq
  (self : edwards.CompressedEdwardsY) (other : edwards.CompressedEdwardsY) :
  Result subtle.Choice
  := do
  let a ← edwards.CompressedEdwardsY.as_bytes self
  let s ← (↑(Array.to_slice a) : Result (Slice Std.U8))
  let a1 ← edwards.CompressedEdwardsY.as_bytes other
  let s1 ← (↑(Array.to_slice a1) : Result (Slice Std.U8))
  Slice.Insts.SubtleConstantTimeEq.ct_eq U8.Insts.SubtleConstantTimeEq s s1

/-- Trait implementation: [curve25519_dalek::edwards::{subtle::ConstantTimeEq for curve25519_dalek::edwards::CompressedEdwardsY}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 174:0-178:1 -/
@[reducible]
def edwards.CompressedEdwardsY.Insts.SubtleConstantTimeEq :
  subtle.ConstantTimeEq edwards.CompressedEdwardsY := {
  ct_eq := edwards.CompressedEdwardsY.Insts.SubtleConstantTimeEq.ct_eq
}

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::CompressedEdwardsY}::to_bytes]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 193:4-195:5 -/
def edwards.CompressedEdwardsY.to_bytes
  (self : edwards.CompressedEdwardsY) : Result (Array Std.U8 32#usize) := do
  ok self

/-- [curve25519_dalek::edwards::decompress::step_2]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 230:4-248:5 -/
noncomputable def edwards.decompress.step_2
  (repr : edwards.CompressedEdwardsY)
  (X : backend.serial.u64.field.FieldElement51)
  (Y : backend.serial.u64.field.FieldElement51)
  (Z : backend.serial.u64.field.FieldElement51) :
  Result edwards.EdwardsPoint
  := do
  let a ← edwards.CompressedEdwardsY.as_bytes repr
  let i ← Array.index_usize a 31#usize
  let i1 ← i >>> 7#i32
  let compressed_sign_bit ← subtle.Choice.Insts.CoreConvertFromU8.from i1
  let x_neg ← Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg X
  let X1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      X x_neg compressed_sign_bit
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      X1 Y
  ok { X := X1, Y, Z, T := fe }

/-- [curve25519_dalek::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::pow22501]:
   Source: 'curve25519-dalek/src/field.rs', lines 169:4-203:5 -/
def field.FieldElement51.pow22501
  (self : backend.serial.u64.field.FieldElement51) :
  Result (backend.serial.u64.field.FieldElement51 ×
    backend.serial.u64.field.FieldElement51)
  := do
  let t0 ← backend.serial.u64.field.FieldElement51.square self
  let fe ← backend.serial.u64.field.FieldElement51.square t0
  let t1 ← backend.serial.u64.field.FieldElement51.square fe
  let t2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self t1
  let t3 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t0 t2
  let t4 ← backend.serial.u64.field.FieldElement51.square t3
  let t5 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t2 t4
  let t6 ← backend.serial.u64.field.FieldElement51.pow2k t5 5#u32
  let t7 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t6 t5
  let t8 ← backend.serial.u64.field.FieldElement51.pow2k t7 10#u32
  let t9 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t8 t7
  let t10 ← backend.serial.u64.field.FieldElement51.pow2k t9 20#u32
  let t11 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t10 t9
  let t12 ← backend.serial.u64.field.FieldElement51.pow2k t11 10#u32
  let t13 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t12 t7
  let t14 ← backend.serial.u64.field.FieldElement51.pow2k t13 50#u32
  let t15 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t14 t13
  let t16 ← backend.serial.u64.field.FieldElement51.pow2k t15 100#u32
  let t17 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t16 t15
  let t18 ← backend.serial.u64.field.FieldElement51.pow2k t17 50#u32
  let t19 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t18 t13
  ok (t19, t3)

/-- [curve25519_dalek::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::pow_p58]:
   Source: 'curve25519-dalek/src/field.rs', lines 268:4-277:5 -/
def field.FieldElement51.pow_p58
  (self : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let (t19, _) ← field.FieldElement51.pow22501 self
  let t20 ← backend.serial.u64.field.FieldElement51.pow2k t19 2#u32
  Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
    self t20

/-- [curve25519_dalek::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::sqrt_ratio_i]:
   Source: 'curve25519-dalek/src/field.rs', lines 291:4-338:5 -/
noncomputable def field.FieldElement51.sqrt_ratio_i
  (u : backend.serial.u64.field.FieldElement51)
  (v : backend.serial.u64.field.FieldElement51) :
  Result (subtle.Choice × backend.serial.u64.field.FieldElement51)
  := do
  let fe ← backend.serial.u64.field.FieldElement51.square v
  let v3 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      fe v
  let fe1 ← backend.serial.u64.field.FieldElement51.square v3
  let v7 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      fe1 v
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      u v3
  let fe3 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      u v7
  let fe4 ← field.FieldElement51.pow_p58 fe3
  let r ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      fe2 fe4
  let fe5 ← backend.serial.u64.field.FieldElement51.square r
  let check ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      v fe5
  let correct_sign_sqrt ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
      check u
  let fe6 ← Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg u
  let flipped_sign_sqrt ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
      check fe6
  let fe7 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      fe6 backend.serial.u64.constants.SQRT_M1
  let flipped_sign_sqrt_i ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
      check fe7
  let r_prime ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      backend.serial.u64.constants.SQRT_M1 r
  let c ←
    subtle.Choice.Insts.CoreOpsBitBitOrChoiceChoice.bitor flipped_sign_sqrt
      flipped_sign_sqrt_i
  let r1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      r r_prime c
  let r_is_negative ← field.FieldElement51.is_negative r1
  let r_neg ←
    Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg r1
  let r2 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      r1 r_neg r_is_negative
  let was_nonzero_square ←
    subtle.Choice.Insts.CoreOpsBitBitOrChoiceChoice.bitor correct_sign_sqrt
      flipped_sign_sqrt
  ok (was_nonzero_square, r2)

/-- [curve25519_dalek::edwards::decompress::step_1]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 216:4-227:5 -/
noncomputable def edwards.decompress.step_1
  (repr : edwards.CompressedEdwardsY) :
  Result (subtle.Choice × backend.serial.u64.field.FieldElement51 ×
    backend.serial.u64.field.FieldElement51 ×
    backend.serial.u64.field.FieldElement51)
  := do
  let a ← edwards.CompressedEdwardsY.as_bytes repr
  let Y ← backend.serial.u64.field.FieldElement51.from_bytes a
  let YY ← backend.serial.u64.field.FieldElement51.square Y
  let u ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      YY backend.serial.u64.field.FieldElement51.ONE
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      YY backend.serial.u64.constants.EDWARDS_D
  let v ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      fe backend.serial.u64.field.FieldElement51.ONE
  let (is_valid_y_coord, X) ← field.FieldElement51.sqrt_ratio_i u v
  ok (is_valid_y_coord, X, Y, backend.serial.u64.field.FieldElement51.ONE)

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::CompressedEdwardsY}::decompress]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 201:4-209:5 -/
noncomputable def edwards.CompressedEdwardsY.decompress
  (self : edwards.CompressedEdwardsY) :
  Result (Option edwards.EdwardsPoint)
  := do
  let (is_valid_y_coord, X, Y, Z) ← edwards.decompress.step_1 self
  let b ←
    core.convert.IntoFrom.into Bool.Insts.CoreConvertFromChoice
      is_valid_y_coord
  if b
  then let ep ← edwards.decompress.step_2 self X Y Z
       ok (some ep)
  else ok none

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::CompressedEdwardsY}::from_slice::{core::ops::function::FnOnce<([u8; 32usize]), curve25519_dalek::edwards::CompressedEdwardsY> for curve25519_dalek::edwards::{curve25519_dalek::edwards::CompressedEdwardsY}::from_slice::closure}::call_once]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 416:29-416:54 -/
def
  edwards.CompressedEdwardsY.from_slice.closure.Insts.CoreOpsFunctionFnOnceTupleArrayU832CompressedEdwardsY.call_once
  (c : edwards.CompressedEdwardsY.from_slice.closure)
  (tupled_args : Array Std.U8 32#usize) :
  Result edwards.CompressedEdwardsY
  := do
  ok tupled_args

/-- Trait implementation: [curve25519_dalek::edwards::{curve25519_dalek::edwards::CompressedEdwardsY}::from_slice::{core::ops::function::FnOnce<([u8; 32usize]), curve25519_dalek::edwards::CompressedEdwardsY> for curve25519_dalek::edwards::{curve25519_dalek::edwards::CompressedEdwardsY}::from_slice::closure}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 416:29-416:54 -/
@[reducible]
def
  edwards.CompressedEdwardsY.from_slice.closure.Insts.CoreOpsFunctionFnOnceTupleArrayU832CompressedEdwardsY
  : core.ops.function.FnOnce edwards.CompressedEdwardsY.from_slice.closure
  (Array Std.U8 32#usize) edwards.CompressedEdwardsY := {
  call_once :=
    edwards.CompressedEdwardsY.from_slice.closure.Insts.CoreOpsFunctionFnOnceTupleArrayU832CompressedEdwardsY.call_once
}

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::CompressedEdwardsY}::from_slice]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 414:4-417:5 -/
def edwards.CompressedEdwardsY.from_slice
  (bytes : Slice Std.U8) :
  Result (core.result.Result edwards.CompressedEdwardsY
    core.array.TryFromSliceError)
  := do
  let r ←
    core.convert.TryInto.Blanket.try_into
      (Array.Insts.CoreConvertTryFromShared0SliceTryFromSliceError 32#usize
      core.marker.CopyU8) bytes
  core.result.Result.map
    edwards.CompressedEdwardsY.from_slice.closure.Insts.CoreOpsFunctionFnOnceTupleArrayU832CompressedEdwardsY
    r ()

/-- [curve25519_dalek::edwards::{core::convert::TryFrom<&0 ([u8]), core::array::TryFromSliceError> for curve25519_dalek::edwards::CompressedEdwardsY}::try_from]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 254:4-256:5 -/
def
  edwards.CompressedEdwardsY.Insts.CoreConvertTryFromShared0SliceU8TryFromSliceError.try_from
  (slice : Slice Std.U8) :
  Result (core.result.Result edwards.CompressedEdwardsY
    core.array.TryFromSliceError)
  := do
  edwards.CompressedEdwardsY.from_slice slice

/-- Trait implementation: [curve25519_dalek::edwards::{core::convert::TryFrom<&0 ([u8]), core::array::TryFromSliceError> for curve25519_dalek::edwards::CompressedEdwardsY}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 251:0-257:1 -/
@[reducible]
def
  edwards.CompressedEdwardsY.Insts.CoreConvertTryFromShared0SliceU8TryFromSliceError
  : core.convert.TryFrom edwards.CompressedEdwardsY (Slice Std.U8)
  core.array.TryFromSliceError := {
  try_from :=
    edwards.CompressedEdwardsY.Insts.CoreConvertTryFromShared0SliceU8TryFromSliceError.try_from
}

/-- [curve25519_dalek::edwards::{core::clone::Clone for curve25519_dalek::edwards::EdwardsPoint}::clone]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 379:15-379:20 -/
def edwards.EdwardsPoint.Insts.CoreCloneClone.clone
  (self : edwards.EdwardsPoint) : Result edwards.EdwardsPoint := do
  ok self

/-- Trait implementation: [curve25519_dalek::edwards::{core::clone::Clone for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 379:15-379:20 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreCloneClone : core.clone.Clone
  edwards.EdwardsPoint := {
  clone := edwards.EdwardsPoint.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::marker::Copy for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 379:9-379:13 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreMarkerCopy : core.marker.Copy
  edwards.EdwardsPoint := {
  cloneInst := edwards.EdwardsPoint.Insts.CoreCloneClone
}

/-- [curve25519_dalek::edwards::{curve25519_dalek::traits::Identity for curve25519_dalek::edwards::CompressedEdwardsY}::identity]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 393:4-398:5 -/
def edwards.CompressedEdwardsY.Insts.Curve25519_dalekTraitsIdentity.identity
  : Result edwards.CompressedEdwardsY := do
  ok
    (Array.make 32#usize [
      1#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8,
      0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8,
      0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8
      ])

/-- Trait implementation: [curve25519_dalek::edwards::{curve25519_dalek::traits::Identity for curve25519_dalek::edwards::CompressedEdwardsY}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 392:0-399:1 -/
@[reducible]
def edwards.CompressedEdwardsY.Insts.Curve25519_dalekTraitsIdentity :
  traits.Identity edwards.CompressedEdwardsY := {
  identity :=
    edwards.CompressedEdwardsY.Insts.Curve25519_dalekTraitsIdentity.identity
}

/-- [curve25519_dalek::edwards::{core::default::Default for curve25519_dalek::edwards::CompressedEdwardsY}::default]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 402:4-404:5 -/
def edwards.CompressedEdwardsY.Insts.CoreDefaultDefault.default
  : Result edwards.CompressedEdwardsY := do
  edwards.CompressedEdwardsY.Insts.Curve25519_dalekTraitsIdentity.identity

/-- Trait implementation: [curve25519_dalek::edwards::{core::default::Default for curve25519_dalek::edwards::CompressedEdwardsY}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 401:0-405:1 -/
@[reducible]
def edwards.CompressedEdwardsY.Insts.CoreDefaultDefault : core.default.Default
  edwards.CompressedEdwardsY := {
  default := edwards.CompressedEdwardsY.Insts.CoreDefaultDefault.default
}

/-- Trait implementation: [curve25519_dalek::edwards::{curve25519_dalek::traits::Identity for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 420:0-429:1 -/
@[reducible]
def edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsIdentity : traits.Identity
  edwards.EdwardsPoint := {
  identity :=
    edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsIdentity.identity
}

/-- [curve25519_dalek::edwards::{core::default::Default for curve25519_dalek::edwards::EdwardsPoint}::default]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 432:4-434:5 -/
def edwards.EdwardsPoint.Insts.CoreDefaultDefault.default
  : Result edwards.EdwardsPoint := do
  edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsIdentity.identity

/-- Trait implementation: [curve25519_dalek::edwards::{core::default::Default for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 431:0-435:1 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreDefaultDefault : core.default.Default
  edwards.EdwardsPoint := {
  default := edwards.EdwardsPoint.Insts.CoreDefaultDefault.default
}

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::as_projective]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 533:4-539:5 -/
def edwards.EdwardsPoint.as_projective
  (self : edwards.EdwardsPoint) :
  Result backend.serial.curve_models.ProjectivePoint
  := do
  ok { X := self.X, Y := self.Y, Z := self.Z }

/-- [curve25519_dalek::edwards::{curve25519_dalek::traits::ValidityCheck for curve25519_dalek::edwards::EdwardsPoint}::is_valid]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 466:4-471:5 -/
def edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsValidityCheck.is_valid
  (self : edwards.EdwardsPoint) : Result Bool := do
  let pp ← edwards.EdwardsPoint.as_projective self
  let point_on_curve ←
    backend.serial.curve_models.ProjectivePoint.Insts.Curve25519_dalekTraitsValidityCheck.is_valid
      pp
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X self.Y
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Z self.T
  let on_segre_image ←
    backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51.eq
      fe fe1
  if point_on_curve
  then ok on_segre_image
  else ok false

/-- Trait implementation: [curve25519_dalek::edwards::{curve25519_dalek::traits::ValidityCheck for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 465:0-472:1 -/
@[reducible]
def edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsValidityCheck :
  traits.ValidityCheck edwards.EdwardsPoint := {
  is_valid :=
    edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsValidityCheck.is_valid
}

/-- [curve25519_dalek::edwards::{subtle::ConditionallySelectable for curve25519_dalek::edwards::EdwardsPoint}::conditional_select]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 479:4-486:5 -/
def edwards.EdwardsPoint.Insts.SubtleConditionallySelectable.conditional_select
  (a : edwards.EdwardsPoint) (b : edwards.EdwardsPoint)
  (choice : subtle.Choice) :
  Result edwards.EdwardsPoint
  := do
  let fe ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.X b.X choice
  let fe1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.Y b.Y choice
  let fe2 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.Z b.Z choice
  let fe3 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.T b.T choice
  ok { X := fe, Y := fe1, Z := fe2, T := fe3 }

/-- Trait implementation: [curve25519_dalek::edwards::{subtle::ConditionallySelectable for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 478:0-487:1 -/
@[reducible]
def edwards.EdwardsPoint.Insts.SubtleConditionallySelectable :
  subtle.ConditionallySelectable edwards.EdwardsPoint := {
  coremarkerCopyInst := edwards.EdwardsPoint.Insts.CoreMarkerCopy
  conditional_select :=
    edwards.EdwardsPoint.Insts.SubtleConditionallySelectable.conditional_select
  conditional_assign :=
    edwards.EdwardsPoint.Insts.SubtleConditionallySelectable.conditional_assign
  conditional_swap :=
    edwards.EdwardsPoint.Insts.SubtleConditionallySelectable.conditional_swap
}

/-- [curve25519_dalek::edwards::{subtle::ConstantTimeEq for curve25519_dalek::edwards::EdwardsPoint}::ct_eq]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 494:4-503:5 -/
def edwards.EdwardsPoint.Insts.SubtleConstantTimeEq.ct_eq
  (self : edwards.EdwardsPoint) (other : edwards.EdwardsPoint) :
  Result subtle.Choice
  := do
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X other.Z
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      other.X self.Z
  let c ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq fe
      fe1
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Y other.Z
  let fe3 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      other.Y self.Z
  let c1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
      fe2 fe3
  subtle.Choice.Insts.CoreOpsBitBitAndChoiceChoice.bitand c c1

/-- Trait implementation: [curve25519_dalek::edwards::{subtle::ConstantTimeEq for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 493:0-504:1 -/
@[reducible]
def edwards.EdwardsPoint.Insts.SubtleConstantTimeEq : subtle.ConstantTimeEq
  edwards.EdwardsPoint := {
  ct_eq := edwards.EdwardsPoint.Insts.SubtleConstantTimeEq.ct_eq
}

/-- [curve25519_dalek::edwards::{core::cmp::PartialEq<curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}::eq]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 507:4-509:5 -/
def edwards.EdwardsPoint.Insts.CoreCmpPartialEqEdwardsPoint.eq
  (self : edwards.EdwardsPoint) (other : edwards.EdwardsPoint) :
  Result Bool
  := do
  let c ← edwards.EdwardsPoint.Insts.SubtleConstantTimeEq.ct_eq self other
  core.convert.IntoFrom.into Bool.Insts.CoreConvertFromChoice c

/-- Trait implementation: [curve25519_dalek::edwards::{core::cmp::PartialEq<curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 506:0-510:1 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreCmpPartialEqEdwardsPoint :
  core.cmp.PartialEq edwards.EdwardsPoint edwards.EdwardsPoint := {
  eq := edwards.EdwardsPoint.Insts.CoreCmpPartialEqEdwardsPoint.eq
  ne := edwards.EdwardsPoint.Insts.CoreCmpPartialEqEdwardsPoint.ne
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::cmp::Eq for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 512:0-512:27 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreCmpEq : core.cmp.Eq edwards.EdwardsPoint
  := {
  partialEqInst := edwards.EdwardsPoint.Insts.CoreCmpPartialEqEdwardsPoint
  assert_receiver_is_total_eq :=
    edwards.EdwardsPoint.Insts.CoreCmpEq.assert_receiver_is_total_eq
}

/-- [curve25519_dalek::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::invert]:
   Source: 'curve25519-dalek/src/field.rs', lines 254:4-263:5 -/
def field.FieldElement51.invert
  (self : backend.serial.u64.field.FieldElement51) :
  Result backend.serial.u64.field.FieldElement51
  := do
  let (t19, t3) ← field.FieldElement51.pow22501 self
  let t20 ← backend.serial.u64.field.FieldElement51.pow2k t19 5#u32
  Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
    t20 t3

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::as_affine_niels]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 543:4-553:5 -/
def edwards.EdwardsPoint.as_affine_niels
  (self : edwards.EdwardsPoint) :
  Result backend.serial.curve_models.AffineNielsPoint
  := do
  let recip ← field.FieldElement51.invert self.Z
  let x ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X recip
  let y ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Y recip
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      x y
  let xy2d ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      fe backend.serial.u64.constants.EDWARDS_D2
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      y x
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      y x
  ok { y_plus_x := fe1, y_minus_x := fe2, xy2d }

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::to_affine]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 556:4-561:5 -/
def edwards.EdwardsPoint.to_affine
  (self : edwards.EdwardsPoint) : Result edwards.affine.AffinePoint := do
  let recip ← field.FieldElement51.invert self.Z
  let x ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X recip
  let y ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Y recip
  ok { x, y }

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::to_montgomery]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 572:4-582:5 -/
def edwards.EdwardsPoint.to_montgomery
  (self : edwards.EdwardsPoint) : Result montgomery.MontgomeryPoint := do
  let U ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      self.Z self.Y
  let W ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      self.Z self.Y
  let fe ← field.FieldElement51.invert W
  let u ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      U fe
  let a ← backend.serial.u64.field.FieldElement51.to_bytes u
  ok a

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::compress]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 607:4-609:5 -/
def edwards.EdwardsPoint.compress
  (self : edwards.EdwardsPoint) : Result edwards.CompressedEdwardsY := do
  let ap ← edwards.EdwardsPoint.to_affine self
  edwards.affine.AffinePoint.compress ap

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::double]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 745:4-747:5 -/
def edwards.EdwardsPoint.double
  (self : edwards.EdwardsPoint) : Result edwards.EdwardsPoint := do
  let pp ← edwards.EdwardsPoint.as_projective self
  let cp ← backend.serial.curve_models.ProjectivePoint.double pp
  backend.serial.curve_models.CompletedPoint.as_extended cp

/-- [curve25519_dalek::edwards::{core::ops::arith::Add<&'a (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}::add]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 756:4-758:5 -/
def
  Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAEdwardsPointEdwardsPoint.add
  (self : edwards.EdwardsPoint) (other : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  let pnp ← edwards.EdwardsPoint.as_projective_niels other
  let cp ←
    Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAProjectiveNielsPointCompletedPoint.add
      self pnp
  backend.serial.curve_models.CompletedPoint.as_extended cp

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Add<&'a (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 754:0-759:1 -/
@[reducible]
def Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAEdwardsPointEdwardsPoint :
  core.ops.arith.Add edwards.EdwardsPoint edwards.EdwardsPoint
  edwards.EdwardsPoint := {
  add :=
    Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAEdwardsPointEdwardsPoint.add
}

/-- [curve25519_dalek::edwards::{core::ops::arith::AddAssign<&'a (curve25519_dalek::edwards::EdwardsPoint)> for curve25519_dalek::edwards::EdwardsPoint}::add_assign]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 768:4-770:5 -/
def
  edwards.EdwardsPoint.Insts.CoreOpsArithAddAssignSharedAEdwardsPoint.add_assign
  (self : edwards.EdwardsPoint) (_rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAEdwardsPointEdwardsPoint.add
    self _rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::AddAssign<&'a (curve25519_dalek::edwards::EdwardsPoint)> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 767:0-771:1 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithAddAssignSharedAEdwardsPoint :
  core.ops.arith.AddAssign edwards.EdwardsPoint edwards.EdwardsPoint := {
  add_assign :=
    edwards.EdwardsPoint.Insts.CoreOpsArithAddAssignSharedAEdwardsPoint.add_assign
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Sub<&'a (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}::sub]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 777:4-779:5 -/
def
  Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAEdwardsPointEdwardsPoint.sub
  (self : edwards.EdwardsPoint) (other : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  let pnp ← edwards.EdwardsPoint.as_projective_niels other
  let cp ←
    Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAProjectiveNielsPointCompletedPoint.sub
      self pnp
  backend.serial.curve_models.CompletedPoint.as_extended cp

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Sub<&'a (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 775:0-780:1 -/
@[reducible]
def Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAEdwardsPointEdwardsPoint :
  core.ops.arith.Sub edwards.EdwardsPoint edwards.EdwardsPoint
  edwards.EdwardsPoint := {
  sub :=
    Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAEdwardsPointEdwardsPoint.sub
}

/-- [curve25519_dalek::edwards::{core::ops::arith::SubAssign<&'a (curve25519_dalek::edwards::EdwardsPoint)> for curve25519_dalek::edwards::EdwardsPoint}::sub_assign]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 789:4-791:5 -/
def
  edwards.EdwardsPoint.Insts.CoreOpsArithSubAssignSharedAEdwardsPoint.sub_assign
  (self : edwards.EdwardsPoint) (_rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAEdwardsPointEdwardsPoint.sub
    self _rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::SubAssign<&'a (curve25519_dalek::edwards::EdwardsPoint)> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 788:0-792:1 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithSubAssignSharedAEdwardsPoint :
  core.ops.arith.SubAssign edwards.EdwardsPoint edwards.EdwardsPoint := {
  sub_assign :=
    edwards.EdwardsPoint.Insts.CoreOpsArithSubAssignSharedAEdwardsPoint.sub_assign
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Neg<curve25519_dalek::edwards::EdwardsPoint> for &0 (curve25519_dalek::edwards::EdwardsPoint)}::neg]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 815:4-822:5 -/
def Shared0EdwardsPoint.Insts.CoreOpsArithNegEdwardsPoint.neg
  (self : edwards.EdwardsPoint) : Result edwards.EdwardsPoint := do
  let fe ←
    Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg self.X
  let fe1 ←
    Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg self.T
  ok { self with X := fe, T := fe1 }

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Neg<curve25519_dalek::edwards::EdwardsPoint> for &0 (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 812:0-823:1 -/
@[reducible]
def Shared0EdwardsPoint.Insts.CoreOpsArithNegEdwardsPoint : core.ops.arith.Neg
  edwards.EdwardsPoint edwards.EdwardsPoint := {
  neg := Shared0EdwardsPoint.Insts.CoreOpsArithNegEdwardsPoint.neg
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Neg<curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}::neg]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 828:4-830:5 -/
def edwards.EdwardsPoint.Insts.CoreOpsArithNegEdwardsPoint.neg
  (self : edwards.EdwardsPoint) : Result edwards.EdwardsPoint := do
  Shared0EdwardsPoint.Insts.CoreOpsArithNegEdwardsPoint.neg self

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Neg<curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 825:0-831:1 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithNegEdwardsPoint : core.ops.arith.Neg
  edwards.EdwardsPoint edwards.EdwardsPoint := {
  neg := edwards.EdwardsPoint.Insts.CoreOpsArithNegEdwardsPoint.neg
}

/-- [curve25519_dalek::edwards::{core::ops::arith::MulAssign<&'a (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::edwards::EdwardsPoint}::mul_assign]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 838:4-841:5 -/
def edwards.EdwardsPoint.Insts.CoreOpsArithMulAssignSharedAScalar.mul_assign
  (self : edwards.EdwardsPoint) (scalar : scalar.Scalar) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithMulSharedAScalarEdwardsPoint.mul self
    scalar

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::MulAssign<&'a (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 837:0-842:1 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithMulAssignSharedAScalar :
  core.ops.arith.MulAssign edwards.EdwardsPoint scalar.Scalar := {
  mul_assign :=
    edwards.EdwardsPoint.Insts.CoreOpsArithMulAssignSharedAScalar.mul_assign
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Mul<&'a (curve25519_dalek::scalar::Scalar), curve25519_dalek::edwards::EdwardsPoint> for &1 (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 849:0-858:1 -/
@[reducible]
def Shared0EdwardsPoint.Insts.CoreOpsArithMulSharedAScalarEdwardsPoint :
  core.ops.arith.Mul edwards.EdwardsPoint scalar.Scalar edwards.EdwardsPoint
  := {
  mul := Shared0EdwardsPoint.Insts.CoreOpsArithMulSharedAScalarEdwardsPoint.mul
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Mul<&'a (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for &1 (curve25519_dalek::scalar::Scalar)}::mul]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 867:4-869:5 -/
def Shared0Scalar.Insts.CoreOpsArithMulSharedAEdwardsPointEdwardsPoint.mul
  (self : scalar.Scalar) (point : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithMulSharedAScalarEdwardsPoint.mul point
    self

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Mul<&'a (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for &1 (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/edwards.rs', lines 860:0-870:1 -/
@[reducible]
def Shared0Scalar.Insts.CoreOpsArithMulSharedAEdwardsPointEdwardsPoint :
  core.ops.arith.Mul scalar.Scalar edwards.EdwardsPoint edwards.EdwardsPoint
  := {
  mul := Shared0Scalar.Insts.CoreOpsArithMulSharedAEdwardsPointEdwardsPoint.mul
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Mul<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for &'a (curve25519_dalek::scalar::Scalar)}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 100:12-102:13 -/
def SharedAScalar.Insts.CoreOpsArithMulEdwardsPointEdwardsPoint.mul
  (self : scalar.Scalar) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0Scalar.Insts.CoreOpsArithMulSharedAEdwardsPointEdwardsPoint.mul self
    rhs

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::mul_base]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 877:4-887:5 -/
noncomputable def edwards.EdwardsPoint.mul_base
  (scalar : scalar.Scalar) : Result edwards.EdwardsPoint := do
  SharedAScalar.Insts.CoreOpsArithMulEdwardsPointEdwardsPoint.mul scalar
    backend.serial.u64.constants.ED25519_BASEPOINT_POINT

/-- [curve25519_dalek::scalar::clamp_integer]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1405:0-1410:1 -/
def scalar.clamp_integer
  (bytes : Array Std.U8 32#usize) : Result (Array Std.U8 32#usize) := do
  let i ← Array.index_usize bytes 0#usize
  let i1 ← (↑(i &&& 248#u8) : Result Std.U8)
  let bytes1 ← Array.update bytes 0#usize i1
  let i2 ← Array.index_usize bytes1 31#usize
  let i3 ← (↑(i2 &&& 127#u8) : Result Std.U8)
  let bytes2 ← Array.update bytes1 31#usize i3
  let i4 ← Array.index_usize bytes2 31#usize
  let i5 ← (↑(i4 ||| 64#u8) : Result Std.U8)
  Array.update bytes2 31#usize i5

/-- [curve25519_dalek::edwards::{core::ops::arith::Mul<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::scalar::Scalar}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 107:12-109:13 -/
def scalar.Scalar.Insts.CoreOpsArithMulEdwardsPointEdwardsPoint.mul
  (self : scalar.Scalar) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0Scalar.Insts.CoreOpsArithMulSharedAEdwardsPointEdwardsPoint.mul self
    rhs

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::mul_clamped]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 891:4-903:5 -/
noncomputable def edwards.EdwardsPoint.mul_clamped
  (self : edwards.EdwardsPoint) (bytes : Array Std.U8 32#usize) :
  Result edwards.EdwardsPoint
  := do
  let a ← scalar.clamp_integer bytes
  scalar.Scalar.Insts.CoreOpsArithMulEdwardsPointEdwardsPoint.mul
    { bytes := a } self

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::mul_base_clamped]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 907:4-915:5 -/
noncomputable def edwards.EdwardsPoint.mul_base_clamped
  (bytes : Array Std.U8 32#usize) : Result edwards.EdwardsPoint := do
  let a ← scalar.clamp_integer bytes
  edwards.EdwardsPoint.mul_base { bytes := a }

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::mul_by_pow_2]: loop 0:
   Source: 'curve25519-dalek/src/edwards.rs', lines 1335:8-1339:9 -/
def edwards.EdwardsPoint.mul_by_pow_2_loop
  (k : Std.U32) (s : backend.serial.curve_models.ProjectivePoint) (i : Std.U32)
  :
  Result backend.serial.curve_models.ProjectivePoint
  := do
  let i1 ← k - 1#u32
  if i < i1
  then
    let r ← backend.serial.curve_models.ProjectivePoint.double s
    let s1 ← backend.serial.curve_models.CompletedPoint.as_projective r
    let i2 ← i + 1#u32
    edwards.EdwardsPoint.mul_by_pow_2_loop k s1 i2
  else ok s
partial_fixpoint

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::mul_by_pow_2]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 1330:4-1342:5 -/
def edwards.EdwardsPoint.mul_by_pow_2
  (self : edwards.EdwardsPoint) (k : Std.U32) :
  Result edwards.EdwardsPoint
  := do
  massert (k > 0#u32)
  let s ← edwards.EdwardsPoint.as_projective self
  let s1 ← edwards.EdwardsPoint.mul_by_pow_2_loop k s 0#u32
  let cp ← backend.serial.curve_models.ProjectivePoint.double s1
  backend.serial.curve_models.CompletedPoint.as_extended cp

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::mul_by_cofactor]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 1325:4-1327:5 -/
def edwards.EdwardsPoint.mul_by_cofactor
  (self : edwards.EdwardsPoint) : Result edwards.EdwardsPoint := do
  edwards.EdwardsPoint.mul_by_pow_2 self 3#u32

/-- [curve25519_dalek::traits::{curve25519_dalek::traits::IsIdentity for T}::is_identity]:
   Source: 'curve25519-dalek/src/traits.rs', lines 45:4-47:5 -/
def traits.IsIdentity.Blanket.is_identity
  {T : Type} (subtleConstantTimeEqInst : subtle.ConstantTimeEq T) (IdentityInst
  : traits.Identity T) (self : T) :
  Result Bool
  := do
  let t ← IdentityInst.identity
  let c ← subtleConstantTimeEqInst.ct_eq self t
  core.convert.IntoFrom.into Bool.Insts.CoreConvertFromChoice c

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::is_small_order]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 1367:4-1369:5 -/
noncomputable def edwards.EdwardsPoint.is_small_order
  (self : edwards.EdwardsPoint) : Result Bool := do
  let ep ← edwards.EdwardsPoint.mul_by_cofactor self
  traits.IsIdentity.Blanket.is_identity
    edwards.EdwardsPoint.Insts.SubtleConstantTimeEq
    edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsIdentity ep

/-- [curve25519_dalek::edwards::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::edwards::EdwardsPoint> for &'a (curve25519_dalek::edwards::EdwardsPoint)}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 100:12-102:13 -/
def SharedAEdwardsPoint.Insts.CoreOpsArithMulScalarEdwardsPoint.mul
  (self : edwards.EdwardsPoint) (rhs : scalar.Scalar) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithMulSharedAScalarEdwardsPoint.mul self
    rhs

/-- [curve25519_dalek::edwards::{curve25519_dalek::edwards::EdwardsPoint}::is_torsion_free]:
   Source: 'curve25519-dalek/src/edwards.rs', lines 1397:4-1399:5 -/
noncomputable def edwards.EdwardsPoint.is_torsion_free
  (self : edwards.EdwardsPoint) : Result Bool := do
  let ep ←
    SharedAEdwardsPoint.Insts.CoreOpsArithMulScalarEdwardsPoint.mul self
      constants.BASEPOINT_ORDER_PRIVATE
  traits.IsIdentity.Blanket.is_identity
    edwards.EdwardsPoint.Insts.SubtleConstantTimeEq
    edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsIdentity ep

/-- Trait implementation: [curve25519_dalek::field::{core::cmp::PartialEq<curve25519_dalek::backend::serial::u64::field::FieldElement51> for curve25519_dalek::backend::serial::u64::field::FieldElement51}]
   Source: 'curve25519-dalek/src/field.rs', lines 85:0-89:1 -/
@[reducible]
def
  backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51
  : core.cmp.PartialEq backend.serial.u64.field.FieldElement51
  backend.serial.u64.field.FieldElement51 := {
  eq :=
    backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51.eq
  ne :=
    backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51.ne
}

/-- Trait implementation: [curve25519_dalek::field::{core::cmp::Eq for curve25519_dalek::backend::serial::u64::field::FieldElement51}]
   Source: 'curve25519-dalek/src/field.rs', lines 83:0-83:27 -/
@[reducible]
def backend.serial.u64.field.FieldElement51.Insts.CoreCmpEq : core.cmp.Eq
  backend.serial.u64.field.FieldElement51 := {
  partialEqInst :=
    backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51
  assert_receiver_is_total_eq :=
    backend.serial.u64.field.FieldElement51.Insts.CoreCmpEq.assert_receiver_is_total_eq
}

/-- Trait implementation: [curve25519_dalek::field::{subtle::ConstantTimeEq for curve25519_dalek::backend::serial::u64::field::FieldElement51}]
   Source: 'curve25519-dalek/src/field.rs', lines 91:0-98:1 -/
@[reducible]
def backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq :
  subtle.ConstantTimeEq backend.serial.u64.field.FieldElement51 := {
  ct_eq :=
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
}

/-- [curve25519_dalek::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::is_zero]:
   Source: 'curve25519-dalek/src/field.rs', lines 159:4-164:5 -/
noncomputable def field.FieldElement51.is_zero
  (self : backend.serial.u64.field.FieldElement51) : Result subtle.Choice := do
  let zero := Array.repeat 32#usize 0#u8
  let bytes ← backend.serial.u64.field.FieldElement51.to_bytes self
  let s ← (↑(Array.to_slice bytes) : Result (Slice Std.U8))
  let s1 ← (↑(Array.to_slice zero) : Result (Slice Std.U8))
  Slice.Insts.SubtleConstantTimeEq.ct_eq U8.Insts.SubtleConstantTimeEq s s1

/-- [curve25519_dalek::field::{curve25519_dalek::backend::serial::u64::field::FieldElement51}::invsqrt]:
   Source: 'curve25519-dalek/src/field.rs', lines 352:4-354:5 -/
noncomputable def field.FieldElement51.invsqrt
  (self : backend.serial.u64.field.FieldElement51) :
  Result (subtle.Choice × backend.serial.u64.field.FieldElement51)
  := do
  field.FieldElement51.sqrt_ratio_i backend.serial.u64.field.FieldElement51.ONE
    self

/-- [curve25519_dalek::edwards::{core::ops::arith::Add<&'b (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}::add]:
   Source: 'curve25519-dalek/src/macros.rs', lines 19:12-21:13 -/
def
  edwards.EdwardsPoint.Insts.CoreOpsArithAddSharedBEdwardsPointEdwardsPoint.add
  (self : edwards.EdwardsPoint) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAEdwardsPointEdwardsPoint.add
    self rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Add<&'b (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 17:8-22:9 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithAddSharedBEdwardsPointEdwardsPoint :
  core.ops.arith.Add edwards.EdwardsPoint edwards.EdwardsPoint
  edwards.EdwardsPoint := {
  add :=
    edwards.EdwardsPoint.Insts.CoreOpsArithAddSharedBEdwardsPointEdwardsPoint.add
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Add<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}::add]:
   Source: 'curve25519-dalek/src/macros.rs', lines 33:12-35:13 -/
def edwards.EdwardsPoint.Insts.CoreOpsArithAddEdwardsPointEdwardsPoint.add
  (self : edwards.EdwardsPoint) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAEdwardsPointEdwardsPoint.add
    self rhs

/-- [curve25519_dalek::ristretto::{core::ops::arith::Add<&'a (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for &1 (curve25519_dalek::ristretto::RistrettoPoint)}::add]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 890:4-892:5 -/
def
  Shared0RistrettoPoint.Insts.CoreOpsArithAddSharedARistrettoPointRistrettoPoint.add
  (self : ristretto.RistrettoPoint) (other : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  let ep ←
    edwards.EdwardsPoint.Insts.CoreOpsArithAddEdwardsPointEdwardsPoint.add self
      other
  ok ep

/-- [curve25519_dalek::ristretto::{core::ops::arith::Add<&'b (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}::add]:
   Source: 'curve25519-dalek/src/macros.rs', lines 19:12-21:13 -/
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithAddSharedBRistrettoPointRistrettoPoint.add
  (self : ristretto.RistrettoPoint) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithAddSharedARistrettoPointRistrettoPoint.add
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Add<&'b (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 17:8-22:9 -/
@[reducible]
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithAddSharedBRistrettoPointRistrettoPoint
  : core.ops.arith.Add ristretto.RistrettoPoint ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  add :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithAddSharedBRistrettoPointRistrettoPoint.add
}

/-- [curve25519_dalek::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::pack]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1155:4-1159:5 -/
def scalar.Scalar52.pack
  (self : backend.serial.u64.scalar.Scalar52) : Result scalar.Scalar := do
  let a ← backend.serial.u64.scalar.Scalar52.to_bytes self
  ok { bytes := a }

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::unpack]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1133:4-1135:5 -/
def scalar.Scalar.unpack
  (self : scalar.Scalar) : Result backend.serial.u64.scalar.Scalar52 := do
  backend.serial.u64.scalar.Scalar52.from_bytes self.bytes

/-- [curve25519_dalek::scalar::{core::ops::arith::Add<&'a (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for &1 (curve25519_dalek::scalar::Scalar)}::add]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 343:4-347:5 -/
def Shared0Scalar.Insts.CoreOpsArithAddSharedAScalarScalar.add
  (self : scalar.Scalar) (_rhs : scalar.Scalar) : Result scalar.Scalar := do
  let s ← scalar.Scalar.unpack self
  let s1 ← scalar.Scalar.unpack _rhs
  let s2 ← backend.serial.u64.scalar.Scalar52.add s s1
  scalar.Scalar52.pack s2

/-- [curve25519_dalek::scalar::{core::ops::arith::Add<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::add]:
   Source: 'curve25519-dalek/src/macros.rs', lines 19:12-21:13 -/
def scalar.Scalar.Insts.CoreOpsArithAddSharedBScalarScalar.add
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  Shared0Scalar.Insts.CoreOpsArithAddSharedAScalarScalar.add self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Add<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 17:8-22:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithAddSharedBScalarScalar : core.ops.arith.Add
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  add := scalar.Scalar.Insts.CoreOpsArithAddSharedBScalarScalar.add
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Add<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for &'a (curve25519_dalek::edwards::EdwardsPoint)}::add]:
   Source: 'curve25519-dalek/src/macros.rs', lines 26:12-28:13 -/
def SharedAEdwardsPoint.Insts.CoreOpsArithAddEdwardsPointEdwardsPoint.add
  (self : edwards.EdwardsPoint) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithAddSharedAEdwardsPointEdwardsPoint.add
    self rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Add<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for &'a (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 24:8-29:9 -/
@[reducible]
def SharedAEdwardsPoint.Insts.CoreOpsArithAddEdwardsPointEdwardsPoint :
  core.ops.arith.Add edwards.EdwardsPoint edwards.EdwardsPoint
  edwards.EdwardsPoint := {
  add := SharedAEdwardsPoint.Insts.CoreOpsArithAddEdwardsPointEdwardsPoint.add
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Add<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for &'a (curve25519_dalek::ristretto::RistrettoPoint)}::add]:
   Source: 'curve25519-dalek/src/macros.rs', lines 26:12-28:13 -/
def SharedARistrettoPoint.Insts.CoreOpsArithAddRistrettoPointRistrettoPoint.add
  (self : ristretto.RistrettoPoint) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithAddSharedARistrettoPointRistrettoPoint.add
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Add<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for &'a (curve25519_dalek::ristretto::RistrettoPoint)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 24:8-29:9 -/
@[reducible]
def SharedARistrettoPoint.Insts.CoreOpsArithAddRistrettoPointRistrettoPoint :
  core.ops.arith.Add ristretto.RistrettoPoint ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  add :=
    SharedARistrettoPoint.Insts.CoreOpsArithAddRistrettoPointRistrettoPoint.add
}

/-- [curve25519_dalek::scalar::{core::ops::arith::Add<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for &'a (curve25519_dalek::scalar::Scalar)}::add]:
   Source: 'curve25519-dalek/src/macros.rs', lines 26:12-28:13 -/
def SharedAScalar.Insts.CoreOpsArithAddScalarScalar.add
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  Shared0Scalar.Insts.CoreOpsArithAddSharedAScalarScalar.add self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Add<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for &'a (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 24:8-29:9 -/
@[reducible]
def SharedAScalar.Insts.CoreOpsArithAddScalarScalar : core.ops.arith.Add
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  add := SharedAScalar.Insts.CoreOpsArithAddScalarScalar.add
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Add<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 31:8-36:9 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithAddEdwardsPointEdwardsPoint :
  core.ops.arith.Add edwards.EdwardsPoint edwards.EdwardsPoint
  edwards.EdwardsPoint := {
  add := edwards.EdwardsPoint.Insts.CoreOpsArithAddEdwardsPointEdwardsPoint.add
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Add<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}::add]:
   Source: 'curve25519-dalek/src/macros.rs', lines 33:12-35:13 -/
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithAddRistrettoPointRistrettoPoint.add
  (self : ristretto.RistrettoPoint) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithAddSharedARistrettoPointRistrettoPoint.add
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Add<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 31:8-36:9 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithAddRistrettoPointRistrettoPoint
  : core.ops.arith.Add ristretto.RistrettoPoint ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  add :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithAddRistrettoPointRistrettoPoint.add
}

/-- [curve25519_dalek::scalar::{core::ops::arith::Add<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::add]:
   Source: 'curve25519-dalek/src/macros.rs', lines 33:12-35:13 -/
def scalar.Scalar.Insts.CoreOpsArithAddScalarScalar.add
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  Shared0Scalar.Insts.CoreOpsArithAddSharedAScalarScalar.add self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Add<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 31:8-36:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithAddScalarScalar : core.ops.arith.Add
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  add := scalar.Scalar.Insts.CoreOpsArithAddScalarScalar.add
}

/-- [curve25519_dalek::edwards::{core::ops::arith::AddAssign<curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}::add_assign]:
   Source: 'curve25519-dalek/src/macros.rs', lines 44:12-46:13 -/
def edwards.EdwardsPoint.Insts.CoreOpsArithAddAssignEdwardsPoint.add_assign
  (self : edwards.EdwardsPoint) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  edwards.EdwardsPoint.Insts.CoreOpsArithAddAssignSharedAEdwardsPoint.add_assign
    self rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::AddAssign<curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 43:8-47:9 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithAddAssignEdwardsPoint :
  core.ops.arith.AddAssign edwards.EdwardsPoint edwards.EdwardsPoint := {
  add_assign :=
    edwards.EdwardsPoint.Insts.CoreOpsArithAddAssignEdwardsPoint.add_assign
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::AddAssign<&0 (curve25519_dalek::ristretto::RistrettoPoint)> for curve25519_dalek::ristretto::RistrettoPoint}::add_assign]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 902:4-904:5 -/
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithAddAssignShared0RistrettoPoint.add_assign
  (self : ristretto.RistrettoPoint) (_rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithAddSharedARistrettoPointRistrettoPoint.add
    self _rhs

/-- [curve25519_dalek::ristretto::{core::ops::arith::AddAssign<curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}::add_assign]:
   Source: 'curve25519-dalek/src/macros.rs', lines 44:12-46:13 -/
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithAddAssignRistrettoPoint.add_assign
  (self : ristretto.RistrettoPoint) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  ristretto.RistrettoPoint.Insts.CoreOpsArithAddAssignShared0RistrettoPoint.add_assign
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::AddAssign<curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 43:8-47:9 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithAddAssignRistrettoPoint :
  core.ops.arith.AddAssign ristretto.RistrettoPoint ristretto.RistrettoPoint
  := {
  add_assign :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithAddAssignRistrettoPoint.add_assign
}

/-- [curve25519_dalek::scalar::{core::ops::arith::AddAssign<&'a (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::scalar::Scalar}::add_assign]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 333:4-335:5 -/
def scalar.Scalar.Insts.CoreOpsArithAddAssignSharedAScalar.add_assign
  (self : scalar.Scalar) (_rhs : scalar.Scalar) : Result scalar.Scalar := do
  scalar.Scalar.Insts.CoreOpsArithAddSharedBScalarScalar.add self _rhs

/-- [curve25519_dalek::scalar::{core::ops::arith::AddAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::add_assign]:
   Source: 'curve25519-dalek/src/macros.rs', lines 44:12-46:13 -/
def scalar.Scalar.Insts.CoreOpsArithAddAssignScalar.add_assign
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  scalar.Scalar.Insts.CoreOpsArithAddAssignSharedAScalar.add_assign self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::AddAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 43:8-47:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithAddAssignScalar : core.ops.arith.AddAssign
  scalar.Scalar scalar.Scalar := {
  add_assign := scalar.Scalar.Insts.CoreOpsArithAddAssignScalar.add_assign
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Sub<&'b (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}::sub]:
   Source: 'curve25519-dalek/src/macros.rs', lines 56:12-58:13 -/
def
  edwards.EdwardsPoint.Insts.CoreOpsArithSubSharedBEdwardsPointEdwardsPoint.sub
  (self : edwards.EdwardsPoint) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAEdwardsPointEdwardsPoint.sub
    self rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Sub<&'b (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 54:8-59:9 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithSubSharedBEdwardsPointEdwardsPoint :
  core.ops.arith.Sub edwards.EdwardsPoint edwards.EdwardsPoint
  edwards.EdwardsPoint := {
  sub :=
    edwards.EdwardsPoint.Insts.CoreOpsArithSubSharedBEdwardsPointEdwardsPoint.sub
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Sub<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}::sub]:
   Source: 'curve25519-dalek/src/macros.rs', lines 70:12-72:13 -/
def edwards.EdwardsPoint.Insts.CoreOpsArithSubEdwardsPointEdwardsPoint.sub
  (self : edwards.EdwardsPoint) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAEdwardsPointEdwardsPoint.sub
    self rhs

/-- [curve25519_dalek::ristretto::{core::ops::arith::Sub<&'a (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for &1 (curve25519_dalek::ristretto::RistrettoPoint)}::sub]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 912:4-914:5 -/
def
  Shared0RistrettoPoint.Insts.CoreOpsArithSubSharedARistrettoPointRistrettoPoint.sub
  (self : ristretto.RistrettoPoint) (other : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  let ep ←
    edwards.EdwardsPoint.Insts.CoreOpsArithSubEdwardsPointEdwardsPoint.sub self
      other
  ok ep

/-- [curve25519_dalek::ristretto::{core::ops::arith::Sub<&'b (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}::sub]:
   Source: 'curve25519-dalek/src/macros.rs', lines 56:12-58:13 -/
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithSubSharedBRistrettoPointRistrettoPoint.sub
  (self : ristretto.RistrettoPoint) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithSubSharedARistrettoPointRistrettoPoint.sub
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Sub<&'b (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 54:8-59:9 -/
@[reducible]
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithSubSharedBRistrettoPointRistrettoPoint
  : core.ops.arith.Sub ristretto.RistrettoPoint ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  sub :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithSubSharedBRistrettoPointRistrettoPoint.sub
}

/-- [curve25519_dalek::scalar::{core::ops::arith::Sub<&'a (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for &1 (curve25519_dalek::scalar::Scalar)}::sub]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 363:4-367:5 -/
def Shared0Scalar.Insts.CoreOpsArithSubSharedAScalarScalar.sub
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  let s ← scalar.Scalar.unpack self
  let s1 ← scalar.Scalar.unpack rhs
  let s2 ← backend.serial.u64.scalar.Scalar52.sub s s1
  scalar.Scalar52.pack s2

/-- [curve25519_dalek::scalar::{core::ops::arith::Sub<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::sub]:
   Source: 'curve25519-dalek/src/macros.rs', lines 56:12-58:13 -/
def scalar.Scalar.Insts.CoreOpsArithSubSharedBScalarScalar.sub
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  Shared0Scalar.Insts.CoreOpsArithSubSharedAScalarScalar.sub self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Sub<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 54:8-59:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithSubSharedBScalarScalar : core.ops.arith.Sub
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  sub := scalar.Scalar.Insts.CoreOpsArithSubSharedBScalarScalar.sub
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Sub<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for &'a (curve25519_dalek::edwards::EdwardsPoint)}::sub]:
   Source: 'curve25519-dalek/src/macros.rs', lines 63:12-65:13 -/
def SharedAEdwardsPoint.Insts.CoreOpsArithSubEdwardsPointEdwardsPoint.sub
  (self : edwards.EdwardsPoint) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithSubSharedAEdwardsPointEdwardsPoint.sub
    self rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Sub<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for &'a (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 61:8-66:9 -/
@[reducible]
def SharedAEdwardsPoint.Insts.CoreOpsArithSubEdwardsPointEdwardsPoint :
  core.ops.arith.Sub edwards.EdwardsPoint edwards.EdwardsPoint
  edwards.EdwardsPoint := {
  sub := SharedAEdwardsPoint.Insts.CoreOpsArithSubEdwardsPointEdwardsPoint.sub
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Sub<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for &'a (curve25519_dalek::ristretto::RistrettoPoint)}::sub]:
   Source: 'curve25519-dalek/src/macros.rs', lines 63:12-65:13 -/
def SharedARistrettoPoint.Insts.CoreOpsArithSubRistrettoPointRistrettoPoint.sub
  (self : ristretto.RistrettoPoint) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithSubSharedARistrettoPointRistrettoPoint.sub
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Sub<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for &'a (curve25519_dalek::ristretto::RistrettoPoint)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 61:8-66:9 -/
@[reducible]
def SharedARistrettoPoint.Insts.CoreOpsArithSubRistrettoPointRistrettoPoint :
  core.ops.arith.Sub ristretto.RistrettoPoint ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  sub :=
    SharedARistrettoPoint.Insts.CoreOpsArithSubRistrettoPointRistrettoPoint.sub
}

/-- [curve25519_dalek::scalar::{core::ops::arith::Sub<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for &'a (curve25519_dalek::scalar::Scalar)}::sub]:
   Source: 'curve25519-dalek/src/macros.rs', lines 63:12-65:13 -/
def SharedAScalar.Insts.CoreOpsArithSubScalarScalar.sub
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  Shared0Scalar.Insts.CoreOpsArithSubSharedAScalarScalar.sub self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Sub<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for &'a (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 61:8-66:9 -/
@[reducible]
def SharedAScalar.Insts.CoreOpsArithSubScalarScalar : core.ops.arith.Sub
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  sub := SharedAScalar.Insts.CoreOpsArithSubScalarScalar.sub
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Sub<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 68:8-73:9 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithSubEdwardsPointEdwardsPoint :
  core.ops.arith.Sub edwards.EdwardsPoint edwards.EdwardsPoint
  edwards.EdwardsPoint := {
  sub := edwards.EdwardsPoint.Insts.CoreOpsArithSubEdwardsPointEdwardsPoint.sub
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Sub<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}::sub]:
   Source: 'curve25519-dalek/src/macros.rs', lines 70:12-72:13 -/
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithSubRistrettoPointRistrettoPoint.sub
  (self : ristretto.RistrettoPoint) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithSubSharedARistrettoPointRistrettoPoint.sub
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Sub<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 68:8-73:9 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithSubRistrettoPointRistrettoPoint
  : core.ops.arith.Sub ristretto.RistrettoPoint ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  sub :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithSubRistrettoPointRistrettoPoint.sub
}

/-- [curve25519_dalek::scalar::{core::ops::arith::Sub<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::sub]:
   Source: 'curve25519-dalek/src/macros.rs', lines 70:12-72:13 -/
def scalar.Scalar.Insts.CoreOpsArithSubScalarScalar.sub
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  Shared0Scalar.Insts.CoreOpsArithSubSharedAScalarScalar.sub self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Sub<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 68:8-73:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithSubScalarScalar : core.ops.arith.Sub
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  sub := scalar.Scalar.Insts.CoreOpsArithSubScalarScalar.sub
}

/-- [curve25519_dalek::edwards::{core::ops::arith::SubAssign<curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}::sub_assign]:
   Source: 'curve25519-dalek/src/macros.rs', lines 81:12-83:13 -/
def edwards.EdwardsPoint.Insts.CoreOpsArithSubAssignEdwardsPoint.sub_assign
  (self : edwards.EdwardsPoint) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  edwards.EdwardsPoint.Insts.CoreOpsArithSubAssignSharedAEdwardsPoint.sub_assign
    self rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::SubAssign<curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 80:8-84:9 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithSubAssignEdwardsPoint :
  core.ops.arith.SubAssign edwards.EdwardsPoint edwards.EdwardsPoint := {
  sub_assign :=
    edwards.EdwardsPoint.Insts.CoreOpsArithSubAssignEdwardsPoint.sub_assign
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::SubAssign<&0 (curve25519_dalek::ristretto::RistrettoPoint)> for curve25519_dalek::ristretto::RistrettoPoint}::sub_assign]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 924:4-926:5 -/
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithSubAssignShared0RistrettoPoint.sub_assign
  (self : ristretto.RistrettoPoint) (_rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithSubSharedARistrettoPointRistrettoPoint.sub
    self _rhs

/-- [curve25519_dalek::ristretto::{core::ops::arith::SubAssign<curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}::sub_assign]:
   Source: 'curve25519-dalek/src/macros.rs', lines 81:12-83:13 -/
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithSubAssignRistrettoPoint.sub_assign
  (self : ristretto.RistrettoPoint) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  ristretto.RistrettoPoint.Insts.CoreOpsArithSubAssignShared0RistrettoPoint.sub_assign
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::SubAssign<curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 80:8-84:9 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithSubAssignRistrettoPoint :
  core.ops.arith.SubAssign ristretto.RistrettoPoint ristretto.RistrettoPoint
  := {
  sub_assign :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithSubAssignRistrettoPoint.sub_assign
}

/-- [curve25519_dalek::scalar::{core::ops::arith::SubAssign<&'a (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::scalar::Scalar}::sub_assign]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 353:4-355:5 -/
def scalar.Scalar.Insts.CoreOpsArithSubAssignSharedAScalar.sub_assign
  (self : scalar.Scalar) (_rhs : scalar.Scalar) : Result scalar.Scalar := do
  scalar.Scalar.Insts.CoreOpsArithSubSharedBScalarScalar.sub self _rhs

/-- [curve25519_dalek::scalar::{core::ops::arith::SubAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::sub_assign]:
   Source: 'curve25519-dalek/src/macros.rs', lines 81:12-83:13 -/
def scalar.Scalar.Insts.CoreOpsArithSubAssignScalar.sub_assign
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  scalar.Scalar.Insts.CoreOpsArithSubAssignSharedAScalar.sub_assign self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::SubAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 80:8-84:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithSubAssignScalar : core.ops.arith.SubAssign
  scalar.Scalar scalar.Scalar := {
  sub_assign := scalar.Scalar.Insts.CoreOpsArithSubAssignScalar.sub_assign
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Mul<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 93:12-95:13 -/
def edwards.EdwardsPoint.Insts.CoreOpsArithMulSharedBScalarEdwardsPoint.mul
  (self : edwards.EdwardsPoint) (rhs : scalar.Scalar) :
  Result edwards.EdwardsPoint
  := do
  Shared0EdwardsPoint.Insts.CoreOpsArithMulSharedAScalarEdwardsPoint.mul self
    rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Mul<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 91:8-96:9 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithMulSharedBScalarEdwardsPoint :
  core.ops.arith.Mul edwards.EdwardsPoint scalar.Scalar edwards.EdwardsPoint
  := {
  mul :=
    edwards.EdwardsPoint.Insts.CoreOpsArithMulSharedBScalarEdwardsPoint.mul
}

/-- [curve25519_dalek::edwards::{core::ops::arith::Mul<&'b (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::scalar::Scalar}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 93:12-95:13 -/
def scalar.Scalar.Insts.CoreOpsArithMulSharedBEdwardsPointEdwardsPoint.mul
  (self : scalar.Scalar) (rhs : edwards.EdwardsPoint) :
  Result edwards.EdwardsPoint
  := do
  Shared0Scalar.Insts.CoreOpsArithMulSharedAEdwardsPointEdwardsPoint.mul self
    rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Mul<&'b (curve25519_dalek::edwards::EdwardsPoint), curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 91:8-96:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulSharedBEdwardsPointEdwardsPoint :
  core.ops.arith.Mul scalar.Scalar edwards.EdwardsPoint edwards.EdwardsPoint
  := {
  mul := scalar.Scalar.Insts.CoreOpsArithMulSharedBEdwardsPointEdwardsPoint.mul
}

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::as_bytes]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 706:4-708:5 -/
def scalar.Scalar.as_bytes
  (self : scalar.Scalar) : Result (Array Std.U8 32#usize) := do
  ok self.bytes

/-- [curve25519_dalek::montgomery::differential_add_and_double]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 352:0-390:1 -/
def montgomery.differential_add_and_double
  (P : montgomery.ProjectivePoint) (Q : montgomery.ProjectivePoint)
  (affine_PmQ : backend.serial.u64.field.FieldElement51) :
  Result (montgomery.ProjectivePoint × montgomery.ProjectivePoint)
  := do
  let t0 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      P.U P.W
  let t1 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      P.U P.W
  let t2 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      Q.U Q.W
  let t3 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      Q.U Q.W
  let t4 ← backend.serial.u64.field.FieldElement51.square t0
  let t5 ← backend.serial.u64.field.FieldElement51.square t1
  let t6 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      t4 t5
  let t7 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t0 t3
  let t8 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t1 t2
  let t9 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      t7 t8
  let t10 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      t7 t8
  let t11 ← backend.serial.u64.field.FieldElement51.square t9
  let t12 ← backend.serial.u64.field.FieldElement51.square t10
  let t13 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      backend.serial.u64.constants.APLUS2_OVER_FOUR t6
  let t14 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t4 t5
  let t15 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      t13 t5
  let t16 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      t6 t15
  let t17 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      affine_PmQ t12
  ok ({ U := t14, W := t16 }, { U := t11, W := t17 })

/-- [curve25519_dalek::montgomery::{curve25519_dalek::montgomery::ProjectivePoint}::as_affine]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 331:4-334:5 -/
def montgomery.ProjectivePoint.as_affine
  (self : montgomery.ProjectivePoint) : Result montgomery.MontgomeryPoint := do
  let fe ← field.FieldElement51.invert self.W
  let u ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.U fe
  let a ← backend.serial.u64.field.FieldElement51.to_bytes u
  ok a

/-- [curve25519_dalek::montgomery::{curve25519_dalek::traits::Identity for curve25519_dalek::montgomery::ProjectivePoint}::identity]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 297:4-302:5 -/
def IdentityMontgomeryProjectivePoint.identity
  : Result montgomery.ProjectivePoint := do
  ok
    {
      U := backend.serial.u64.field.FieldElement51.ONE,
      W := backend.serial.u64.field.FieldElement51.ZERO
    }

/-- [curve25519_dalek::montgomery::{core::ops::arith::Mul<&0 (curve25519_dalek::scalar::Scalar), curve25519_dalek::montgomery::MontgomeryPoint> for &1 (curve25519_dalek::montgomery::MontgomeryPoint)}::mul]: loop 0:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 429:14-434:56 -/
def
  Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint.mul_loop
  (affine_u : backend.serial.u64.field.FieldElement51)
  (x0 : montgomery.ProjectivePoint) (x1 : montgomery.ProjectivePoint)
  (scalar_bytes : Array Std.U8 32#usize) (prev_bit : Bool) (i : Std.Isize) :
  Result (montgomery.ProjectivePoint × montgomery.ProjectivePoint × Bool)
  := do
  if i >= 0#isize
  then
    let i1 ← i >>> 3#i32
    let byte_idx ← (↑(IScalar.hcast .Usize i1) : Result Std.Usize)
    let i2 ← (↑(i &&& 7#isize) : Result Std.Isize)
    let bit_idx ← (↑(IScalar.hcast .Usize i2) : Result Std.Usize)
    let i3 ← Array.index_usize scalar_bytes byte_idx
    let i4 ← i3 >>> bit_idx
    let i5 ← (↑(i4 &&& 1#u8) : Result Std.U8)
    let choice ←
      (↑(UScalar.cast_fromBool .U8 (prev_bit != (i5 = 1#u8))) : Result
        Std.U8)
    if choice = 0#u8
    then ok ()
    else massert (choice = 1#u8)
    let c ←
      core.convert.IntoFrom.into subtle.Choice.Insts.CoreConvertFromU8 choice
    let (x01, x11) ←
      montgomery.ProjectivePoint.Insts.SubtleConditionallySelectable.conditional_swap
        x0 x1 c
    let (x02, x12) ← montgomery.differential_add_and_double x01 x11 affine_u
    let i6 ← i - 1#isize
    Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint.mul_loop
      affine_u x02 x12 scalar_bytes (i5 = 1#u8) i6
  else ok (x0, x1, prev_bit)
partial_fixpoint

/-- [curve25519_dalek::montgomery::{core::ops::arith::Mul<&0 (curve25519_dalek::scalar::Scalar), curve25519_dalek::montgomery::MontgomeryPoint> for &1 (curve25519_dalek::montgomery::MontgomeryPoint)}::mul]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 414:4-451:5 -/
def
  Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint.mul
  (self : montgomery.MontgomeryPoint) (scalar : scalar.Scalar) :
  Result montgomery.MontgomeryPoint
  := do
  let affine_u ← backend.serial.u64.field.FieldElement51.from_bytes self
  let x0 ← IdentityMontgomeryProjectivePoint.identity
  let scalar_bytes ← scalar.as_bytes
  let (x01, x1, prev_bit) ←
    Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint.mul_loop
      affine_u x0
      { U := affine_u, W := backend.serial.u64.field.FieldElement51.ONE }
      scalar_bytes false 254#isize
  let i ← (↑(UScalar.cast_fromBool .U8 prev_bit) : Result Std.U8)
  let c ← subtle.Choice.Insts.CoreConvertFromU8.from i
  let (x02, _) ←
    montgomery.ProjectivePoint.Insts.SubtleConditionallySelectable.conditional_swap
      x01 x1 c
  let _ ←
    zeroize.Zeroize.Blanket.zeroize Bool.Insts.ZeroizeDefaultIsZeroes prev_bit
  montgomery.ProjectivePoint.as_affine x02

/-- [curve25519_dalek::montgomery::{core::ops::arith::Mul<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::montgomery::MontgomeryPoint> for curve25519_dalek::montgomery::MontgomeryPoint}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 93:12-95:13 -/
def
  montgomery.MontgomeryPoint.Insts.CoreOpsArithMulSharedBScalarMontgomeryPoint.mul
  (self : montgomery.MontgomeryPoint) (rhs : scalar.Scalar) :
  Result montgomery.MontgomeryPoint
  := do
  Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::montgomery::{core::ops::arith::Mul<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::montgomery::MontgomeryPoint> for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 91:8-96:9 -/
@[reducible]
def
  montgomery.MontgomeryPoint.Insts.CoreOpsArithMulSharedBScalarMontgomeryPoint
  : core.ops.arith.Mul montgomery.MontgomeryPoint scalar.Scalar
  montgomery.MontgomeryPoint := {
  mul :=
    montgomery.MontgomeryPoint.Insts.CoreOpsArithMulSharedBScalarMontgomeryPoint.mul
}

/-- [curve25519_dalek::montgomery::{core::ops::arith::Mul<&0 (curve25519_dalek::montgomery::MontgomeryPoint), curve25519_dalek::montgomery::MontgomeryPoint> for &1 (curve25519_dalek::scalar::Scalar)}::mul]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 463:4-465:5 -/
def
  Shared1Scalar.Insts.CoreOpsArithMulShared0MontgomeryPointMontgomeryPoint.mul
  (self : scalar.Scalar) (point : montgomery.MontgomeryPoint) :
  Result montgomery.MontgomeryPoint
  := do
  Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint.mul
    point self

/-- [curve25519_dalek::montgomery::{core::ops::arith::Mul<&'b (curve25519_dalek::montgomery::MontgomeryPoint), curve25519_dalek::montgomery::MontgomeryPoint> for curve25519_dalek::scalar::Scalar}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 93:12-95:13 -/
def
  scalar.Scalar.Insts.CoreOpsArithMulSharedBMontgomeryPointMontgomeryPoint.mul
  (self : scalar.Scalar) (rhs : montgomery.MontgomeryPoint) :
  Result montgomery.MontgomeryPoint
  := do
  Shared1Scalar.Insts.CoreOpsArithMulShared0MontgomeryPointMontgomeryPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::montgomery::{core::ops::arith::Mul<&'b (curve25519_dalek::montgomery::MontgomeryPoint), curve25519_dalek::montgomery::MontgomeryPoint> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 91:8-96:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulSharedBMontgomeryPointMontgomeryPoint :
  core.ops.arith.Mul scalar.Scalar montgomery.MontgomeryPoint
  montgomery.MontgomeryPoint := {
  mul :=
    scalar.Scalar.Insts.CoreOpsArithMulSharedBMontgomeryPointMontgomeryPoint.mul
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Mul<&'a (curve25519_dalek::scalar::Scalar), curve25519_dalek::ristretto::RistrettoPoint> for &1 (curve25519_dalek::ristretto::RistrettoPoint)}::mul]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 969:4-971:5 -/
def Shared0RistrettoPoint.Insts.CoreOpsArithMulSharedAScalarRistrettoPoint.mul
  (self : ristretto.RistrettoPoint) (scalar : scalar.Scalar) :
  Result ristretto.RistrettoPoint
  := do
  let ep ←
    edwards.EdwardsPoint.Insts.CoreOpsArithMulSharedBScalarEdwardsPoint.mul
      self scalar
  ok ep

/-- [curve25519_dalek::ristretto::{core::ops::arith::Mul<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 93:12-95:13 -/
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithMulSharedBScalarRistrettoPoint.mul
  (self : ristretto.RistrettoPoint) (rhs : scalar.Scalar) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithMulSharedAScalarRistrettoPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Mul<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 91:8-96:9 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithMulSharedBScalarRistrettoPoint :
  core.ops.arith.Mul ristretto.RistrettoPoint scalar.Scalar
  ristretto.RistrettoPoint := {
  mul :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithMulSharedBScalarRistrettoPoint.mul
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Mul<&'a (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for &1 (curve25519_dalek::scalar::Scalar)}::mul]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 978:4-980:5 -/
def Shared0Scalar.Insts.CoreOpsArithMulSharedARistrettoPointRistrettoPoint.mul
  (self : scalar.Scalar) (point : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  let ep ←
    SharedAScalar.Insts.CoreOpsArithMulEdwardsPointEdwardsPoint.mul self point
  ok ep

/-- [curve25519_dalek::ristretto::{core::ops::arith::Mul<&'b (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::scalar::Scalar}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 93:12-95:13 -/
def scalar.Scalar.Insts.CoreOpsArithMulSharedBRistrettoPointRistrettoPoint.mul
  (self : scalar.Scalar) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0Scalar.Insts.CoreOpsArithMulSharedARistrettoPointRistrettoPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Mul<&'b (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 91:8-96:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulSharedBRistrettoPointRistrettoPoint :
  core.ops.arith.Mul scalar.Scalar ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  mul :=
    scalar.Scalar.Insts.CoreOpsArithMulSharedBRistrettoPointRistrettoPoint.mul
}

/-- [curve25519_dalek::scalar::{core::ops::arith::Mul<&'a (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for &1 (curve25519_dalek::scalar::Scalar)}::mul]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 325:4-327:5 -/
def Shared0Scalar.Insts.CoreOpsArithMulSharedAScalarScalar.mul
  (self : scalar.Scalar) (_rhs : scalar.Scalar) : Result scalar.Scalar := do
  let s ← scalar.Scalar.unpack self
  let s1 ← scalar.Scalar.unpack _rhs
  let s2 ← backend.serial.u64.scalar.Scalar52.mul s s1
  scalar.Scalar52.pack s2

/-- [curve25519_dalek::scalar::{core::ops::arith::Mul<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 93:12-95:13 -/
def scalar.Scalar.Insts.CoreOpsArithMulSharedBScalarScalar.mul
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  Shared0Scalar.Insts.CoreOpsArithMulSharedAScalarScalar.mul self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Mul<&'b (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 91:8-96:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulSharedBScalarScalar : core.ops.arith.Mul
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  mul := scalar.Scalar.Insts.CoreOpsArithMulSharedBScalarScalar.mul
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::edwards::EdwardsPoint> for &'a (curve25519_dalek::edwards::EdwardsPoint)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 98:8-103:9 -/
@[reducible]
def SharedAEdwardsPoint.Insts.CoreOpsArithMulScalarEdwardsPoint :
  core.ops.arith.Mul edwards.EdwardsPoint scalar.Scalar edwards.EdwardsPoint
  := {
  mul := SharedAEdwardsPoint.Insts.CoreOpsArithMulScalarEdwardsPoint.mul
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Mul<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for &'a (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 98:8-103:9 -/
@[reducible]
def SharedAScalar.Insts.CoreOpsArithMulEdwardsPointEdwardsPoint :
  core.ops.arith.Mul scalar.Scalar edwards.EdwardsPoint edwards.EdwardsPoint
  := {
  mul := SharedAScalar.Insts.CoreOpsArithMulEdwardsPointEdwardsPoint.mul
}

/-- [curve25519_dalek::montgomery::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::montgomery::MontgomeryPoint> for &'a (curve25519_dalek::montgomery::MontgomeryPoint)}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 100:12-102:13 -/
def SharedAMontgomeryPoint.Insts.CoreOpsArithMulScalarMontgomeryPoint.mul
  (self : montgomery.MontgomeryPoint) (rhs : scalar.Scalar) :
  Result montgomery.MontgomeryPoint
  := do
  Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::montgomery::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::montgomery::MontgomeryPoint> for &'a (curve25519_dalek::montgomery::MontgomeryPoint)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 98:8-103:9 -/
@[reducible]
def SharedAMontgomeryPoint.Insts.CoreOpsArithMulScalarMontgomeryPoint :
  core.ops.arith.Mul montgomery.MontgomeryPoint scalar.Scalar
  montgomery.MontgomeryPoint := {
  mul := SharedAMontgomeryPoint.Insts.CoreOpsArithMulScalarMontgomeryPoint.mul
}

/-- [curve25519_dalek::montgomery::{core::ops::arith::Mul<curve25519_dalek::montgomery::MontgomeryPoint, curve25519_dalek::montgomery::MontgomeryPoint> for &'a (curve25519_dalek::scalar::Scalar)}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 100:12-102:13 -/
def SharedAScalar.Insts.CoreOpsArithMulMontgomeryPointMontgomeryPoint.mul
  (self : scalar.Scalar) (rhs : montgomery.MontgomeryPoint) :
  Result montgomery.MontgomeryPoint
  := do
  Shared1Scalar.Insts.CoreOpsArithMulShared0MontgomeryPointMontgomeryPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::montgomery::{core::ops::arith::Mul<curve25519_dalek::montgomery::MontgomeryPoint, curve25519_dalek::montgomery::MontgomeryPoint> for &'a (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 98:8-103:9 -/
@[reducible]
def SharedAScalar.Insts.CoreOpsArithMulMontgomeryPointMontgomeryPoint :
  core.ops.arith.Mul scalar.Scalar montgomery.MontgomeryPoint
  montgomery.MontgomeryPoint := {
  mul := SharedAScalar.Insts.CoreOpsArithMulMontgomeryPointMontgomeryPoint.mul
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::ristretto::RistrettoPoint> for &'a (curve25519_dalek::ristretto::RistrettoPoint)}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 100:12-102:13 -/
def SharedARistrettoPoint.Insts.CoreOpsArithMulScalarRistrettoPoint.mul
  (self : ristretto.RistrettoPoint) (rhs : scalar.Scalar) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithMulSharedAScalarRistrettoPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::ristretto::RistrettoPoint> for &'a (curve25519_dalek::ristretto::RistrettoPoint)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 98:8-103:9 -/
@[reducible]
def SharedARistrettoPoint.Insts.CoreOpsArithMulScalarRistrettoPoint :
  core.ops.arith.Mul ristretto.RistrettoPoint scalar.Scalar
  ristretto.RistrettoPoint := {
  mul := SharedARistrettoPoint.Insts.CoreOpsArithMulScalarRistrettoPoint.mul
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Mul<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for &'a (curve25519_dalek::scalar::Scalar)}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 100:12-102:13 -/
def SharedAScalar.Insts.CoreOpsArithMulRistrettoPointRistrettoPoint.mul
  (self : scalar.Scalar) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0Scalar.Insts.CoreOpsArithMulSharedARistrettoPointRistrettoPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Mul<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for &'a (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 98:8-103:9 -/
@[reducible]
def SharedAScalar.Insts.CoreOpsArithMulRistrettoPointRistrettoPoint :
  core.ops.arith.Mul scalar.Scalar ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  mul := SharedAScalar.Insts.CoreOpsArithMulRistrettoPointRistrettoPoint.mul
}

/-- [curve25519_dalek::scalar::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for &'a (curve25519_dalek::scalar::Scalar)}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 100:12-102:13 -/
def SharedAScalar.Insts.CoreOpsArithMulScalarScalar.mul
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  Shared0Scalar.Insts.CoreOpsArithMulSharedAScalarScalar.mul self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for &'a (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/macros.rs', lines 98:8-103:9 -/
@[reducible]
def SharedAScalar.Insts.CoreOpsArithMulScalarScalar : core.ops.arith.Mul
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  mul := SharedAScalar.Insts.CoreOpsArithMulScalarScalar.mul
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 105:8-110:9 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithMulScalarEdwardsPoint :
  core.ops.arith.Mul edwards.EdwardsPoint scalar.Scalar edwards.EdwardsPoint
  := {
  mul := edwards.EdwardsPoint.Insts.CoreOpsArithMulScalarEdwardsPoint.mul
}

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::Mul<curve25519_dalek::edwards::EdwardsPoint, curve25519_dalek::edwards::EdwardsPoint> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 105:8-110:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulEdwardsPointEdwardsPoint :
  core.ops.arith.Mul scalar.Scalar edwards.EdwardsPoint edwards.EdwardsPoint
  := {
  mul := scalar.Scalar.Insts.CoreOpsArithMulEdwardsPointEdwardsPoint.mul
}

/-- [curve25519_dalek::montgomery::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::montgomery::MontgomeryPoint> for curve25519_dalek::montgomery::MontgomeryPoint}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 107:12-109:13 -/
def montgomery.MontgomeryPoint.Insts.CoreOpsArithMulScalarMontgomeryPoint.mul
  (self : montgomery.MontgomeryPoint) (rhs : scalar.Scalar) :
  Result montgomery.MontgomeryPoint
  := do
  Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::montgomery::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::montgomery::MontgomeryPoint> for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 105:8-110:9 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.CoreOpsArithMulScalarMontgomeryPoint :
  core.ops.arith.Mul montgomery.MontgomeryPoint scalar.Scalar
  montgomery.MontgomeryPoint := {
  mul :=
    montgomery.MontgomeryPoint.Insts.CoreOpsArithMulScalarMontgomeryPoint.mul
}

/-- [curve25519_dalek::montgomery::{core::ops::arith::Mul<curve25519_dalek::montgomery::MontgomeryPoint, curve25519_dalek::montgomery::MontgomeryPoint> for curve25519_dalek::scalar::Scalar}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 107:12-109:13 -/
def scalar.Scalar.Insts.CoreOpsArithMulMontgomeryPointMontgomeryPoint.mul
  (self : scalar.Scalar) (rhs : montgomery.MontgomeryPoint) :
  Result montgomery.MontgomeryPoint
  := do
  Shared1Scalar.Insts.CoreOpsArithMulShared0MontgomeryPointMontgomeryPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::montgomery::{core::ops::arith::Mul<curve25519_dalek::montgomery::MontgomeryPoint, curve25519_dalek::montgomery::MontgomeryPoint> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 105:8-110:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulMontgomeryPointMontgomeryPoint :
  core.ops.arith.Mul scalar.Scalar montgomery.MontgomeryPoint
  montgomery.MontgomeryPoint := {
  mul := scalar.Scalar.Insts.CoreOpsArithMulMontgomeryPointMontgomeryPoint.mul
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 107:12-109:13 -/
def ristretto.RistrettoPoint.Insts.CoreOpsArithMulScalarRistrettoPoint.mul
  (self : ristretto.RistrettoPoint) (rhs : scalar.Scalar) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithMulSharedAScalarRistrettoPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 105:8-110:9 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithMulScalarRistrettoPoint :
  core.ops.arith.Mul ristretto.RistrettoPoint scalar.Scalar
  ristretto.RistrettoPoint := {
  mul := ristretto.RistrettoPoint.Insts.CoreOpsArithMulScalarRistrettoPoint.mul
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Mul<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::scalar::Scalar}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 107:12-109:13 -/
def scalar.Scalar.Insts.CoreOpsArithMulRistrettoPointRistrettoPoint.mul
  (self : scalar.Scalar) (rhs : ristretto.RistrettoPoint) :
  Result ristretto.RistrettoPoint
  := do
  Shared0Scalar.Insts.CoreOpsArithMulSharedARistrettoPointRistrettoPoint.mul
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Mul<curve25519_dalek::ristretto::RistrettoPoint, curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 105:8-110:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulRistrettoPointRistrettoPoint :
  core.ops.arith.Mul scalar.Scalar ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  mul := scalar.Scalar.Insts.CoreOpsArithMulRistrettoPointRistrettoPoint.mul
}

/-- [curve25519_dalek::scalar::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::mul]:
   Source: 'curve25519-dalek/src/macros.rs', lines 107:12-109:13 -/
def scalar.Scalar.Insts.CoreOpsArithMulScalarScalar.mul
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  Shared0Scalar.Insts.CoreOpsArithMulSharedAScalarScalar.mul self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Mul<curve25519_dalek::scalar::Scalar, curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 105:8-110:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulScalarScalar : core.ops.arith.Mul
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  mul := scalar.Scalar.Insts.CoreOpsArithMulScalarScalar.mul
}

/-- [curve25519_dalek::edwards::{core::ops::arith::MulAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::edwards::EdwardsPoint}::mul_assign]:
   Source: 'curve25519-dalek/src/macros.rs', lines 118:12-120:13 -/
def edwards.EdwardsPoint.Insts.CoreOpsArithMulAssignScalar.mul_assign
  (self : edwards.EdwardsPoint) (rhs : scalar.Scalar) :
  Result edwards.EdwardsPoint
  := do
  edwards.EdwardsPoint.Insts.CoreOpsArithMulAssignSharedAScalar.mul_assign self
    rhs

/-- Trait implementation: [curve25519_dalek::edwards::{core::ops::arith::MulAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::edwards::EdwardsPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 117:8-121:9 -/
@[reducible]
def edwards.EdwardsPoint.Insts.CoreOpsArithMulAssignScalar :
  core.ops.arith.MulAssign edwards.EdwardsPoint scalar.Scalar := {
  mul_assign :=
    edwards.EdwardsPoint.Insts.CoreOpsArithMulAssignScalar.mul_assign
}

/-- [curve25519_dalek::montgomery::{core::ops::arith::MulAssign<&0 (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::montgomery::MontgomeryPoint}::mul_assign]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 455:4-457:5 -/
def
  montgomery.MontgomeryPoint.Insts.CoreOpsArithMulAssignShared0Scalar.mul_assign
  (self : montgomery.MontgomeryPoint) (scalar : scalar.Scalar) :
  Result montgomery.MontgomeryPoint
  := do
  Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint.mul
    self scalar

/-- [curve25519_dalek::montgomery::{core::ops::arith::MulAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::montgomery::MontgomeryPoint}::mul_assign]:
   Source: 'curve25519-dalek/src/macros.rs', lines 118:12-120:13 -/
def montgomery.MontgomeryPoint.Insts.CoreOpsArithMulAssignScalar.mul_assign
  (self : montgomery.MontgomeryPoint) (rhs : scalar.Scalar) :
  Result montgomery.MontgomeryPoint
  := do
  montgomery.MontgomeryPoint.Insts.CoreOpsArithMulAssignShared0Scalar.mul_assign
    self rhs

/-- Trait implementation: [curve25519_dalek::montgomery::{core::ops::arith::MulAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 117:8-121:9 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.CoreOpsArithMulAssignScalar :
  core.ops.arith.MulAssign montgomery.MontgomeryPoint scalar.Scalar := {
  mul_assign :=
    montgomery.MontgomeryPoint.Insts.CoreOpsArithMulAssignScalar.mul_assign
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::MulAssign<&'a (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::ristretto::RistrettoPoint}::mul_assign]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 960:4-963:5 -/
def
  ristretto.RistrettoPoint.Insts.CoreOpsArithMulAssignSharedAScalar.mul_assign
  (self : ristretto.RistrettoPoint) (scalar : scalar.Scalar) :
  Result ristretto.RistrettoPoint
  := do
  Shared0RistrettoPoint.Insts.CoreOpsArithMulSharedAScalarRistrettoPoint.mul
    self scalar

/-- [curve25519_dalek::ristretto::{core::ops::arith::MulAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::ristretto::RistrettoPoint}::mul_assign]:
   Source: 'curve25519-dalek/src/macros.rs', lines 118:12-120:13 -/
def ristretto.RistrettoPoint.Insts.CoreOpsArithMulAssignScalar.mul_assign
  (self : ristretto.RistrettoPoint) (rhs : scalar.Scalar) :
  Result ristretto.RistrettoPoint
  := do
  ristretto.RistrettoPoint.Insts.CoreOpsArithMulAssignSharedAScalar.mul_assign
    self rhs

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::MulAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/macros.rs', lines 117:8-121:9 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithMulAssignScalar :
  core.ops.arith.MulAssign ristretto.RistrettoPoint scalar.Scalar := {
  mul_assign :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithMulAssignScalar.mul_assign
}

/-- [curve25519_dalek::scalar::{core::ops::arith::MulAssign<&'a (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::scalar::Scalar}::mul_assign]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 316:4-318:5 -/
def scalar.Scalar.Insts.CoreOpsArithMulAssignSharedAScalar.mul_assign
  (self : scalar.Scalar) (_rhs : scalar.Scalar) : Result scalar.Scalar := do
  let s ← scalar.Scalar.unpack self
  let s1 ← scalar.Scalar.unpack _rhs
  let s2 ← backend.serial.u64.scalar.Scalar52.mul s s1
  scalar.Scalar52.pack s2

/-- [curve25519_dalek::scalar::{core::ops::arith::MulAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::mul_assign]:
   Source: 'curve25519-dalek/src/macros.rs', lines 118:12-120:13 -/
def scalar.Scalar.Insts.CoreOpsArithMulAssignScalar.mul_assign
  (self : scalar.Scalar) (rhs : scalar.Scalar) : Result scalar.Scalar := do
  scalar.Scalar.Insts.CoreOpsArithMulAssignSharedAScalar.mul_assign self rhs

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::MulAssign<curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/macros.rs', lines 117:8-121:9 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulAssignScalar : core.ops.arith.MulAssign
  scalar.Scalar scalar.Scalar := {
  mul_assign := scalar.Scalar.Insts.CoreOpsArithMulAssignScalar.mul_assign
}

/-- [curve25519_dalek::montgomery::{core::clone::Clone for curve25519_dalek::montgomery::MontgomeryPoint}::clone]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 73:15-73:20 -/
def montgomery.MontgomeryPoint.Insts.CoreCloneClone.clone
  (self : montgomery.MontgomeryPoint) : Result montgomery.MontgomeryPoint := do
  ok self

/-- Trait implementation: [curve25519_dalek::montgomery::{core::clone::Clone for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 73:15-73:20 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.CoreCloneClone : core.clone.Clone
  montgomery.MontgomeryPoint := {
  clone := montgomery.MontgomeryPoint.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::montgomery::{core::marker::Copy for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 73:9-73:13 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.CoreMarkerCopy : core.marker.Copy
  montgomery.MontgomeryPoint := {
  cloneInst := montgomery.MontgomeryPoint.Insts.CoreCloneClone
}

/-- [curve25519_dalek::montgomery::{core::default::Default for curve25519_dalek::montgomery::MontgomeryPoint}::default]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 73:29-73:36 -/
def montgomery.MontgomeryPoint.Insts.CoreDefaultDefault.default
  : Result montgomery.MontgomeryPoint := do
  let a ← core.default.DefaultArray.default 32#usize core.default.DefaultU8
  ok a

/-- Trait implementation: [curve25519_dalek::montgomery::{core::default::Default for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 73:29-73:36 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.CoreDefaultDefault : core.default.Default
  montgomery.MontgomeryPoint := {
  default := montgomery.MontgomeryPoint.Insts.CoreDefaultDefault.default
}

/-- [curve25519_dalek::montgomery::{subtle::ConstantTimeEq for curve25519_dalek::montgomery::MontgomeryPoint}::ct_eq]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 79:4-84:5 -/
def montgomery.MontgomeryPoint.Insts.SubtleConstantTimeEq.ct_eq
  (self : montgomery.MontgomeryPoint) (other : montgomery.MontgomeryPoint) :
  Result subtle.Choice
  := do
  let self_fe ← backend.serial.u64.field.FieldElement51.from_bytes self
  let other_fe ← backend.serial.u64.field.FieldElement51.from_bytes other
  backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
    self_fe other_fe

/-- Trait implementation: [curve25519_dalek::montgomery::{subtle::ConstantTimeEq for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 78:0-85:1 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.SubtleConstantTimeEq :
  subtle.ConstantTimeEq montgomery.MontgomeryPoint := {
  ct_eq := montgomery.MontgomeryPoint.Insts.SubtleConstantTimeEq.ct_eq
}

/-- [curve25519_dalek::montgomery::{subtle::ConditionallySelectable for curve25519_dalek::montgomery::MontgomeryPoint}::conditional_select]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 88:4-90:5 -/
def
  montgomery.MontgomeryPoint.Insts.SubtleConditionallySelectable.conditional_select
  (a : montgomery.MontgomeryPoint) (b : montgomery.MontgomeryPoint)
  (choice : subtle.Choice) :
  Result montgomery.MontgomeryPoint
  := do
  let a1 ←
    Array.Insts.SubtleConditionallySelectable.conditional_select
      U8.Insts.SubtleConditionallySelectable a b choice
  ok a1

/-- Trait implementation: [curve25519_dalek::montgomery::{subtle::ConditionallySelectable for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 87:0-91:1 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.SubtleConditionallySelectable :
  subtle.ConditionallySelectable montgomery.MontgomeryPoint := {
  coremarkerCopyInst := montgomery.MontgomeryPoint.Insts.CoreMarkerCopy
  conditional_select :=
    montgomery.MontgomeryPoint.Insts.SubtleConditionallySelectable.conditional_select
  conditional_assign :=
    montgomery.MontgomeryPoint.Insts.SubtleConditionallySelectable.conditional_assign
  conditional_swap :=
    montgomery.MontgomeryPoint.Insts.SubtleConditionallySelectable.conditional_swap
}

/-- [curve25519_dalek::montgomery::{core::cmp::PartialEq<curve25519_dalek::montgomery::MontgomeryPoint> for curve25519_dalek::montgomery::MontgomeryPoint}::eq]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 94:4-96:5 -/
def montgomery.MontgomeryPoint.Insts.CoreCmpPartialEqMontgomeryPoint.eq
  (self : montgomery.MontgomeryPoint) (other : montgomery.MontgomeryPoint) :
  Result Bool
  := do
  let c ←
    montgomery.MontgomeryPoint.Insts.SubtleConstantTimeEq.ct_eq self other
  core.convert.IntoFrom.into Bool.Insts.CoreConvertFromChoice c

/-- Trait implementation: [curve25519_dalek::montgomery::{core::cmp::PartialEq<curve25519_dalek::montgomery::MontgomeryPoint> for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 93:0-97:1 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.CoreCmpPartialEqMontgomeryPoint :
  core.cmp.PartialEq montgomery.MontgomeryPoint montgomery.MontgomeryPoint := {
  eq := montgomery.MontgomeryPoint.Insts.CoreCmpPartialEqMontgomeryPoint.eq
  ne := montgomery.MontgomeryPoint.Insts.CoreCmpPartialEqMontgomeryPoint.ne
}

/-- Trait implementation: [curve25519_dalek::montgomery::{core::cmp::Eq for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 99:0-99:30 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.CoreCmpEq : core.cmp.Eq
  montgomery.MontgomeryPoint := {
  partialEqInst :=
    montgomery.MontgomeryPoint.Insts.CoreCmpPartialEqMontgomeryPoint
  assert_receiver_is_total_eq :=
    montgomery.MontgomeryPoint.Insts.CoreCmpEq.assert_receiver_is_total_eq
}

/-- [curve25519_dalek::montgomery::{curve25519_dalek::traits::Identity for curve25519_dalek::montgomery::MontgomeryPoint}::identity]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 114:4-116:5 -/
def montgomery.MontgomeryPoint.Insts.Curve25519_dalekTraitsIdentity.identity
  : Result montgomery.MontgomeryPoint := do
  let a := Array.repeat 32#usize 0#u8
  ok a

/-- Trait implementation: [curve25519_dalek::montgomery::{curve25519_dalek::traits::Identity for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 112:0-117:1 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.Curve25519_dalekTraitsIdentity :
  traits.Identity montgomery.MontgomeryPoint := {
  identity :=
    montgomery.MontgomeryPoint.Insts.Curve25519_dalekTraitsIdentity.identity
}

/-- [curve25519_dalek::montgomery::{zeroize::Zeroize for curve25519_dalek::montgomery::MontgomeryPoint}::zeroize]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 121:4-123:5 -/
def montgomery.MontgomeryPoint.Insts.ZeroizeZeroize.zeroize
  (self : montgomery.MontgomeryPoint) : Result montgomery.MontgomeryPoint := do
  let a ←
    Array.Insts.ZeroizeZeroize.zeroize (zeroize.Zeroize.Blanket
      U8.Insts.ZeroizeDefaultIsZeroes) self
  ok a

/-- Trait implementation: [curve25519_dalek::montgomery::{zeroize::Zeroize for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 120:0-124:1 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.ZeroizeZeroize : zeroize.Zeroize
  montgomery.MontgomeryPoint := {
  zeroize := montgomery.MontgomeryPoint.Insts.ZeroizeZeroize.zeroize
}

/-- [curve25519_dalek::montgomery::{curve25519_dalek::montgomery::MontgomeryPoint}::mul_base]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 128:4-130:5 -/
noncomputable def montgomery.MontgomeryPoint.mul_base
  (scalar : scalar.Scalar) : Result montgomery.MontgomeryPoint := do
  let ep ← edwards.EdwardsPoint.mul_base scalar
  edwards.EdwardsPoint.to_montgomery ep

/-- [curve25519_dalek::montgomery::{curve25519_dalek::montgomery::MontgomeryPoint}::mul_clamped]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 134:4-146:5 -/
noncomputable def montgomery.MontgomeryPoint.mul_clamped
  (self : montgomery.MontgomeryPoint) (bytes : Array Std.U8 32#usize) :
  Result montgomery.MontgomeryPoint
  := do
  let a ← scalar.clamp_integer bytes
  scalar.Scalar.Insts.CoreOpsArithMulMontgomeryPointMontgomeryPoint.mul
    { bytes := a } self

/-- [curve25519_dalek::montgomery::{curve25519_dalek::montgomery::MontgomeryPoint}::mul_base_clamped]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 150:4-158:5 -/
noncomputable def montgomery.MontgomeryPoint.mul_base_clamped
  (bytes : Array Std.U8 32#usize) : Result montgomery.MontgomeryPoint := do
  let a ← scalar.clamp_integer bytes
  montgomery.MontgomeryPoint.mul_base { bytes := a }

/-- [curve25519_dalek::montgomery::{curve25519_dalek::montgomery::MontgomeryPoint}::as_bytes]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 199:4-201:5 -/
def montgomery.MontgomeryPoint.as_bytes
  (self : montgomery.MontgomeryPoint) : Result (Array Std.U8 32#usize) := do
  ok self

/-- [curve25519_dalek::montgomery::{curve25519_dalek::montgomery::MontgomeryPoint}::to_bytes]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 204:4-206:5 -/
def montgomery.MontgomeryPoint.to_bytes
  (self : montgomery.MontgomeryPoint) : Result (Array Std.U8 32#usize) := do
  ok self

/-- [curve25519_dalek::montgomery::{curve25519_dalek::montgomery::MontgomeryPoint}::to_edwards]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 224:4-253:5 -/
noncomputable def montgomery.MontgomeryPoint.to_edwards
  (self : montgomery.MontgomeryPoint) (sign : Std.U8) :
  Result (Option edwards.EdwardsPoint)
  := do
  let u ← backend.serial.u64.field.FieldElement51.from_bytes self
  let b ←
    backend.serial.u64.field.FieldElement51.Insts.CoreCmpPartialEqFieldElement51.eq
      u backend.serial.u64.field.FieldElement51.MINUS_ONE
  if b
  then ok none
  else
    let fe ←
      Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
        u backend.serial.u64.field.FieldElement51.ONE
    let fe1 ←
      Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
        u backend.serial.u64.field.FieldElement51.ONE
    let fe2 ← field.FieldElement51.invert fe1
    let y ←
      Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
        fe fe2
    let y_bytes ← backend.serial.u64.field.FieldElement51.to_bytes y
    let i ← sign <<< 7#i32
    let i1 ← Array.index_usize y_bytes 31#usize
    let i2 ← (↑(i1 ^^^ i) : Result Std.U8)
    let y_bytes1 ← Array.update y_bytes 31#usize i2
    edwards.CompressedEdwardsY.decompress y_bytes1

/-- [curve25519_dalek::montgomery::elligator_encode]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 263:0-284:1 -/
noncomputable def montgomery.elligator_encode
  (r_0 : backend.serial.u64.field.FieldElement51) :
  Result (montgomery.MontgomeryPoint × subtle.Choice)
  := do
  let fe ← backend.serial.u64.field.FieldElement51.square2 r_0
  let d_1 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      backend.serial.u64.field.FieldElement51.ONE fe
  let fe1 ← field.FieldElement51.invert d_1
  let d ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      backend.serial.u64.constants.MONTGOMERY_A_NEG fe1
  let d_sq ← backend.serial.u64.field.FieldElement51.square d
  let au ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      backend.serial.u64.constants.MONTGOMERY_A d
  let fe2 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      d_sq au
  let inner ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      fe2 backend.serial.u64.field.FieldElement51.ONE
  let eps ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      d inner
  let p ←
    field.FieldElement51.sqrt_ratio_i eps
      backend.serial.u64.field.FieldElement51.ONE
  let (eps_is_sq, _) := p
  let Atemp ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      backend.serial.u64.constants.MONTGOMERY_A
      backend.serial.u64.field.FieldElement51.ZERO eps_is_sq
  let u ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      d Atemp
  let u_neg ← Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg u
  let c ← subtle.Choice.Insts.CoreOpsBitNotChoice.not eps_is_sq
  let u1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      u u_neg c
  let a ← backend.serial.u64.field.FieldElement51.to_bytes u1
  ok (a, eps_is_sq)

/-- [curve25519_dalek::montgomery::{core::clone::Clone for curve25519_dalek::montgomery::ProjectivePoint}::clone]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 289:15-289:20 -/
def montgomery.ProjectivePoint.Insts.CoreCloneClone.clone
  (self : montgomery.ProjectivePoint) : Result montgomery.ProjectivePoint := do
  ok self

/-- Trait implementation: [curve25519_dalek::montgomery::{core::clone::Clone for curve25519_dalek::montgomery::ProjectivePoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 289:15-289:20 -/
@[reducible]
def montgomery.ProjectivePoint.Insts.CoreCloneClone : core.clone.Clone
  montgomery.ProjectivePoint := {
  clone := montgomery.ProjectivePoint.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::montgomery::{core::marker::Copy for curve25519_dalek::montgomery::ProjectivePoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 289:9-289:13 -/
@[reducible]
def montgomery.ProjectivePoint.Insts.CoreMarkerCopy : core.marker.Copy
  montgomery.ProjectivePoint := {
  cloneInst := montgomery.ProjectivePoint.Insts.CoreCloneClone
}

/-- Trait implementation: [curve25519_dalek::montgomery::{curve25519_dalek::traits::Identity for curve25519_dalek::montgomery::ProjectivePoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 296:0-303:1 -/
@[reducible]
def IdentityMontgomeryProjectivePoint : traits.Identity
  montgomery.ProjectivePoint := {
  identity := IdentityMontgomeryProjectivePoint.identity
}

/-- [curve25519_dalek::montgomery::{core::default::Default for curve25519_dalek::montgomery::ProjectivePoint}::default]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 306:4-308:5 -/
def montgomery.ProjectivePoint.Insts.CoreDefaultDefault.default
  : Result montgomery.ProjectivePoint := do
  IdentityMontgomeryProjectivePoint.identity

/-- Trait implementation: [curve25519_dalek::montgomery::{core::default::Default for curve25519_dalek::montgomery::ProjectivePoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 305:0-309:1 -/
@[reducible]
def montgomery.ProjectivePoint.Insts.CoreDefaultDefault : core.default.Default
  montgomery.ProjectivePoint := {
  default := montgomery.ProjectivePoint.Insts.CoreDefaultDefault.default
}

/-- [curve25519_dalek::montgomery::{subtle::ConditionallySelectable for curve25519_dalek::montgomery::ProjectivePoint}::conditional_select]:
   Source: 'curve25519-dalek/src/montgomery.rs', lines 312:4-321:5 -/
def
  montgomery.ProjectivePoint.Insts.SubtleConditionallySelectable.conditional_select
  (a : montgomery.ProjectivePoint) (b : montgomery.ProjectivePoint)
  (choice : subtle.Choice) :
  Result montgomery.ProjectivePoint
  := do
  let fe ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.U b.U choice
  let fe1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_select
      a.W b.W choice
  ok { U := fe, W := fe1 }

/-- Trait implementation: [curve25519_dalek::montgomery::{subtle::ConditionallySelectable for curve25519_dalek::montgomery::ProjectivePoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 311:0-322:1 -/
@[reducible]
def montgomery.ProjectivePoint.Insts.SubtleConditionallySelectable :
  subtle.ConditionallySelectable montgomery.ProjectivePoint := {
  coremarkerCopyInst := montgomery.ProjectivePoint.Insts.CoreMarkerCopy
  conditional_select :=
    montgomery.ProjectivePoint.Insts.SubtleConditionallySelectable.conditional_select
  conditional_assign :=
    montgomery.ProjectivePoint.Insts.SubtleConditionallySelectable.conditional_assign
  conditional_swap :=
    montgomery.ProjectivePoint.Insts.SubtleConditionallySelectable.conditional_swap
}

/-- Trait implementation: [curve25519_dalek::montgomery::{core::ops::arith::Mul<&0 (curve25519_dalek::scalar::Scalar), curve25519_dalek::montgomery::MontgomeryPoint> for &1 (curve25519_dalek::montgomery::MontgomeryPoint)}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 410:0-452:1 -/
@[reducible]
def Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint :
  core.ops.arith.Mul montgomery.MontgomeryPoint scalar.Scalar
  montgomery.MontgomeryPoint := {
  mul :=
    Shared1MontgomeryPoint.Insts.CoreOpsArithMulShared0ScalarMontgomeryPoint.mul
}

/-- Trait implementation: [curve25519_dalek::montgomery::{core::ops::arith::MulAssign<&0 (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::montgomery::MontgomeryPoint}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 454:0-458:1 -/
@[reducible]
def montgomery.MontgomeryPoint.Insts.CoreOpsArithMulAssignShared0Scalar :
  core.ops.arith.MulAssign montgomery.MontgomeryPoint scalar.Scalar := {
  mul_assign :=
    montgomery.MontgomeryPoint.Insts.CoreOpsArithMulAssignShared0Scalar.mul_assign
}

/-- Trait implementation: [curve25519_dalek::montgomery::{core::ops::arith::Mul<&0 (curve25519_dalek::montgomery::MontgomeryPoint), curve25519_dalek::montgomery::MontgomeryPoint> for &1 (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/montgomery.rs', lines 460:0-466:1 -/
@[reducible]
def Shared1Scalar.Insts.CoreOpsArithMulShared0MontgomeryPointMontgomeryPoint :
  core.ops.arith.Mul scalar.Scalar montgomery.MontgomeryPoint
  montgomery.MontgomeryPoint := {
  mul :=
    Shared1Scalar.Insts.CoreOpsArithMulShared0MontgomeryPointMontgomeryPoint.mul
}

/-- [curve25519_dalek::ristretto::{core::clone::Clone for curve25519_dalek::ristretto::CompressedRistretto}::clone]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 219:15-219:20 -/
def ristretto.CompressedRistretto.Insts.CoreCloneClone.clone
  (self : ristretto.CompressedRistretto) :
  Result ristretto.CompressedRistretto
  := do
  ok self

/-- Trait implementation: [curve25519_dalek::ristretto::{core::clone::Clone for curve25519_dalek::ristretto::CompressedRistretto}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 219:15-219:20 -/
@[reducible]
def ristretto.CompressedRistretto.Insts.CoreCloneClone : core.clone.Clone
  ristretto.CompressedRistretto := {
  clone := ristretto.CompressedRistretto.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::marker::Copy for curve25519_dalek::ristretto::CompressedRistretto}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 219:9-219:13 -/
@[reducible]
def ristretto.CompressedRistretto.Insts.CoreMarkerCopy : core.marker.Copy
  ristretto.CompressedRistretto := {
  cloneInst := ristretto.CompressedRistretto.Insts.CoreCloneClone
}

/-- [curve25519_dalek::ristretto::{core::cmp::PartialEq<curve25519_dalek::ristretto::CompressedRistretto> for curve25519_dalek::ristretto::CompressedRistretto}::eq]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 219:26-219:35 -/
def ristretto.CompressedRistretto.Insts.CoreCmpPartialEqCompressedRistretto.eq
  (self : ristretto.CompressedRistretto)
  (other : ristretto.CompressedRistretto) :
  Result Bool
  := do
  core.array.equality.PartialEqArray.eq core.cmp.PartialEqU8 self other

/-- Trait implementation: [curve25519_dalek::ristretto::{core::cmp::PartialEq<curve25519_dalek::ristretto::CompressedRistretto> for curve25519_dalek::ristretto::CompressedRistretto}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 219:26-219:35 -/
@[reducible]
def ristretto.CompressedRistretto.Insts.CoreCmpPartialEqCompressedRistretto :
  core.cmp.PartialEq ristretto.CompressedRistretto
  ristretto.CompressedRistretto := {
  eq :=
    ristretto.CompressedRistretto.Insts.CoreCmpPartialEqCompressedRistretto.eq
  ne :=
    ristretto.CompressedRistretto.Insts.CoreCmpPartialEqCompressedRistretto.ne
}

/-- [curve25519_dalek::ristretto::{core::cmp::Eq for curve25519_dalek::ristretto::CompressedRistretto}::assert_receiver_is_total_eq]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 219:22-219:24 -/
def ristretto.CompressedRistretto.Insts.CoreCmpEq.assert_receiver_is_total_eq
  (self : ristretto.CompressedRistretto) : Result Unit := do
  ok ()

/-- Trait implementation: [curve25519_dalek::ristretto::{core::cmp::Eq for curve25519_dalek::ristretto::CompressedRistretto}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 219:22-219:24 -/
@[reducible]
def ristretto.CompressedRistretto.Insts.CoreCmpEq : core.cmp.Eq
  ristretto.CompressedRistretto := {
  partialEqInst :=
    ristretto.CompressedRistretto.Insts.CoreCmpPartialEqCompressedRistretto
  assert_receiver_is_total_eq :=
    ristretto.CompressedRistretto.Insts.CoreCmpEq.assert_receiver_is_total_eq
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::marker::StructuralPartialEq for curve25519_dalek::ristretto::CompressedRistretto}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 219:26-219:35 -/
@[reducible]
def ristretto.CompressedRistretto.Insts.CoreMarkerStructuralPartialEq :
  core.marker.StructuralPartialEq ristretto.CompressedRistretto := {
}

/-- [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::CompressedRistretto}::as_bytes]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 235:4-237:5 -/
def ristretto.CompressedRistretto.as_bytes
  (self : ristretto.CompressedRistretto) : Result (Array Std.U8 32#usize) := do
  ok self

/-- [curve25519_dalek::ristretto::{subtle::ConstantTimeEq for curve25519_dalek::ristretto::CompressedRistretto}::ct_eq]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 223:4-225:5 -/
def ristretto.CompressedRistretto.Insts.SubtleConstantTimeEq.ct_eq
  (self : ristretto.CompressedRistretto)
  (other : ristretto.CompressedRistretto) :
  Result subtle.Choice
  := do
  let a ← ristretto.CompressedRistretto.as_bytes self
  let s ← (↑(Array.to_slice a) : Result (Slice Std.U8))
  let a1 ← ristretto.CompressedRistretto.as_bytes other
  let s1 ← (↑(Array.to_slice a1) : Result (Slice Std.U8))
  Slice.Insts.SubtleConstantTimeEq.ct_eq U8.Insts.SubtleConstantTimeEq s s1

/-- Trait implementation: [curve25519_dalek::ristretto::{subtle::ConstantTimeEq for curve25519_dalek::ristretto::CompressedRistretto}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 222:0-226:1 -/
@[reducible]
def ristretto.CompressedRistretto.Insts.SubtleConstantTimeEq :
  subtle.ConstantTimeEq ristretto.CompressedRistretto := {
  ct_eq := ristretto.CompressedRistretto.Insts.SubtleConstantTimeEq.ct_eq
}

/-- [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::CompressedRistretto}::to_bytes]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 230:4-232:5 -/
def ristretto.CompressedRistretto.to_bytes
  (self : ristretto.CompressedRistretto) : Result (Array Std.U8 32#usize) := do
  ok self

/-- [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::CompressedRistretto}::from_slice::{core::ops::function::FnOnce<([u8; 32usize]), curve25519_dalek::ristretto::CompressedRistretto> for curve25519_dalek::ristretto::{curve25519_dalek::ristretto::CompressedRistretto}::from_slice::closure}::call_once]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 247:29-247:55 -/
def
  ristretto.CompressedRistretto.from_slice.closure.Insts.CoreOpsFunctionFnOnceTupleArrayU832CompressedRistretto.call_once
  (c : ristretto.CompressedRistretto.from_slice.closure)
  (tupled_args : Array Std.U8 32#usize) :
  Result ristretto.CompressedRistretto
  := do
  ok tupled_args

/-- Trait implementation: [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::CompressedRistretto}::from_slice::{core::ops::function::FnOnce<([u8; 32usize]), curve25519_dalek::ristretto::CompressedRistretto> for curve25519_dalek::ristretto::{curve25519_dalek::ristretto::CompressedRistretto}::from_slice::closure}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 247:29-247:55 -/
@[reducible]
def
  ristretto.CompressedRistretto.from_slice.closure.Insts.CoreOpsFunctionFnOnceTupleArrayU832CompressedRistretto
  : core.ops.function.FnOnce ristretto.CompressedRistretto.from_slice.closure
  (Array Std.U8 32#usize) ristretto.CompressedRistretto := {
  call_once :=
    ristretto.CompressedRistretto.from_slice.closure.Insts.CoreOpsFunctionFnOnceTupleArrayU832CompressedRistretto.call_once
}

/-- [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::CompressedRistretto}::from_slice]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 245:4-248:5 -/
def ristretto.CompressedRistretto.from_slice
  (bytes : Slice Std.U8) :
  Result (core.result.Result ristretto.CompressedRistretto
    core.array.TryFromSliceError)
  := do
  let r ←
    core.convert.TryInto.Blanket.try_into
      (Array.Insts.CoreConvertTryFromShared0SliceTryFromSliceError 32#usize
      core.marker.CopyU8) bytes
  core.result.Result.map
    ristretto.CompressedRistretto.from_slice.closure.Insts.CoreOpsFunctionFnOnceTupleArrayU832CompressedRistretto
    r ()

/-- [curve25519_dalek::ristretto::decompress::step_2]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 297:4-342:5 -/
noncomputable def ristretto.decompress.step_2
  (s : backend.serial.u64.field.FieldElement51) :
  Result (subtle.Choice × subtle.Choice × subtle.Choice ×
    ristretto.RistrettoPoint)
  := do
  let ss ← backend.serial.u64.field.FieldElement51.square s
  let u1 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      backend.serial.u64.field.FieldElement51.ONE ss
  let u2 ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      backend.serial.u64.field.FieldElement51.ONE ss
  let u2_sqr ← backend.serial.u64.field.FieldElement51.square u2
  let neg_d ←
    Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg
      backend.serial.u64.constants.EDWARDS_D
  let u1_sq ← backend.serial.u64.field.FieldElement51.square u1
  let neg_d_u1_sq ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      neg_d u1_sq
  let v ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      neg_d_u1_sq u2_sqr
  let v_u2_sqr ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      v u2_sqr
  let (ok1, I) ← field.FieldElement51.invsqrt v_u2_sqr
  let Dx ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      I u2
  let Dx_v ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      Dx v
  let Dy ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      I Dx_v
  let s_plus_s ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      s s
  let x ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      s_plus_s Dx
  let x_neg ← field.FieldElement51.is_negative x
  let x_negated ←
    Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg x
  let x1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      x x_negated x_neg
  let y ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      u1 Dy
  let t ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      x1 y
  let c ← field.FieldElement51.is_negative t
  let c1 ← field.FieldElement51.is_zero y
  ok (ok1, c, c1,
    { X := x1, Y := y, Z := backend.serial.u64.field.FieldElement51.ONE, T := t
    })

/-- [curve25519_dalek::ristretto::decompress::step_1]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 277:4-295:5 -/
noncomputable def ristretto.decompress.step_1
  (repr : ristretto.CompressedRistretto) :
  Result (subtle.Choice × subtle.Choice ×
    backend.serial.u64.field.FieldElement51)
  := do
  let a ← ristretto.CompressedRistretto.as_bytes repr
  let s ← backend.serial.u64.field.FieldElement51.from_bytes a
  let s_bytes_check ← backend.serial.u64.field.FieldElement51.to_bytes s
  let s1 ←
    core.array.Array.index (core.ops.index.IndexSlice
      (core.ops.range.RangeFull.Insts.CoreSliceIndexSliceIndexSliceSlice
      Std.U8)) s_bytes_check ()
  let s2 ← (↑(Array.to_slice a) : Result (Slice Std.U8))
  let s_encoding_is_canonical ←
    Slice.Insts.SubtleConstantTimeEq.ct_eq U8.Insts.SubtleConstantTimeEq s1 s2
  let s_is_negative ← field.FieldElement51.is_negative s
  ok (s_encoding_is_canonical, s_is_negative, s)

/-- [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::CompressedRistretto}::decompress]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 257:4-271:5 -/
noncomputable def ristretto.CompressedRistretto.decompress
  (self : ristretto.CompressedRistretto) :
  Result (Option ristretto.RistrettoPoint)
  := do
  let (s_encoding_is_canonical, s_is_negative, s) ←
    ristretto.decompress.step_1 self
  let c ← subtle.Choice.Insts.CoreOpsBitNotChoice.not s_encoding_is_canonical
  let c1 ←
    subtle.Choice.Insts.CoreOpsBitBitOrChoiceChoice.bitor c s_is_negative
  let b ← core.convert.IntoFrom.into Bool.Insts.CoreConvertFromChoice c1
  if b
  then ok none
  else
    let (ok1, t_is_negative, y_is_zero, res) ← ristretto.decompress.step_2 s
    let c2 ← subtle.Choice.Insts.CoreOpsBitNotChoice.not ok1
    let c3 ←
      subtle.Choice.Insts.CoreOpsBitBitOrChoiceChoice.bitor c2 t_is_negative
    let c4 ←
      subtle.Choice.Insts.CoreOpsBitBitOrChoiceChoice.bitor c3 y_is_zero
    let b1 ← core.convert.IntoFrom.into Bool.Insts.CoreConvertFromChoice c4
    if b1
    then ok none
    else ok (some res)

/-- [curve25519_dalek::ristretto::{curve25519_dalek::traits::Identity for curve25519_dalek::ristretto::CompressedRistretto}::identity]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 346:4-348:5 -/
def ristretto.CompressedRistretto.Insts.Curve25519_dalekTraitsIdentity.identity
  : Result ristretto.CompressedRistretto := do
  let a := Array.repeat 32#usize 0#u8
  ok a

/-- Trait implementation: [curve25519_dalek::ristretto::{curve25519_dalek::traits::Identity for curve25519_dalek::ristretto::CompressedRistretto}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 345:0-349:1 -/
@[reducible]
def ristretto.CompressedRistretto.Insts.Curve25519_dalekTraitsIdentity :
  traits.Identity ristretto.CompressedRistretto := {
  identity :=
    ristretto.CompressedRistretto.Insts.Curve25519_dalekTraitsIdentity.identity
}

/-- [curve25519_dalek::ristretto::{core::default::Default for curve25519_dalek::ristretto::CompressedRistretto}::default]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 352:4-354:5 -/
def ristretto.CompressedRistretto.Insts.CoreDefaultDefault.default
  : Result ristretto.CompressedRistretto := do
  ristretto.CompressedRistretto.Insts.Curve25519_dalekTraitsIdentity.identity

/-- Trait implementation: [curve25519_dalek::ristretto::{core::default::Default for curve25519_dalek::ristretto::CompressedRistretto}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 351:0-355:1 -/
@[reducible]
def ristretto.CompressedRistretto.Insts.CoreDefaultDefault :
  core.default.Default ristretto.CompressedRistretto := {
  default := ristretto.CompressedRistretto.Insts.CoreDefaultDefault.default
}

/-- [curve25519_dalek::ristretto::{core::convert::TryFrom<&0 ([u8]), core::array::TryFromSliceError> for curve25519_dalek::ristretto::CompressedRistretto}::try_from]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 360:4-362:5 -/
def
  ristretto.CompressedRistretto.Insts.CoreConvertTryFromShared0SliceU8TryFromSliceError.try_from
  (slice : Slice Std.U8) :
  Result (core.result.Result ristretto.CompressedRistretto
    core.array.TryFromSliceError)
  := do
  ristretto.CompressedRistretto.from_slice slice

/-- Trait implementation: [curve25519_dalek::ristretto::{core::convert::TryFrom<&0 ([u8]), core::array::TryFromSliceError> for curve25519_dalek::ristretto::CompressedRistretto}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 357:0-363:1 -/
@[reducible]
def
  ristretto.CompressedRistretto.Insts.CoreConvertTryFromShared0SliceU8TryFromSliceError
  : core.convert.TryFrom ristretto.CompressedRistretto (Slice Std.U8)
  core.array.TryFromSliceError := {
  try_from :=
    ristretto.CompressedRistretto.Insts.CoreConvertTryFromShared0SliceU8TryFromSliceError.try_from
}

/-- [curve25519_dalek::ristretto::{core::clone::Clone for curve25519_dalek::ristretto::RistrettoPoint}::clone]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 493:15-493:20 -/
def ristretto.RistrettoPoint.Insts.CoreCloneClone.clone
  (self : ristretto.RistrettoPoint) : Result ristretto.RistrettoPoint := do
  ok self

/-- Trait implementation: [curve25519_dalek::ristretto::{core::clone::Clone for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 493:15-493:20 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreCloneClone : core.clone.Clone
  ristretto.RistrettoPoint := {
  clone := ristretto.RistrettoPoint.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::marker::Copy for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 493:9-493:13 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreMarkerCopy : core.marker.Copy
  ristretto.RistrettoPoint := {
  cloneInst := ristretto.RistrettoPoint.Insts.CoreCloneClone
}

/-- [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::RistrettoPoint}::compress]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 498:4-542:5 -/
noncomputable def ristretto.RistrettoPoint.compress
  (self : ristretto.RistrettoPoint) :
  Result ristretto.CompressedRistretto
  := do
  let z_plus_y ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      self.Z self.Y
  let z_minus_y ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      self.Z self.Y
  let u1 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      z_plus_y z_minus_y
  let u2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X self.Y
  let u2_sq ← backend.serial.u64.field.FieldElement51.square u2
  let u1_u2_sq ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      u1 u2_sq
  let (_, invsqrt) ← field.FieldElement51.invsqrt u1_u2_sq
  let i1 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      invsqrt u1
  let i2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      invsqrt u2
  let i2_T ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      i2 self.T
  let z_inv ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      i1 i2_T
  let iX ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X backend.serial.u64.constants.SQRT_M1
  let iY ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Y backend.serial.u64.constants.SQRT_M1
  let enchanted_denominator ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      i1 backend.serial.u64.constants.INVSQRT_A_MINUS_D
  let t_z_inv ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.T z_inv
  let rotate ← field.FieldElement51.is_negative t_z_inv
  let X ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      self.X iY rotate
  let Y ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      self.Y iX rotate
  let i21 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      i2 enchanted_denominator rotate
  let x_z_inv ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      X z_inv
  let y_sign ← field.FieldElement51.is_negative x_z_inv
  let y_neg ← Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg Y
  let Y1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      Y y_neg y_sign
  let z_minus_y2 ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      self.Z Y1
  let s ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      i21 z_minus_y2
  let s_is_negative ← field.FieldElement51.is_negative s
  let s_neg ← Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg s
  let s1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      s s_neg s_is_negative
  let a ← backend.serial.u64.field.FieldElement51.to_bytes s1
  ok a

/-- [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::RistrettoPoint}::coset4]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 659:4-666:5 -/
def ristretto.RistrettoPoint.coset4
  (self : ristretto.RistrettoPoint) :
  Result (Array edwards.EdwardsPoint 4#usize)
  := do
  let ep ←
    Array.index_usize backend.serial.u64.constants.EIGHT_TORSION 2#usize
  let ep1 ←
    edwards.EdwardsPoint.Insts.CoreOpsArithAddEdwardsPointEdwardsPoint.add self
      ep
  let ep2 ←
    Array.index_usize backend.serial.u64.constants.EIGHT_TORSION 4#usize
  let ep3 ←
    edwards.EdwardsPoint.Insts.CoreOpsArithAddEdwardsPointEdwardsPoint.add self
      ep2
  let ep4 ←
    Array.index_usize backend.serial.u64.constants.EIGHT_TORSION 6#usize
  let ep5 ←
    edwards.EdwardsPoint.Insts.CoreOpsArithAddEdwardsPointEdwardsPoint.add self
      ep4
  ok (Array.make 4#usize [ self, ep1, ep3, ep5 ])

/-- [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::RistrettoPoint}::elligator_ristretto_flavor]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 676:4-728:5 -/
noncomputable def ristretto.RistrettoPoint.elligator_ristretto_flavor
  (r_0 : backend.serial.u64.field.FieldElement51) :
  Result ristretto.RistrettoPoint
  := do
  let r_0_sq ← backend.serial.u64.field.FieldElement51.square r_0
  let r ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      backend.serial.u64.constants.SQRT_M1 r_0_sq
  let r_plus_one ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      r backend.serial.u64.field.FieldElement51.ONE
  let N_s ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      r_plus_one backend.serial.u64.constants.ONE_MINUS_EDWARDS_D_SQUARED
  let d_times_r ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      backend.serial.u64.constants.EDWARDS_D r
  let c_minus_dr ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      backend.serial.u64.constants.MINUS_ONE d_times_r
  let r_plus_d ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      r backend.serial.u64.constants.EDWARDS_D
  let D ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      c_minus_dr r_plus_d
  let (Ns_D_is_sq, s) ← field.FieldElement51.sqrt_ratio_i N_s D
  let s_prime ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      s r_0
  let c ← field.FieldElement51.is_negative s_prime
  let s_prime_is_pos ← subtle.Choice.Insts.CoreOpsBitNotChoice.not c
  let s_prime_neg ←
    Shared0FieldElement51.Insts.CoreOpsArithNegFieldElement51.neg s_prime
  let s_prime1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      s_prime s_prime_neg s_prime_is_pos
  let not_sq ← subtle.Choice.Insts.CoreOpsBitNotChoice.not Ns_D_is_sq
  let s1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      s s_prime1 not_sq
  let c1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConditionallySelectable.conditional_assign
      backend.serial.u64.constants.MINUS_ONE r not_sq
  let r_minus_one ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      r backend.serial.u64.field.FieldElement51.ONE
  let c_r_minus_one ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      c1 r_minus_one
  let c_r_minus_one_d ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      c_r_minus_one backend.serial.u64.constants.EDWARDS_D_MINUS_ONE_SQUARED
  let N_t ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      c_r_minus_one_d D
  let s_sq ← backend.serial.u64.field.FieldElement51.square s1
  let s_plus_s ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      s1 s1
  let cp_X ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      s_plus_s D
  let cp_Z ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      N_t backend.serial.u64.constants.SQRT_AD_MINUS_ONE
  let cp_Y ←
    Shared0FieldElement51.Insts.CoreOpsArithSubSharedAFieldElement51FieldElement51.sub
      backend.serial.u64.field.FieldElement51.ONE s_sq
  let cp_T ←
    Shared0FieldElement51.Insts.CoreOpsArithAddSharedAFieldElement51FieldElement51.add
      backend.serial.u64.field.FieldElement51.ONE s_sq
  let ep ←
    backend.serial.curve_models.CompletedPoint.as_extended
      { X := cp_X, Y := cp_Y, Z := cp_Z, T := cp_T }
  ok ep

/-- [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::RistrettoPoint}::from_uniform_bytes]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 823:4-839:5 -/
noncomputable def ristretto.RistrettoPoint.from_uniform_bytes
  (bytes : Array Std.U8 64#usize) : Result ristretto.RistrettoPoint := do
  let r_1_bytes := Array.repeat 32#usize 0#u8
  let (s, to_slice_mut_back) ←
    (↑(Array.to_slice_mut r_1_bytes) : Result ((Slice Std.U8) × (Slice
      Std.U8 → Array Std.U8 32#usize)))
  let s1 ←
    core.array.Array.index (core.ops.index.IndexSlice
      (core.slice.index.SliceIndexRangeUsizeSlice Std.U8)) bytes
      { start := 0#usize, «end» := 32#usize }
  let s2 ← core.slice.Slice.copy_from_slice core.marker.CopyU8 s s1
  let r_1_bytes1 := to_slice_mut_back s2
  let r_1 ← backend.serial.u64.field.FieldElement51.from_bytes r_1_bytes1
  let R_1 ← ristretto.RistrettoPoint.elligator_ristretto_flavor r_1
  let r_2_bytes := Array.repeat 32#usize 0#u8
  let (s3, to_slice_mut_back1) ←
    (↑(Array.to_slice_mut r_2_bytes) : Result ((Slice Std.U8) × (Slice
      Std.U8 → Array Std.U8 32#usize)))
  let s4 ←
    core.array.Array.index (core.ops.index.IndexSlice
      (core.slice.index.SliceIndexRangeUsizeSlice Std.U8)) bytes
      { start := 32#usize, «end» := 64#usize }
  let s5 ← core.slice.Slice.copy_from_slice core.marker.CopyU8 s3 s4
  let r_2_bytes1 := to_slice_mut_back1 s5
  let r_2 ← backend.serial.u64.field.FieldElement51.from_bytes r_2_bytes1
  let R_2 ← ristretto.RistrettoPoint.elligator_ristretto_flavor r_2
  ristretto.RistrettoPoint.Insts.CoreOpsArithAddRistrettoPointRistrettoPoint.add
    R_1 R_2

/-- [curve25519_dalek::ristretto::{curve25519_dalek::traits::Identity for curve25519_dalek::ristretto::RistrettoPoint}::identity]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 843:4-845:5 -/
def ristretto.RistrettoPoint.Insts.Curve25519_dalekTraitsIdentity.identity
  : Result ristretto.RistrettoPoint := do
  let ep ← edwards.EdwardsPoint.Insts.Curve25519_dalekTraitsIdentity.identity
  ok ep

/-- Trait implementation: [curve25519_dalek::ristretto::{curve25519_dalek::traits::Identity for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 842:0-846:1 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.Curve25519_dalekTraitsIdentity :
  traits.Identity ristretto.RistrettoPoint := {
  identity :=
    ristretto.RistrettoPoint.Insts.Curve25519_dalekTraitsIdentity.identity
}

/-- [curve25519_dalek::ristretto::{core::default::Default for curve25519_dalek::ristretto::RistrettoPoint}::default]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 849:4-851:5 -/
def ristretto.RistrettoPoint.Insts.CoreDefaultDefault.default
  : Result ristretto.RistrettoPoint := do
  ristretto.RistrettoPoint.Insts.Curve25519_dalekTraitsIdentity.identity

/-- Trait implementation: [curve25519_dalek::ristretto::{core::default::Default for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 848:0-852:1 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreDefaultDefault : core.default.Default
  ristretto.RistrettoPoint := {
  default := ristretto.RistrettoPoint.Insts.CoreDefaultDefault.default
}

/-- [curve25519_dalek::ristretto::{subtle::ConstantTimeEq for curve25519_dalek::ristretto::RistrettoPoint}::ct_eq]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 871:4-878:5 -/
def ristretto.RistrettoPoint.Insts.SubtleConstantTimeEq.ct_eq
  (self : ristretto.RistrettoPoint) (other : ristretto.RistrettoPoint) :
  Result subtle.Choice
  := do
  let X1Y2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X other.Y
  let Y1X2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Y other.X
  let X1X2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.X other.X
  let Y1Y2 ←
    Shared0FieldElement51.Insts.CoreOpsArithMulSharedAFieldElement51FieldElement51.mul
      self.Y other.Y
  let c ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
      X1Y2 Y1X2
  let c1 ←
    backend.serial.u64.field.FieldElement51.Insts.SubtleConstantTimeEq.ct_eq
      X1X2 Y1Y2
  subtle.Choice.Insts.CoreOpsBitBitOrChoiceChoice.bitor c c1

/-- [curve25519_dalek::ristretto::{core::cmp::PartialEq<curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}::eq]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 859:4-861:5 -/
def ristretto.RistrettoPoint.Insts.CoreCmpPartialEqRistrettoPoint.eq
  (self : ristretto.RistrettoPoint) (other : ristretto.RistrettoPoint) :
  Result Bool
  := do
  let c ←
    ristretto.RistrettoPoint.Insts.SubtleConstantTimeEq.ct_eq self other
  core.convert.IntoFrom.into Bool.Insts.CoreConvertFromChoice c

/-- Trait implementation: [curve25519_dalek::ristretto::{core::cmp::PartialEq<curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 858:0-862:1 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreCmpPartialEqRistrettoPoint :
  core.cmp.PartialEq ristretto.RistrettoPoint ristretto.RistrettoPoint := {
  eq := ristretto.RistrettoPoint.Insts.CoreCmpPartialEqRistrettoPoint.eq
  ne := ristretto.RistrettoPoint.Insts.CoreCmpPartialEqRistrettoPoint.ne
}

/-- Trait implementation: [curve25519_dalek::ristretto::{subtle::ConstantTimeEq for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 864:0-879:1 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.SubtleConstantTimeEq : subtle.ConstantTimeEq
  ristretto.RistrettoPoint := {
  ct_eq := ristretto.RistrettoPoint.Insts.SubtleConstantTimeEq.ct_eq
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::cmp::Eq for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 881:0-881:29 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreCmpEq : core.cmp.Eq
  ristretto.RistrettoPoint := {
  partialEqInst :=
    ristretto.RistrettoPoint.Insts.CoreCmpPartialEqRistrettoPoint
  assert_receiver_is_total_eq :=
    ristretto.RistrettoPoint.Insts.CoreCmpEq.assert_receiver_is_total_eq
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Add<&'a (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for &1 (curve25519_dalek::ristretto::RistrettoPoint)}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 887:0-893:1 -/
@[reducible]
def
  Shared0RistrettoPoint.Insts.CoreOpsArithAddSharedARistrettoPointRistrettoPoint
  : core.ops.arith.Add ristretto.RistrettoPoint ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  add :=
    Shared0RistrettoPoint.Insts.CoreOpsArithAddSharedARistrettoPointRistrettoPoint.add
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::AddAssign<&0 (curve25519_dalek::ristretto::RistrettoPoint)> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 901:0-905:1 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithAddAssignShared0RistrettoPoint :
  core.ops.arith.AddAssign ristretto.RistrettoPoint ristretto.RistrettoPoint
  := {
  add_assign :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithAddAssignShared0RistrettoPoint.add_assign
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Sub<&'a (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for &1 (curve25519_dalek::ristretto::RistrettoPoint)}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 909:0-915:1 -/
@[reducible]
def
  Shared0RistrettoPoint.Insts.CoreOpsArithSubSharedARistrettoPointRistrettoPoint
  : core.ops.arith.Sub ristretto.RistrettoPoint ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  sub :=
    Shared0RistrettoPoint.Insts.CoreOpsArithSubSharedARistrettoPointRistrettoPoint.sub
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::SubAssign<&0 (curve25519_dalek::ristretto::RistrettoPoint)> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 923:0-927:1 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithSubAssignShared0RistrettoPoint :
  core.ops.arith.SubAssign ristretto.RistrettoPoint ristretto.RistrettoPoint
  := {
  sub_assign :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithSubAssignShared0RistrettoPoint.sub_assign
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Neg<curve25519_dalek::ristretto::RistrettoPoint> for &0 (curve25519_dalek::ristretto::RistrettoPoint)}::neg]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 946:4-948:5 -/
def Shared0RistrettoPoint.Insts.CoreOpsArithNegRistrettoPoint.neg
  (self : ristretto.RistrettoPoint) : Result ristretto.RistrettoPoint := do
  let ep ← Shared0EdwardsPoint.Insts.CoreOpsArithNegEdwardsPoint.neg self
  ok ep

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Neg<curve25519_dalek::ristretto::RistrettoPoint> for &0 (curve25519_dalek::ristretto::RistrettoPoint)}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 943:0-949:1 -/
@[reducible]
def Shared0RistrettoPoint.Insts.CoreOpsArithNegRistrettoPoint :
  core.ops.arith.Neg ristretto.RistrettoPoint ristretto.RistrettoPoint := {
  neg := Shared0RistrettoPoint.Insts.CoreOpsArithNegRistrettoPoint.neg
}

/-- [curve25519_dalek::ristretto::{core::ops::arith::Neg<curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}::neg]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 954:4-956:5 -/
def ristretto.RistrettoPoint.Insts.CoreOpsArithNegRistrettoPoint.neg
  (self : ristretto.RistrettoPoint) : Result ristretto.RistrettoPoint := do
  Shared0RistrettoPoint.Insts.CoreOpsArithNegRistrettoPoint.neg self

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Neg<curve25519_dalek::ristretto::RistrettoPoint> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 951:0-957:1 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithNegRistrettoPoint :
  core.ops.arith.Neg ristretto.RistrettoPoint ristretto.RistrettoPoint := {
  neg := ristretto.RistrettoPoint.Insts.CoreOpsArithNegRistrettoPoint.neg
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::MulAssign<&'a (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 959:0-964:1 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.CoreOpsArithMulAssignSharedAScalar :
  core.ops.arith.MulAssign ristretto.RistrettoPoint scalar.Scalar := {
  mul_assign :=
    ristretto.RistrettoPoint.Insts.CoreOpsArithMulAssignSharedAScalar.mul_assign
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Mul<&'a (curve25519_dalek::scalar::Scalar), curve25519_dalek::ristretto::RistrettoPoint> for &1 (curve25519_dalek::ristretto::RistrettoPoint)}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 966:0-972:1 -/
@[reducible]
def Shared0RistrettoPoint.Insts.CoreOpsArithMulSharedAScalarRistrettoPoint :
  core.ops.arith.Mul ristretto.RistrettoPoint scalar.Scalar
  ristretto.RistrettoPoint := {
  mul :=
    Shared0RistrettoPoint.Insts.CoreOpsArithMulSharedAScalarRistrettoPoint.mul
}

/-- Trait implementation: [curve25519_dalek::ristretto::{core::ops::arith::Mul<&'a (curve25519_dalek::ristretto::RistrettoPoint), curve25519_dalek::ristretto::RistrettoPoint> for &1 (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 974:0-981:1 -/
@[reducible]
def Shared0Scalar.Insts.CoreOpsArithMulSharedARistrettoPointRistrettoPoint :
  core.ops.arith.Mul scalar.Scalar ristretto.RistrettoPoint
  ristretto.RistrettoPoint := {
  mul :=
    Shared0Scalar.Insts.CoreOpsArithMulSharedARistrettoPointRistrettoPoint.mul
}

/-- [curve25519_dalek::ristretto::{curve25519_dalek::ristretto::RistrettoPoint}::mul_base]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 988:4-998:5 -/
noncomputable def ristretto.RistrettoPoint.mul_base
  (scalar : scalar.Scalar) : Result ristretto.RistrettoPoint := do
  SharedAScalar.Insts.CoreOpsArithMulRistrettoPointRistrettoPoint.mul scalar
    constants.RISTRETTO_BASEPOINT_POINT

/-- [curve25519_dalek::ristretto::{subtle::ConditionallySelectable for curve25519_dalek::ristretto::RistrettoPoint}::conditional_select]:
   Source: 'curve25519-dalek/src/ristretto.rs', lines 1192:4-1198:5 -/
def
  ristretto.RistrettoPoint.Insts.SubtleConditionallySelectable.conditional_select
  (a : ristretto.RistrettoPoint) (b : ristretto.RistrettoPoint)
  (choice : subtle.Choice) :
  Result ristretto.RistrettoPoint
  := do
  let ep ←
    edwards.EdwardsPoint.Insts.SubtleConditionallySelectable.conditional_select
      a b choice
  ok ep

/-- Trait implementation: [curve25519_dalek::ristretto::{subtle::ConditionallySelectable for curve25519_dalek::ristretto::RistrettoPoint}]
   Source: 'curve25519-dalek/src/ristretto.rs', lines 1167:0-1199:1 -/
@[reducible]
def ristretto.RistrettoPoint.Insts.SubtleConditionallySelectable :
  subtle.ConditionallySelectable ristretto.RistrettoPoint := {
  coremarkerCopyInst := ristretto.RistrettoPoint.Insts.CoreMarkerCopy
  conditional_select :=
    ristretto.RistrettoPoint.Insts.SubtleConditionallySelectable.conditional_select
  conditional_assign :=
    ristretto.RistrettoPoint.Insts.SubtleConditionallySelectable.conditional_assign
  conditional_swap :=
    ristretto.RistrettoPoint.Insts.SubtleConditionallySelectable.conditional_swap
}

/-- [curve25519_dalek::scalar::{core::clone::Clone for curve25519_dalek::scalar::Scalar}::clone]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 194:15-194:20 -/
def scalar.Scalar.Insts.CoreCloneClone.clone
  (self : scalar.Scalar) : Result scalar.Scalar := do
  ok self

/-- Trait implementation: [curve25519_dalek::scalar::{core::clone::Clone for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 194:15-194:20 -/
@[reducible]
def scalar.Scalar.Insts.CoreCloneClone : core.clone.Clone scalar.Scalar := {
  clone := scalar.Scalar.Insts.CoreCloneClone.clone
}

/-- Trait implementation: [curve25519_dalek::scalar::{core::marker::Copy for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 194:9-194:13 -/
@[reducible]
def scalar.Scalar.Insts.CoreMarkerCopy : core.marker.Copy scalar.Scalar := {
  cloneInst := scalar.Scalar.Insts.CoreCloneClone
}

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::reduce]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1139:4-1144:5 -/
def scalar.Scalar.reduce (self : scalar.Scalar) : Result scalar.Scalar := do
  let x ← scalar.Scalar.unpack self
  let xR ←
    backend.serial.u64.scalar.Scalar52.mul_internal x
      backend.serial.u64.constants.R
  let x_mod_l ← backend.serial.u64.scalar.Scalar52.montgomery_reduce xR
  scalar.Scalar52.pack x_mod_l

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::from_bytes_mod_order]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 237:4-246:5 -/
def scalar.Scalar.from_bytes_mod_order
  (bytes : Array Std.U8 32#usize) : Result scalar.Scalar := do
  let s ← scalar.Scalar.reduce { bytes }
  let i ← scalar.Scalar.Insts.CoreOpsIndexIndexUsizeU8.index s 31#usize
  let right_val ← i >>> 7#i32
  if 0#u8 = right_val
  then ok s
  else fail panic

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::from_bytes_mod_order_wide]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 250:4-252:5 -/
def scalar.Scalar.from_bytes_mod_order_wide
  (input : Array Std.U8 64#usize) : Result scalar.Scalar := do
  let s ← backend.serial.u64.scalar.Scalar52.from_bytes_wide input
  scalar.Scalar52.pack s

/-- [curve25519_dalek::scalar::{subtle::ConstantTimeEq for curve25519_dalek::scalar::Scalar}::ct_eq]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 301:4-303:5 -/
def scalar.Scalar.Insts.SubtleConstantTimeEq.ct_eq
  (self : scalar.Scalar) (other : scalar.Scalar) : Result subtle.Choice := do
  let s ← (↑(Array.to_slice self.bytes) : Result (Slice Std.U8))
  let s1 ← (↑(Array.to_slice other.bytes) : Result (Slice Std.U8))
  Slice.Insts.SubtleConstantTimeEq.ct_eq U8.Insts.SubtleConstantTimeEq s s1

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::is_canonical]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1148:4-1150:5 -/
noncomputable def scalar.Scalar.is_canonical
  (self : scalar.Scalar) : Result subtle.Choice := do
  let s ← scalar.Scalar.reduce self
  scalar.Scalar.Insts.SubtleConstantTimeEq.ct_eq self s

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::from_canonical_bytes]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 261:4-265:5 -/
noncomputable def scalar.Scalar.from_canonical_bytes
  (bytes : Array Std.U8 32#usize) :
  Result (subtle.CtOption scalar.Scalar)
  := do
  let i ← Array.index_usize bytes 31#usize
  let i1 ← i >>> 7#i32
  let high_bit_unset ← U8.Insts.SubtleConstantTimeEq.ct_eq i1 0#u8
  let c ← scalar.Scalar.is_canonical { bytes }
  let c1 ←
    subtle.Choice.Insts.CoreOpsBitBitAndChoiceChoice.bitand high_bit_unset c
  subtle.CtOption.new ({ bytes } : scalar.Scalar) c1

/-- [curve25519_dalek::scalar::{core::cmp::PartialEq<curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::eq]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 295:4-297:5 -/
def scalar.Scalar.Insts.CoreCmpPartialEqScalar.eq
  (self : scalar.Scalar) (other : scalar.Scalar) : Result Bool := do
  let c ← scalar.Scalar.Insts.SubtleConstantTimeEq.ct_eq self other
  core.convert.IntoFrom.into Bool.Insts.CoreConvertFromChoice c

/-- Trait implementation: [curve25519_dalek::scalar::{core::cmp::PartialEq<curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 294:0-298:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreCmpPartialEqScalar : core.cmp.PartialEq
  scalar.Scalar scalar.Scalar := {
  eq := scalar.Scalar.Insts.CoreCmpPartialEqScalar.eq
  ne := scalar.Scalar.Insts.CoreCmpPartialEqScalar.ne
}

/-- Trait implementation: [curve25519_dalek::scalar::{core::cmp::Eq for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 293:0-293:21 -/
@[reducible]
def scalar.Scalar.Insts.CoreCmpEq : core.cmp.Eq scalar.Scalar := {
  partialEqInst := scalar.Scalar.Insts.CoreCmpPartialEqScalar
  assert_receiver_is_total_eq :=
    scalar.Scalar.Insts.CoreCmpEq.assert_receiver_is_total_eq
}

/-- Trait implementation: [curve25519_dalek::scalar::{subtle::ConstantTimeEq for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 300:0-304:1 -/
@[reducible]
def scalar.Scalar.Insts.SubtleConstantTimeEq : subtle.ConstantTimeEq
  scalar.Scalar := {
  ct_eq := scalar.Scalar.Insts.SubtleConstantTimeEq.ct_eq
}

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::index::Index<usize, u8> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 306:0-313:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsIndexIndexUsizeU8 : core.ops.index.Index
  scalar.Scalar Std.Usize Std.U8 := {
  index := scalar.Scalar.Insts.CoreOpsIndexIndexUsizeU8.index
}

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::MulAssign<&'a (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 315:0-319:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithMulAssignSharedAScalar :
  core.ops.arith.MulAssign scalar.Scalar scalar.Scalar := {
  mul_assign :=
    scalar.Scalar.Insts.CoreOpsArithMulAssignSharedAScalar.mul_assign
}

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Mul<&'a (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for &1 (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 323:0-328:1 -/
@[reducible]
def Shared0Scalar.Insts.CoreOpsArithMulSharedAScalarScalar : core.ops.arith.Mul
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  mul := Shared0Scalar.Insts.CoreOpsArithMulSharedAScalarScalar.mul
}

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::AddAssign<&'a (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 332:0-336:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithAddAssignSharedAScalar :
  core.ops.arith.AddAssign scalar.Scalar scalar.Scalar := {
  add_assign :=
    scalar.Scalar.Insts.CoreOpsArithAddAssignSharedAScalar.add_assign
}

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Add<&'a (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for &1 (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 340:0-348:1 -/
@[reducible]
def Shared0Scalar.Insts.CoreOpsArithAddSharedAScalarScalar : core.ops.arith.Add
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  add := Shared0Scalar.Insts.CoreOpsArithAddSharedAScalarScalar.add
}

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::SubAssign<&'a (curve25519_dalek::scalar::Scalar)> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 352:0-356:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithSubAssignSharedAScalar :
  core.ops.arith.SubAssign scalar.Scalar scalar.Scalar := {
  sub_assign :=
    scalar.Scalar.Insts.CoreOpsArithSubAssignSharedAScalar.sub_assign
}

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Sub<&'a (curve25519_dalek::scalar::Scalar), curve25519_dalek::scalar::Scalar> for &1 (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 360:0-368:1 -/
@[reducible]
def Shared0Scalar.Insts.CoreOpsArithSubSharedAScalarScalar : core.ops.arith.Sub
  scalar.Scalar scalar.Scalar scalar.Scalar := {
  sub := Shared0Scalar.Insts.CoreOpsArithSubSharedAScalarScalar.sub
}

/-- [curve25519_dalek::scalar::{core::ops::arith::Neg<curve25519_dalek::scalar::Scalar> for &0 (curve25519_dalek::scalar::Scalar)}::neg]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 375:4-379:5 -/
def Shared0Scalar.Insts.CoreOpsArithNegScalar.neg
  (self : scalar.Scalar) : Result scalar.Scalar := do
  let s ← scalar.Scalar.unpack self
  let self_R ←
    backend.serial.u64.scalar.Scalar52.mul_internal s
      backend.serial.u64.constants.R
  let self_mod_l ←
    backend.serial.u64.scalar.Scalar52.montgomery_reduce self_R
  let s1 ←
    backend.serial.u64.scalar.Scalar52.sub
      backend.serial.u64.scalar.Scalar52.ZERO self_mod_l
  scalar.Scalar52.pack s1

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Neg<curve25519_dalek::scalar::Scalar> for &0 (curve25519_dalek::scalar::Scalar)}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 372:0-380:1 -/
@[reducible]
def Shared0Scalar.Insts.CoreOpsArithNegScalar : core.ops.arith.Neg
  scalar.Scalar scalar.Scalar := {
  neg := Shared0Scalar.Insts.CoreOpsArithNegScalar.neg
}

/-- [curve25519_dalek::scalar::{core::ops::arith::Neg<curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}::neg]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 384:4-386:5 -/
def scalar.Scalar.Insts.CoreOpsArithNegScalar.neg
  (self : scalar.Scalar) : Result scalar.Scalar := do
  Shared0Scalar.Insts.CoreOpsArithNegScalar.neg self

/-- Trait implementation: [curve25519_dalek::scalar::{core::ops::arith::Neg<curve25519_dalek::scalar::Scalar> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 382:0-387:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreOpsArithNegScalar : core.ops.arith.Neg
  scalar.Scalar scalar.Scalar := {
  neg := scalar.Scalar.Insts.CoreOpsArithNegScalar.neg
}

/-- [curve25519_dalek::scalar::{subtle::ConditionallySelectable for curve25519_dalek::scalar::Scalar}::conditional_select]: loop 0:
   Source: 'curve25519-dalek/src/scalar.rs', lines 393:8-395:9 -/
def scalar.Scalar.Insts.SubtleConditionallySelectable.conditional_select_loop
  (a : scalar.Scalar) (b : scalar.Scalar) (choice : subtle.Choice)
  (bytes : Array Std.U8 32#usize) (iter : core.ops.range.Range Std.Usize) :
  Result (Array Std.U8 32#usize)
  := do
  let (o, iter1) ←
    core.iter.range.IteratorRange.next core.iter.range.StepUsize iter
  match o with
  | none => ok bytes
  | some i =>
    let i1 ← Array.index_usize a.bytes i
    let i2 ← Array.index_usize b.bytes i
    let i3 ←
      U8.Insts.SubtleConditionallySelectable.conditional_select i1 i2 choice
    let a1 ← Array.update bytes i i3
    scalar.Scalar.Insts.SubtleConditionallySelectable.conditional_select_loop a
      b choice a1 iter1
partial_fixpoint

/-- [curve25519_dalek::scalar::{subtle::ConditionallySelectable for curve25519_dalek::scalar::Scalar}::conditional_select]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 390:4-397:5 -/
def scalar.Scalar.Insts.SubtleConditionallySelectable.conditional_select
  (a : scalar.Scalar) (b : scalar.Scalar) (choice : subtle.Choice) :
  Result scalar.Scalar
  := do
  let bytes := Array.repeat 32#usize 0#u8
  let iter ←
    core.iter.traits.collect.IntoIterator.Blanket.into_iter
      (core.iter.traits.iterator.IteratorRange core.iter.range.StepUsize)
      { start := 0#usize, «end» := 32#usize }
  let bytes1 ←
    scalar.Scalar.Insts.SubtleConditionallySelectable.conditional_select_loop a
      b choice bytes iter
  ok { bytes := bytes1 }

/-- Trait implementation: [curve25519_dalek::scalar::{subtle::ConditionallySelectable for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 389:0-398:1 -/
@[reducible]
def scalar.Scalar.Insts.SubtleConditionallySelectable :
  subtle.ConditionallySelectable scalar.Scalar := {
  coremarkerCopyInst := scalar.Scalar.Insts.CoreMarkerCopy
  conditional_select :=
    scalar.Scalar.Insts.SubtleConditionallySelectable.conditional_select
  conditional_assign :=
    scalar.Scalar.Insts.SubtleConditionallySelectable.conditional_assign
  conditional_swap :=
    scalar.Scalar.Insts.SubtleConditionallySelectable.conditional_swap
}

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::ZERO]
   Source: 'curve25519-dalek/src/scalar.rs', lines 564:4-564:53 -/
@[global_simps]
def scalar.Scalar.ZERO_body : Result scalar.Scalar := do
  let a := Array.repeat 32#usize 0#u8
  ok { bytes := a }
@[global_simps, irreducible]
def scalar.Scalar.ZERO : scalar.Scalar := eval_global scalar.Scalar.ZERO_body

/-- [curve25519_dalek::scalar::{core::default::Default for curve25519_dalek::scalar::Scalar}::default]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 485:4-487:5 -/
def scalar.Scalar.Insts.CoreDefaultDefault.default : Result scalar.Scalar := do
  ok scalar.Scalar.ZERO

/-- Trait implementation: [curve25519_dalek::scalar::{core::default::Default for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 484:0-488:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreDefaultDefault : core.default.Default scalar.Scalar
  := {
  default := scalar.Scalar.Insts.CoreDefaultDefault.default
}

/-- [curve25519_dalek::scalar::{core::convert::From<u8> for curve25519_dalek::scalar::Scalar}::from]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 491:4-495:5 -/
def scalar.Scalar.Insts.CoreConvertFromU8.from
  (x : Std.U8) : Result scalar.Scalar := do
  let s_bytes := Array.repeat 32#usize 0#u8
  let s_bytes1 ← Array.update s_bytes 0#usize x
  ok { bytes := s_bytes1 }

/-- Trait implementation: [curve25519_dalek::scalar::{core::convert::From<u8> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 490:0-496:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreConvertFromU8 : core.convert.From scalar.Scalar
  Std.U8 := {
  from_ := scalar.Scalar.Insts.CoreConvertFromU8.from
}

/-- [curve25519_dalek::scalar::{core::convert::From<u16> for curve25519_dalek::scalar::Scalar}::from]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 499:4-504:5 -/
def scalar.Scalar.Insts.CoreConvertFromU16.from
  (x : Std.U16) : Result scalar.Scalar := do
  let s_bytes := Array.repeat 32#usize 0#u8
  let x_bytes ←
    (↑(core.num.U16.to_le_bytes x) : Result (Array Std.U8 2#usize))
  let s ← (↑(Array.to_slice x_bytes) : Result (Slice Std.U8))
  let i := Slice.len s
  let (s1, index_mut_back) ←
    core.array.Array.index_mut (core.ops.index.IndexMutSlice
      (core.slice.index.SliceIndexRangeUsizeSlice Std.U8)) s_bytes
      { start := 0#usize, «end» := i }
  let s2 ← (↑(Array.to_slice x_bytes) : Result (Slice Std.U8))
  let s3 ← core.slice.Slice.copy_from_slice core.marker.CopyU8 s1 s2
  let s_bytes1 := index_mut_back s3
  ok { bytes := s_bytes1 }

/-- Trait implementation: [curve25519_dalek::scalar::{core::convert::From<u16> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 498:0-505:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreConvertFromU16 : core.convert.From scalar.Scalar
  Std.U16 := {
  from_ := scalar.Scalar.Insts.CoreConvertFromU16.from
}

/-- [curve25519_dalek::scalar::{core::convert::From<u32> for curve25519_dalek::scalar::Scalar}::from]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 508:4-513:5 -/
def scalar.Scalar.Insts.CoreConvertFromU32.from
  (x : Std.U32) : Result scalar.Scalar := do
  let s_bytes := Array.repeat 32#usize 0#u8
  let x_bytes ←
    (↑(core.num.U32.to_le_bytes x) : Result (Array Std.U8 4#usize))
  let s ← (↑(Array.to_slice x_bytes) : Result (Slice Std.U8))
  let i := Slice.len s
  let (s1, index_mut_back) ←
    core.array.Array.index_mut (core.ops.index.IndexMutSlice
      (core.slice.index.SliceIndexRangeUsizeSlice Std.U8)) s_bytes
      { start := 0#usize, «end» := i }
  let s2 ← (↑(Array.to_slice x_bytes) : Result (Slice Std.U8))
  let s3 ← core.slice.Slice.copy_from_slice core.marker.CopyU8 s1 s2
  let s_bytes1 := index_mut_back s3
  ok { bytes := s_bytes1 }

/-- Trait implementation: [curve25519_dalek::scalar::{core::convert::From<u32> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 507:0-514:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreConvertFromU32 : core.convert.From scalar.Scalar
  Std.U32 := {
  from_ := scalar.Scalar.Insts.CoreConvertFromU32.from
}

/-- [curve25519_dalek::scalar::{core::convert::From<u64> for curve25519_dalek::scalar::Scalar}::from]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 538:4-543:5 -/
def scalar.Scalar.Insts.CoreConvertFromU64.from
  (x : Std.U64) : Result scalar.Scalar := do
  let s_bytes := Array.repeat 32#usize 0#u8
  let x_bytes ←
    (↑(core.num.U64.to_le_bytes x) : Result (Array Std.U8 8#usize))
  let s ← (↑(Array.to_slice x_bytes) : Result (Slice Std.U8))
  let i := Slice.len s
  let (s1, index_mut_back) ←
    core.array.Array.index_mut (core.ops.index.IndexMutSlice
      (core.slice.index.SliceIndexRangeUsizeSlice Std.U8)) s_bytes
      { start := 0#usize, «end» := i }
  let s2 ← (↑(Array.to_slice x_bytes) : Result (Slice Std.U8))
  let s3 ← core.slice.Slice.copy_from_slice core.marker.CopyU8 s1 s2
  let s_bytes1 := index_mut_back s3
  ok { bytes := s_bytes1 }

/-- Trait implementation: [curve25519_dalek::scalar::{core::convert::From<u64> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 516:0-544:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreConvertFromU64 : core.convert.From scalar.Scalar
  Std.U64 := {
  from_ := scalar.Scalar.Insts.CoreConvertFromU64.from
}

/-- [curve25519_dalek::scalar::{core::convert::From<u128> for curve25519_dalek::scalar::Scalar}::from]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 547:4-552:5 -/
def scalar.Scalar.Insts.CoreConvertFromU128.from
  (x : Std.U128) : Result scalar.Scalar := do
  let s_bytes := Array.repeat 32#usize 0#u8
  let x_bytes ←
    (↑(core.num.U128.to_le_bytes x) : Result (Array Std.U8 16#usize))
  let s ← (↑(Array.to_slice x_bytes) : Result (Slice Std.U8))
  let i := Slice.len s
  let (s1, index_mut_back) ←
    core.array.Array.index_mut (core.ops.index.IndexMutSlice
      (core.slice.index.SliceIndexRangeUsizeSlice Std.U8)) s_bytes
      { start := 0#usize, «end» := i }
  let s2 ← (↑(Array.to_slice x_bytes) : Result (Slice Std.U8))
  let s3 ← core.slice.Slice.copy_from_slice core.marker.CopyU8 s1 s2
  let s_bytes1 := index_mut_back s3
  ok { bytes := s_bytes1 }

/-- Trait implementation: [curve25519_dalek::scalar::{core::convert::From<u128> for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 546:0-553:1 -/
@[reducible]
def scalar.Scalar.Insts.CoreConvertFromU128 : core.convert.From scalar.Scalar
  Std.U128 := {
  from_ := scalar.Scalar.Insts.CoreConvertFromU128.from
}

/-- [curve25519_dalek::scalar::{zeroize::Zeroize for curve25519_dalek::scalar::Scalar}::zeroize]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 557:4-559:5 -/
def scalar.Scalar.Insts.ZeroizeZeroize.zeroize
  (self : scalar.Scalar) : Result scalar.Scalar := do
  let a ←
    Array.Insts.ZeroizeZeroize.zeroize (zeroize.Zeroize.Blanket
      U8.Insts.ZeroizeDefaultIsZeroes) self.bytes
  ok { bytes := a }

/-- Trait implementation: [curve25519_dalek::scalar::{zeroize::Zeroize for curve25519_dalek::scalar::Scalar}]
   Source: 'curve25519-dalek/src/scalar.rs', lines 556:0-560:1 -/
@[reducible]
def scalar.Scalar.Insts.ZeroizeZeroize : zeroize.Zeroize scalar.Scalar := {
  zeroize := scalar.Scalar.Insts.ZeroizeZeroize.zeroize
}

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::ONE]
   Source: 'curve25519-dalek/src/scalar.rs', lines 567:4-572:6 -/
@[global_simps, irreducible]
def scalar.Scalar.ONE : scalar.Scalar :=
  {
    bytes :=
      (Array.make 32#usize [
        1#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8,
        0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8,
        0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8, 0#u8
        ])
  }

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::to_bytes]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 691:4-693:5 -/
def scalar.Scalar.to_bytes
  (self : scalar.Scalar) : Result (Array Std.U8 32#usize) := do
  ok self.bytes

/-- [curve25519_dalek::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::montgomery_invert::square_multiply]: loop 0:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1183:12-1186:13 -/
def scalar.Scalar52.montgomery_invert.square_multiply_loop
  (y : backend.serial.u64.scalar.Scalar52) (squarings : Std.Usize)
  (i : Std.Usize) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  if i < squarings
  then
    let y1 ← backend.serial.u64.scalar.Scalar52.montgomery_square y
    let i1 ← i + 1#usize
    scalar.Scalar52.montgomery_invert.square_multiply_loop y1 squarings i1
  else ok y
partial_fixpoint

/-- [curve25519_dalek::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::montgomery_invert::square_multiply]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1181:8-1188:9 -/
def scalar.Scalar52.montgomery_invert.square_multiply
  (y : backend.serial.u64.scalar.Scalar52) (squarings : Std.Usize)
  (x : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let y1 ←
    scalar.Scalar52.montgomery_invert.square_multiply_loop y squarings 0#usize
  backend.serial.u64.scalar.Scalar52.montgomery_mul y1 x

/-- [curve25519_dalek::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::montgomery_invert]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1164:4-1219:5 -/
def scalar.Scalar52.montgomery_invert
  (self : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let _10 ← backend.serial.u64.scalar.Scalar52.montgomery_square self
  let _100 ← backend.serial.u64.scalar.Scalar52.montgomery_square _10
  let _11 ← backend.serial.u64.scalar.Scalar52.montgomery_mul _10 self
  let _101 ← backend.serial.u64.scalar.Scalar52.montgomery_mul _10 _11
  let _111 ← backend.serial.u64.scalar.Scalar52.montgomery_mul _10 _101
  let _1001 ← backend.serial.u64.scalar.Scalar52.montgomery_mul _10 _111
  let _1011 ← backend.serial.u64.scalar.Scalar52.montgomery_mul _10 _1001
  let _1111 ← backend.serial.u64.scalar.Scalar52.montgomery_mul _100 _1011
  let y ← backend.serial.u64.scalar.Scalar52.montgomery_mul _1111 self
  let i ← 123#usize + 3#usize
  let y1 ← scalar.Scalar52.montgomery_invert.square_multiply y i _101
  let i1 ← 2#usize + 2#usize
  let y2 ← scalar.Scalar52.montgomery_invert.square_multiply y1 i1 _11
  let i2 ← 1#usize + 4#usize
  let y3 ← scalar.Scalar52.montgomery_invert.square_multiply y2 i2 _1111
  let y4 ← scalar.Scalar52.montgomery_invert.square_multiply y3 i2 _1111
  let y5 ← scalar.Scalar52.montgomery_invert.square_multiply y4 4#usize _1001
  let y6 ← scalar.Scalar52.montgomery_invert.square_multiply y5 2#usize _11
  let y7 ← scalar.Scalar52.montgomery_invert.square_multiply y6 i2 _1111
  let i3 ← 1#usize + 3#usize
  let y8 ← scalar.Scalar52.montgomery_invert.square_multiply y7 i3 _101
  let i4 ← 3#usize + 3#usize
  let y9 ← scalar.Scalar52.montgomery_invert.square_multiply y8 i4 _101
  let y10 ← scalar.Scalar52.montgomery_invert.square_multiply y9 3#usize _111
  let y11 ← scalar.Scalar52.montgomery_invert.square_multiply y10 i2 _1111
  let i5 ← 2#usize + 3#usize
  let y12 ← scalar.Scalar52.montgomery_invert.square_multiply y11 i5 _111
  let y13 ← scalar.Scalar52.montgomery_invert.square_multiply y12 i1 _11
  let y14 ← scalar.Scalar52.montgomery_invert.square_multiply y13 i2 _1011
  let i6 ← 2#usize + 4#usize
  let y15 ← scalar.Scalar52.montgomery_invert.square_multiply y14 i6 _1011
  let i7 ← 6#usize + 4#usize
  let y16 ← scalar.Scalar52.montgomery_invert.square_multiply y15 i7 _1001
  let y17 ← scalar.Scalar52.montgomery_invert.square_multiply y16 i1 _11
  let i8 ← 3#usize + 2#usize
  let y18 ← scalar.Scalar52.montgomery_invert.square_multiply y17 i8 _11
  let y19 ← scalar.Scalar52.montgomery_invert.square_multiply y18 i8 _11
  let y20 ← scalar.Scalar52.montgomery_invert.square_multiply y19 i2 _1001
  let y21 ← scalar.Scalar52.montgomery_invert.square_multiply y20 i3 _111
  let y22 ← scalar.Scalar52.montgomery_invert.square_multiply y21 i6 _1111
  let y23 ← scalar.Scalar52.montgomery_invert.square_multiply y22 i2 _1011
  let y24 ←
    scalar.Scalar52.montgomery_invert.square_multiply y23 3#usize _101
  let y25 ← scalar.Scalar52.montgomery_invert.square_multiply y24 i6 _1111
  let y26 ←
    scalar.Scalar52.montgomery_invert.square_multiply y25 3#usize _101
  let i9 ← 1#usize + 2#usize
  scalar.Scalar52.montgomery_invert.square_multiply y26 i9 _11

/-- [curve25519_dalek::scalar::{curve25519_dalek::backend::serial::u64::scalar::Scalar52}::invert]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1222:4-1224:5 -/
def scalar.Scalar52.invert
  (self : backend.serial.u64.scalar.Scalar52) :
  Result backend.serial.u64.scalar.Scalar52
  := do
  let s ← backend.serial.u64.scalar.Scalar52.as_montgomery self
  let s1 ← scalar.Scalar52.montgomery_invert s
  backend.serial.u64.scalar.Scalar52.from_montgomery s1

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::invert]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 747:4-749:5 -/
def scalar.Scalar.invert (self : scalar.Scalar) : Result scalar.Scalar := do
  let s ← scalar.Scalar.unpack self
  let s1 ← scalar.Scalar52.invert s
  scalar.Scalar52.pack s1

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::batch_invert]: loop 0:
   Source: 'curve25519-dalek/src/scalar.rs', lines 808:8-818:9 -/
def scalar.Scalar.batch_invert_loop0
  (inputs : Slice scalar.Scalar) (n : Std.Usize)
  (scratch : alloc.vec.Vec backend.serial.u64.scalar.Scalar52)
  (acc : backend.serial.u64.scalar.Scalar52) (i : Std.Usize) :
  Result ((Slice scalar.Scalar) × (alloc.vec.Vec
    backend.serial.u64.scalar.Scalar52) × backend.serial.u64.scalar.Scalar52)
  := do
  if i < n
  then
    let (input, index_mut_back) ← Slice.index_mut_usize inputs i
    let (_, index_mut_back1) ←
      alloc.vec.Vec.index_mut (core.slice.index.SliceIndexUsizeSlice
        backend.serial.u64.scalar.Scalar52) scratch i
    let s ← scalar.Scalar.unpack input
    let tmp ← backend.serial.u64.scalar.Scalar52.as_montgomery s
    let input1 ← scalar.Scalar52.pack tmp
    let acc1 ← backend.serial.u64.scalar.Scalar52.montgomery_mul acc tmp
    let i1 ← i + 1#usize
    let scratch1 := index_mut_back1 acc
    let s1 := index_mut_back input1
    scalar.Scalar.batch_invert_loop0 s1 n scratch1 acc1 i1
  else ok (inputs, scratch, acc)
partial_fixpoint

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::batch_invert]: loop 1:
   Source: 'curve25519-dalek/src/scalar.rs', lines 832:8-839:9 -/
def scalar.Scalar.batch_invert_loop1
  (inputs : Slice scalar.Scalar)
  (scratch : alloc.vec.Vec backend.serial.u64.scalar.Scalar52)
  (acc : backend.serial.u64.scalar.Scalar52) (i : Std.Usize) :
  Result (Slice scalar.Scalar)
  := do
  if i > 0#usize
  then
    let i1 ← i - 1#usize
    let (input, index_mut_back) ← Slice.index_mut_usize inputs i1
    let scratch_val ←
      alloc.vec.Vec.index (core.slice.index.SliceIndexUsizeSlice
        backend.serial.u64.scalar.Scalar52) scratch i1
    let s ← scalar.Scalar.unpack input
    let tmp ← backend.serial.u64.scalar.Scalar52.montgomery_mul acc s
    let s1 ←
      backend.serial.u64.scalar.Scalar52.montgomery_mul acc scratch_val
    let input1 ← scalar.Scalar52.pack s1
    let s2 := index_mut_back input1
    scalar.Scalar.batch_invert_loop1 s2 scratch tmp i1
  else ok inputs
partial_fixpoint

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::batch_invert]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 788:4-845:5 -/
noncomputable def scalar.Scalar.batch_invert
  (inputs : Slice scalar.Scalar) :
  Result (scalar.Scalar × (Slice scalar.Scalar))
  := do
  let n := Slice.len inputs
  let s ← scalar.Scalar.unpack scalar.Scalar.ONE
  let one ← backend.serial.u64.scalar.Scalar52.as_montgomery s
  let scratch ←
    alloc.vec.from_elem backend.serial.u64.scalar.Scalar52.Insts.CoreCloneClone
      one n
  let acc ← backend.serial.u64.scalar.Scalar52.as_montgomery s
  let (inputs1, scratch1, acc1) ←
    scalar.Scalar.batch_invert_loop0 inputs n scratch acc 0#usize
  let s1 ← scalar.Scalar52.pack acc1
  let b ← scalar.Scalar.Insts.CoreCmpPartialEqScalar.ne s1 scalar.Scalar.ZERO
  massert b
  let s2 ← scalar.Scalar52.montgomery_invert acc1
  let acc2 ← backend.serial.u64.scalar.Scalar52.from_montgomery s2
  let ret ← scalar.Scalar52.pack acc2
  let inputs2 ← scalar.Scalar.batch_invert_loop1 inputs1 scratch1 acc2 n
  let _ ←
    alloc.vec.Vec.Insts.ZeroizeZeroize.zeroize
      backend.serial.u64.scalar.Scalar52.Insts.ZeroizeZeroize scratch1
  ok (ret, inputs2)

/-- [curve25519_dalek::scalar::read_le_u64_into]: loop 0:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1369:4-1382:5 -/
def scalar.read_le_u64_into_loop
  (src : Slice Std.U8) (dst : Slice Std.U64) (i : Std.Usize) :
  Result (Slice Std.U64)
  := do
  let i1 := Slice.len dst
  if i < i1
  then
    let start ← i * 8#usize
    let i2 ← Slice.index_usize src start
    let i3 ← start + 1#usize
    let i4 ← Slice.index_usize src i3
    let i5 ← start + 2#usize
    let i6 ← Slice.index_usize src i5
    let i7 ← start + 3#usize
    let i8 ← Slice.index_usize src i7
    let i9 ← start + 4#usize
    let i10 ← Slice.index_usize src i9
    let i11 ← start + 5#usize
    let i12 ← Slice.index_usize src i11
    let i13 ← start + 6#usize
    let i14 ← Slice.index_usize src i13
    let i15 ← start + 7#usize
    let i16 ← Slice.index_usize src i15
    let i17 ←
      (↑(core.num.U64.from_le_bytes
        (Array.make 8#usize [ i2, i4, i6, i8, i10, i12, i14, i16 ])) : Result
        Std.U64)
    let s ← Slice.update dst i i17
    let i18 ← i + 1#usize
    scalar.read_le_u64_into_loop src s i18
  else ok dst
partial_fixpoint

/-- [curve25519_dalek::scalar::read_le_u64_into]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1366:0-1383:1 -/
def scalar.read_le_u64_into
  (src : Slice Std.U8) (dst : Slice Std.U64) : Result (Slice Std.U64) := do
  let i := Slice.len src
  let i1 := Slice.len dst
  let i2 ← 8#usize * i1
  massert (i = i2)
  scalar.read_le_u64_into_loop src dst 0#usize

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::non_adjacent_form]: loop 0:
   Source: 'curve25519-dalek/src/scalar.rs', lines 947:8-980:9 -/
def scalar.Scalar.non_adjacent_form_loop
  (w : Std.Usize) (naf : Array Std.I8 256#usize)
  (x_u64 : Array Std.U64 5#usize) (width : Std.U64) (window_mask : Std.U64)
  (pos : Std.Usize) (carry : Std.U64) :
  Result (Array Std.I8 256#usize)
  := do
  if pos < 256#usize
  then
    let u64_idx ← pos / 64#usize
    let bit_idx ← pos % 64#usize
    let i ← 64#usize - w
    let bit_buf ←
      if bit_idx < i
      then let i1 ← Array.index_usize x_u64 u64_idx
           i1 >>> bit_idx
      else
        let i1 ← Array.index_usize x_u64 u64_idx
        let i2 ← i1 >>> bit_idx
        let i3 ← 1#usize + u64_idx
        let i4 ← Array.index_usize x_u64 i3
        let i5 ← 64#usize - bit_idx
        let i6 ← i4 <<< i5
        ok (i2 ||| i6)
    let i1 ← (↑(bit_buf &&& window_mask) : Result Std.U64)
    let window ← carry + i1
    let i2 ← (↑(window &&& 1#u64) : Result Std.U64)
    if i2 = 0#u64
    then
      let pos1 ← pos + 1#usize
      scalar.Scalar.non_adjacent_form_loop w naf x_u64 width window_mask pos1
        carry
    else
      let i3 ← width / 2#u64
      let (naf1, carry1) ←
        if window < i3
        then
          let i4 ← (↑(UScalar.hcast .I8 window) : Result Std.I8)
          let a ← Array.update naf pos i4
          ok (a, 0#u64)
        else
          let i4 ← (↑(UScalar.hcast .I8 window) : Result Std.I8)
          let i5 ← (↑(UScalar.hcast .I8 width) : Result Std.I8)
          let i6 ← (↑(core.num.I8.wrapping_sub i4 i5) : Result Std.I8)
          let a ← Array.update naf pos i6
          ok (a, 1#u64)
      let pos1 ← pos + w
      scalar.Scalar.non_adjacent_form_loop w naf1 x_u64 width window_mask pos1
        carry1
  else ok naf
partial_fixpoint

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::non_adjacent_form]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 931:4-983:5 -/
def scalar.Scalar.non_adjacent_form
  (self : scalar.Scalar) (w : Std.Usize) :
  Result (Array Std.I8 256#usize)
  := do
  massert (w >= 2#usize)
  massert (w <= 8#usize)
  let naf := Array.repeat 256#usize 0#i8
  let x_u64 := Array.repeat 5#usize 0#u64
  let s ← (↑(Array.to_slice self.bytes) : Result (Slice Std.U8))
  let (s1, index_mut_back) ←
    core.array.Array.index_mut (core.ops.index.IndexMutSlice
      (core.slice.index.SliceIndexRangeUsizeSlice Std.U64)) x_u64
      { start := 0#usize, «end» := 4#usize }
  let s2 ← scalar.read_le_u64_into s s1
  let width ← 1#u64 <<< w
  let window_mask ← width - 1#u64
  let x_u641 := index_mut_back s2
  scalar.Scalar.non_adjacent_form_loop w naf x_u641 width window_mask 0#usize
    0#u64

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::to_radix_2w_size_hint]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1036:4-1049:5 -/
def scalar.Scalar.to_radix_2w_size_hint
  (w : Std.Usize) : Result Std.Usize := do
  massert (w >= 4#usize)
  massert (w <= 8#usize)
  if 4#usize <= w
  then
    if w <= 7#usize
    then
      let i ← 256#usize + w
      let i1 ← i - 1#usize
      let digits_count ← i1 / w
      massert (digits_count <= 64#usize)
      ok digits_count
    else
      match w with
      | 8#uscalar =>
        let i ← 256#usize + 8#usize
        let i1 ← i - 1#usize
        let i2 ← i1 / 8#usize
        let digits_count ← i2 + 1#usize
        massert (digits_count <= 64#usize)
        ok digits_count
      | _ => fail panic
  else
    match w with
    | 8#uscalar =>
      let i ← 256#usize + 8#usize
      let i1 ← i - 1#usize
      let i2 ← i1 / 8#usize
      let digits_count ← i2 + 1#usize
      massert (digits_count <= 64#usize)
      ok digits_count
    | _ => fail panic

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::as_radix_2w]: loop 0:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1092:8-1114:9 -/
def scalar.Scalar.as_radix_2w_loop
  (w : Std.Usize) (scalar64x4 : Array Std.U64 4#usize) (radix : Std.U64)
  (window_mask : Std.U64) (carry : Std.U64) (digits : Array Std.I8 64#usize)
  (iter : core.ops.range.Range Std.Usize) :
  Result (Std.U64 × (Array Std.I8 64#usize))
  := do
  let (o, iter1) ←
    core.iter.range.IteratorRange.next core.iter.range.StepUsize iter
  match o with
  | none => ok (carry, digits)
  | some i =>
    let bit_offset ← i * w
    let u64_idx ← bit_offset / 64#usize
    let bit_idx ← bit_offset % 64#usize
    let i1 ← 64#usize - w
    let (iter2, bit_buf) ←
      if bit_idx < i1
      then
        let i2 ← Array.index_usize scalar64x4 u64_idx
        let bit_buf1 ← i2 >>> bit_idx
        ok (iter1, bit_buf1)
      else
        let i2 ←
          if u64_idx = 3#usize
          then let i3 ← Array.index_usize scalar64x4 u64_idx
               i3 >>> bit_idx
          else
            let i3 ← Array.index_usize scalar64x4 u64_idx
            let i4 ← i3 >>> bit_idx
            let i5 ← 1#usize + u64_idx
            let i6 ← Array.index_usize scalar64x4 i5
            let i7 ← 64#usize - bit_idx
            let i8 ← i6 <<< i7
            ok (i4 ||| i8)
        ok (iter1, i2)
    let i2 ← (↑(bit_buf &&& window_mask) : Result Std.U64)
    let coef ← carry + i2
    let i3 ← radix / 2#u64
    let i4 ← coef + i3
    let carry1 ← i4 >>> w
    let i5 ← (↑(UScalar.hcast .I64 coef) : Result Std.I64)
    let i6 ← carry1 <<< w
    let i7 ← (↑(UScalar.hcast .I64 i6) : Result Std.I64)
    let i8 ← i5 - i7
    let i9 ← (↑(IScalar.cast .I8 i8) : Result Std.I8)
    let a ← Array.update digits i i9
    scalar.Scalar.as_radix_2w_loop w scalar64x4 radix window_mask carry1 a
      iter2
partial_fixpoint

/-- [curve25519_dalek::scalar::{curve25519_dalek::scalar::Scalar}::as_radix_2w]:
   Source: 'curve25519-dalek/src/scalar.rs', lines 1073:4-1130:5 -/
def scalar.Scalar.as_radix_2w
  (self : scalar.Scalar) (w : Std.Usize) : Result (Array Std.I8 64#usize) := do
  massert (w >= 4#usize)
  massert (w <= 8#usize)
  if w = 4#usize
  then scalar.Scalar.as_radix_16 self
  else
    let scalar64x4 := Array.repeat 4#usize 0#u64
    let s ← (↑(Array.to_slice self.bytes) : Result (Slice Std.U8))
    let (s1, index_mut_back) ←
      core.array.Array.index_mut (core.ops.index.IndexMutSlice
        (core.slice.index.SliceIndexRangeUsizeSlice Std.U64)) scalar64x4
        { start := 0#usize, «end» := 4#usize }
    let s2 ← scalar.read_le_u64_into s s1
    let radix ← 1#u64 <<< w
    let window_mask ← radix - 1#u64
    let digits := Array.repeat 64#usize 0#i8
    let i ← 256#usize + w
    let i1 ← i - 1#usize
    let digits_count ← i1 / w
    let iter ←
      core.iter.traits.collect.IntoIterator.Blanket.into_iter
        (core.iter.traits.iterator.IteratorRange core.iter.range.StepUsize)
        { start := 0#usize, «end» := digits_count }
    let scalar64x41 := index_mut_back s2
    let (carry, digits1) ←
      scalar.Scalar.as_radix_2w_loop w scalar64x41 radix window_mask 0#u64
        digits iter
    match w with
    | 8#uscalar =>
      let i2 ← (↑(UScalar.hcast .I8 carry) : Result Std.I8)
      let i3 ← Array.index_usize digits1 digits_count
      let i4 ← i3 + i2
      Array.update digits1 digits_count i4
    | _ =>
      let i2 ← carry <<< w
      let i3 ← (↑(UScalar.hcast .I8 i2) : Result Std.I8)
      let i4 ← digits_count - 1#usize
      let i5 ← Array.index_usize digits1 i4
      let i6 ← i5 + i3
      Array.update digits1 i4 i6

end curve25519_dalek
